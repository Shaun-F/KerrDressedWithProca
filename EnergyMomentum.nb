(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43210,       1140]
NotebookOptionsPosition[     42315,       1119]
NotebookOutlinePosition[     42773,       1137]
CellTagsIndexPosition[     42730,       1134]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"<<", "KerrWithProca`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolutionPath", " ", "=", " ", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Solutions/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllSolutions", " ", "=", " ", 
   RowBox[{"getResults", "[", "SolutionPath", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]OrderingIndex", " ", "=", " ", 
   RowBox[{"Ordering", "@", 
    RowBox[{"AllSolutions", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", " ", "\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], 
      "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllSolutions", " ", "=", " ", 
   RowBox[{"AllSolutions", "[", 
    RowBox[{"[", "\[Mu]OrderingIndex", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrepareArguments", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"expr", "/.", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "]"}], "\[Rule]", "\[Theta]"}]}], "/.", 
      RowBox[{
       RowBox[{"t", "[", "]"}], "\[Rule]", "t"}]}], "/.", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "]"}], "\[Rule]", "\[Phi]"}]}], "/.", 
    RowBox[{
     RowBox[{"r", "[", "]"}], "\[Rule]", "r"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KerrComponents", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox[
           RowBox[{"2", " ", "M", " ", "r"}], 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["J", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
             SuperscriptBox["M", "2"]], "+", 
            SuperscriptBox["r", "2"]}]]}], ",", "0", ",", "0", ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "J", " ", "r", "*", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["J", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
             SuperscriptBox["M", "2"]], "+", 
            SuperscriptBox["r", "2"]}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["J", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
           RowBox[{
            SuperscriptBox["M", "2"], " ", 
            SuperscriptBox["r", "2"]}]}], 
          RowBox[{
           SuperscriptBox["J", "2"], "+", 
           RowBox[{
            SuperscriptBox["M", "2"], " ", "r", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}]], ",", 
         "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["J", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
           SuperscriptBox["M", "2"]], "+", 
          SuperscriptBox["r", "2"]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "J", " ", "r", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["J", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
             SuperscriptBox["M", "2"]], "+", 
            SuperscriptBox["r", "2"]}]]}], ",", "0", ",", "0", ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox["J", "2"], 
             SuperscriptBox["M", "2"]], "+", 
            SuperscriptBox["r", "2"], "+", 
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["J", "2"], " ", "M", " ", "r", " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
             RowBox[{
              RowBox[{
               SuperscriptBox["J", "2"], " ", 
               SuperscriptBox[
                RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
              RowBox[{
               SuperscriptBox["M", "2"], " ", 
               SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], "}"}]}], "}"}], "/.", 
     RowBox[{"J", "\[Rule]", 
      RowBox[{"a", "*", "M"}]}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IKerrComponents", " ", "=", " ", 
    RowBox[{
     RowBox[{"Inverse", "[", "KerrComponents", "]"}], "//", 
     "FullSimplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Delta", " ", "=", " ", 
   RowBox[{
    SuperscriptBox["r", "2"], "-", 
    RowBox[{"2", "*", "M", "*", "r"}], "+", 
    SuperscriptBox["a", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sigma", " ", "=", " ", 
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], "*", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qr", " ", "=", " ", 
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    SuperscriptBox["\[Lambda]", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qth", " ", "=", " ", 
    RowBox[{
     SuperscriptBox["\[Lambda]", "2"], "-", 
     RowBox[{
      SuperscriptBox["a", "2"], "*", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Polarization", " ", "tensor", " ", "components"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"See", " ", 
    RowBox[{"arXiv", ":", "2004.09536"}]}], "*)"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PolarizationComponentsSymmetric", " ", "=", " ", 
   RowBox[{
    FractionBox[
     SuperscriptBox["\[Lambda]", "2"], "Sigma"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "qr"], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r", "2"], "+", 
                SuperscriptBox["a", "2"]}], ")"}], "2"]}], "Delta"], ",", "0",
            ",", "0", ",", 
           RowBox[{
            RowBox[{"-", "a"}], "*", 
            FractionBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               SuperscriptBox["a", "2"]}], ")"}], "Delta"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Delta", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "a"}], 
            FractionBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               SuperscriptBox["a", "2"]}], ")"}], "Delta"]}], ",", "0", ",", 
           "0", ",", 
           FractionBox[
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], "Delta"]}], "}"}]}], "}"}]}], " ", 
      "+", " ", 
      RowBox[{
       FractionBox["1", "qth"], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SuperscriptBox["a", "2"], "*", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ",", "0", ",", 
           "0", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0", ",", "0", ",", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}], "}"}]}], "}"}]}]}],
      ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PolarizationComponentsAntisymmetric", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], "*", 
    FractionBox["\[Lambda]", "Sigma"], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["r", "qr"], "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r", "2"], "+", 
              SuperscriptBox["a", "2"]}], ")"}]}], ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r", "2"], "+", 
             SuperscriptBox["a", "2"]}], ")"}], ",", "0", ",", "0", ",", 
           "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "a"}], ",", "0", ",", "0"}], "}"}]}], "}"}]}], " ", 
      "+", " ", 
      RowBox[{"a", "*", 
       FractionBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "qth"], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            RowBox[{"-", "a"}], "*", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "*", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0", ",", "0", ",", 
           
           RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", 
            RowBox[{"Csc", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}]}], 
        "}"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolarizationComponents", " ", "=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "PolarizationComponentsSymmetric", "+", 
        "PolarizationComponentsAntisymmetric"}], ")"}], "//", 
      "FullSimplify"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "59944"}], "/", "extracting"}], "-", "the", "-", 
     "function", "-", "from", "-", "interpolatingfunction", "-", 
     RowBox[{
      RowBox[{"object", "/", "59963"}], "#59963"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InterpolationToPiecewise", "[", 
    RowBox[{"if_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"main", ",", "default", ",", "grid"}], "}"}], ",", 
      RowBox[{
       RowBox[{"grid", "=", 
        RowBox[{"if", "[", "\"\<Grid\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Piecewise", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"if", "@", 
              RowBox[{"\"\<GetPolynomial\>\"", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x", "-", "#"}]}], "]"}]}], ",", 
             RowBox[{"x", "<", 
              RowBox[{"First", "@", "#"}]}]}], "}"}], "&"}], "/@", 
          RowBox[{"grid", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"if", "@", 
            RowBox[{"\"\<GetPolynomial\>\"", "[", 
             RowBox[{"#", ",", 
              RowBox[{"x", "-", "#"}]}], "]"}]}], "&"}], "@", 
          RowBox[{"grid", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}]}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"if", "[", "\"\<InterpolationMethod\>\"", "]"}], "==", 
     "\"\<Hermite\>\""}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CompileInterpolating", "[", "interp_InterpolatingFunction", "]"}],
    ":=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", "\[Psi]", "}"}], ",", " ", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"InterpolationToPiecewise", "[", 
       RowBox[{"interp", ",", " ", "\[Psi]"}], "]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParamsToReprRule", "[", "solution_", "]"}], ":=", 
   RowBox[{
    RowBox[{"AssociationThread", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Symbol", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"solution", "[", " ", "\"\<Parameters\>\"", "]"}], "//", 
          "Keys"}], ")"}]}], ")"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"solution", "[", " ", "\"\<Parameters\>\"", "]"}], "//", 
        "Values"}], ")"}]}], "]"}], "//", "Normal"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToXACTSymbol", "[", "expr_", "]"}], ":=", 
  RowBox[{"expr", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "->", 
      RowBox[{"t", "[", "]"}]}], ",", " ", 
     RowBox[{"r", "->", 
      RowBox[{"r", "[", "]"}]}], ",", " ", 
     RowBox[{"\[Theta]", "->", 
      RowBox[{"\[Theta]", "[", "]"}]}], ",", " ", 
     RowBox[{"\[Phi]", "->", 
      RowBox[{"\[Phi]", "[", "]"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FromXACTSymbol", "[", "expr_", "]"}], ":=", 
  RowBox[{"expr", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"t", "[", "]"}], "->", "t"}], ",", 
     RowBox[{
      RowBox[{"r", "[", "]"}], "->", "r"}], ",", " ", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "]"}], "->", "\[Theta]"}], ",", " ", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "]"}], "->", " ", "\[Phi]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyParameters", "[", "solution_", "]"}], "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "->", 
       RowBox[{"solution", "[", 
        RowBox[{"[", 
         RowBox[{"\"\<Parameters\>\"", ",", "\"\<\[Chi]\>\""}], "]"}], 
        "]"}]}], ",", " ", 
      RowBox[{"\[Lambda]", "->", " ", 
       RowBox[{"solution", "[", 
        RowBox[{"[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}], 
        "]"}]}], ",", " ", 
      RowBox[{"m", "->", " ", 
       RowBox[{"solution", "[", 
        RowBox[{"[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], 
        "]"}]}], ",", " ", 
      RowBox[{"n", "->", " ", 
       RowBox[{"solution", "[", 
        RowBox[{"[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<n\>\""}], "]"}], 
        "]"}]}]}], "}"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"FKKSZ", "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"OutputForm", ":", 
      RowBox[{"(", 
       RowBox[{"_", "?", "AssociationQ"}], ")"}], ":", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<AsCompiled\>\"", "->", "False"}], "|>"}]}]}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ww", " ", "=", " ", 
        RowBox[{"solution", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}], 
         "]"}]}], ",", " ", "\[IndentingNewLine]", "\t", 
       RowBox[{"mm", " ", "=", " ", 
        RowBox[{"solution", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], 
         "]"}]}], ",", " ", 
       RowBox[{"Sinterp", " ", "=", " ", 
        RowBox[{"solution", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<S(\[Theta])\>\""}], 
          "]"}], "]"}]}], ",", " ", 
       RowBox[{"Rinterp", " ", "=", " ", 
        RowBox[{"solution", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<Solution\>\"", ",", "\"\<R(r)\>\""}], "]"}], "]"}]}]}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], "*", "ww", "*", "t"}], "]"}], "*", 
          RowBox[{"Rinterp", "[", "r", "]"}], "*", 
          RowBox[{"Sinterp", "[", "\[Theta]", "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "mm", "*", "\[Phi]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"OutputForm", ",", " ", "\"\<AsCompiled\>\""}], "]"}], "&&", 
         RowBox[{"OutputForm", "[", "\"\<AsCompiled\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
          ",", " ", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "I"}], "*", "ww", "*", "t"}], "]"}], "*", 
            RowBox[{"InterpolationToPiecewise", "[", 
             RowBox[{"Rinterp", ",", "r"}], "]"}], "*", 
            RowBox[{"InterpolationToPiecewise", "[", 
             RowBox[{"Sinterp", ",", "\[Theta]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", "mm", "*", "\[Phi]"}], "]"}]}], "]"}]}], "]"}],
         ",", "\[IndentingNewLine]", " ", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
          ",", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], "*", "ww", "*", "t"}], "]"}], "*", 
           RowBox[{"Rinterp", "[", "r", "]"}], "*", 
           RowBox[{"Sinterp", "[", "\[Theta]", "]"}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", "*", "mm", "*", "\[Phi]"}], "]"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSProca", "[", "U", "]"}], "[", 
   RowBox[{"solution_", ",", " ", 
    RowBox[{"OutputForm", ":", 
     RowBox[{"(", 
      RowBox[{"_", "?", "AssociationQ"}], ")"}], ":", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<AsInterp\>\"", "->", "True"}], ",", " ", 
       RowBox[{"\"\<AsCompiled\>\"", "->", "False"}], ",", 
       RowBox[{"\"\<AsAnonymous\>\"", "->", "False"}]}], "|>"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"OutputForm", "[", "\"\<AsInterp\>\"", "]"}]}], " ", "||", 
        RowBox[{"OutputForm", "[", "\"\<AsCompiled\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"PolarizationComponents", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"FKKSZ", "[", 
                   RowBox[{"solution", ",", " ", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<AsInterp\>\"", "->", "False"}], "|>"}]}], 
                   "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], 
                    "}"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", 
           "FromXACTSymbol"}], "//", 
          RowBox[{"ApplyParameters", "[", "solution", "]"}]}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"PolarizationComponents", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"FKKSZ", "[", "solution", "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], 
                    "}"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", 
           "FromXACTSymbol"}], "//", 
          RowBox[{"ApplyParameters", "[", "solution", "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"OutputForm", ",", "\"\<AsAnonymous\>\""}], "]"}], "&&", 
        RowBox[{"OutputForm", "[", "\"\<AsAnonymous\>\"", "]"}]}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
         RowBox[{"Evaluate", "@", "res"}]}], "]"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"OutputForm", ",", "\"\<AsCompiled\>\""}], "]"}], "&&", 
          RowBox[{"OutputForm", "[", "\"\<AsCompiled\>\"", "]"}]}], ",", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
           ",", 
           RowBox[{"Evaluate", "@", "res"}], ",", " ", 
           RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}], 
         ",", "\[IndentingNewLine]", "res"}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FKKSProca", "[", "L", "]"}], "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"OutputForm", ":", 
      RowBox[{"(", 
       RowBox[{"_", "?", "AssociationQ"}], ")"}], ":", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<AsInterp\>\"", "->", "True"}], ",", " ", 
        RowBox[{"\"\<AsCompiled\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<AsAnonymous\>\"", "->", "False"}]}], "|>"}]}]}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp", " ", "=", " ", 
       RowBox[{
        RowBox[{"FKKSProca", "[", "U", "]"}], "[", 
        RowBox[{"solution", ",", " ", "OutputForm"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"\[Sigma]", "=", "1"}], "4"], 
        RowBox[{
         RowBox[{"KerrComponents", "[", 
          RowBox[{"[", 
           RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], "]"}], 
         RowBox[{"tmp", "[", 
          RowBox[{"[", "\[Sigma]", "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSFieldStrength", "::", "usage"}], "=", 
   "\"\<Computes field strength tensor of proca field for various index \
structures\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSFieldStrength", "[", "UU", "]"}], "[", "solution_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dP", "=", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FKKSProca", "[", "U", "]"}], "[", "solution", "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
          ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"\[Sigma]", "=", "1"}], "4"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"IKerrComponents", "[", 
            RowBox[{"[", 
             RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], "]"}], 
           RowBox[{"dP", "[", 
            RowBox[{"[", 
             RowBox[{"\[Nu]", ",", "\[Sigma]"}], "]"}], "]"}]}], "-", " ", 
          RowBox[{
           RowBox[{"IKerrComponents", "[", 
            RowBox[{"[", 
             RowBox[{"\[Nu]", ",", "\[Sigma]"}], "]"}], "]"}], 
           RowBox[{"dP", "[", 
            RowBox[{"[", 
             RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], "]"}]}]}], ")"}]}], 
       "\[IndentingNewLine]", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", 
     RowBox[{"ApplyParameters", "[", "solution", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSFieldStrength", "[", "LL", "]"}], "[", "solution_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp", " ", "=", " ", 
      RowBox[{
       RowBox[{"FKKSFieldStrength", "[", "UU", "]"}], "[", "solution", 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"\[Sigma]", "=", "1"}], "4"], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"\[Rho]", "=", "1"}], "4"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"KerrComponents", "[", 
            RowBox[{"[", 
             RowBox[{"\[Mu]", ",", "\[Rho]"}], "]"}], "]"}], "*", 
           RowBox[{"KerrComponents", "[", 
            RowBox[{"[", 
             RowBox[{"\[Nu]", ",", "\[Sigma]"}], "]"}], "]"}], "*", 
           RowBox[{"tmp", "[", 
            RowBox[{"[", 
             RowBox[{"\[Rho]", ",", "\[Sigma]"}], "]"}], "]"}]}], ")"}]}]}], 
       "\[IndentingNewLine]", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", 
     RowBox[{"ApplyParameters", "[", "solution", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FKKSFieldStrength", "[", "UL", "]"}], "[", "solution_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp", " ", "=", " ", 
       RowBox[{
        RowBox[{"FKKSFieldStrength", "[", "UU", "]"}], "[", "solution", 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"\[Sigma]", "=", "1"}], "4"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"KerrComponents", "[", 
            RowBox[{"[", 
             RowBox[{"\[Nu]", ",", "\[Sigma]"}], "]"}], "]"}], "*", 
           RowBox[{"tmp", "[", 
            RowBox[{"[", 
             RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], "]"}]}], ")"}]}], 
        "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Nu]", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", 
      RowBox[{"ApplyParameters", "[", "solution", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FKKSEnergyMomentum", "[", "UU", "]"}], "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"OutputForm", ":", 
      RowBox[{"(", 
       RowBox[{"_", "?", "AssociationQ"}], ")"}], ":", 
      RowBox[{"<|", 
       RowBox[{"\"\<AsAnonymous\>\"", "\[Rule]", "False"}], "|>"}]}]}], "]"}],
    ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Fll", "=", 
        RowBox[{
         RowBox[{"FKKSFieldStrength", "[", "LL", "]"}], "[", "solution", 
         "]"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"Fuu", " ", "=", " ", 
        RowBox[{
         RowBox[{"FKKSFieldStrength", "[", "UU", "]"}], "[", "solution", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Ful", " ", "=", " ", 
        RowBox[{
         RowBox[{"FKKSFieldStrength", "[", "UL", "]"}], "[", "solution", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Al", " ", "=", " ", 
        RowBox[{
         RowBox[{"FKKSProca", "[", "L", "]"}], "[", "solution", "]"}]}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"Au", " ", "=", " ", 
        RowBox[{
         RowBox[{"FKKSProca", "[", "U", "]"}], "[", "solution", "]"}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", " ", "=", " ", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"\[Mu]", "=", "1"}], "4"], 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"\[Nu]", "=", "1"}], "4"], 
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"-", "1"}], "8"], 
                RowBox[{"Fll", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "]"}], 
                RowBox[{"Fuu", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "]"}], "*", 
                RowBox[{"KerrComponents", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Rho]", ",", "\[Sigma]"}], "]"}], "]"}]}], 
               ")"}]}]}], " ", "+", " ", "\[IndentingNewLine]", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"\[Nu]", "=", "1"}], "4"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"Fuu", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Rho]", ",", "\[Nu]"}], "]"}], "]"}], 
                RowBox[{"Ful", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Sigma]", ",", "\[Nu]"}], "]"}], "]"}]}], " ", 
               "+", " ", 
               RowBox[{
                FractionBox["1", "4"], 
                RowBox[{"KerrComponents", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Rho]", ",", "\[Sigma]"}], "]"}], "]"}], 
                RowBox[{"Al", "[", 
                 RowBox[{"[", "\[Nu]", "]"}], "]"}], "*", 
                RowBox[{"Au", "[", 
                 RowBox[{"[", "\[Nu]", "]"}], "]"}]}]}], ")"}]}], " ", "-", 
            " ", "\[IndentingNewLine]", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"Au", "[", 
              RowBox[{"[", "\[Rho]", "]"}], "]"}], 
             RowBox[{"Au", "[", 
              RowBox[{"[", "\[Sigma]", "]"}], "]"}]}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Rho]", ",", "1", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", "1", ",", "4"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], "//", 
        RowBox[{"ApplyParameters", "[", "solution", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"OutputForm", ",", " ", "\"\<AsAnonymous\>\""}], "]"}], "&&", 
         RowBox[{"OutputForm", "[", "\"\<AsAnonymous\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
          ",", " ", 
          RowBox[{"Evaluate", "[", "res", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "res"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSEnergyMomentum", "[", "UL", "]"}], "[", 
   RowBox[{"solution_", ",", "  ", 
    RowBox[{"OutputForm", ":", 
     RowBox[{"(", 
      RowBox[{"_", "?", "AssociationQ"}], ")"}], ":", 
     RowBox[{"<|", 
      RowBox[{"\"\<AsAnonymous\>\"", "\[Rule]", "False"}], "|>"}]}]}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp", " ", "=", " ", 
      RowBox[{
       RowBox[{"FKKSEnergyMomentum", "[", "UU", "]"}], "[", 
       RowBox[{"solution", ",", " ", "OutputForm"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", " ", "=", " ", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OutputForm", "[", "\"\<AsAnonymous\>\"", "]"}], ",", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"\[Sigma]", "=", "1"}], "4"], 
            RowBox[{
             RowBox[{"KerrComponents", "[", 
              RowBox[{"[", 
               RowBox[{"\[Nu]", ",", "\[Sigma]"}], "]"}], "]"}], 
             RowBox[{
              RowBox[{"tmp", "[", 
               RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}],
               "[", 
              RowBox[{"[", 
               RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"\[Sigma]", "=", "1"}], "4"], 
            RowBox[{
             RowBox[{"KerrComponents", "[", 
              RowBox[{"[", 
               RowBox[{"\[Nu]", ",", "\[Sigma]"}], "]"}], "]"}], 
             RowBox[{"tmp", "[", 
              RowBox[{"[", 
               RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], "]"}]}]}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "4"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], "//", 
       RowBox[{"ApplyParameters", "[", "solution", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OutputForm", "[", "\"\<AsAnonymous\>\"", "]"}], ",", " ", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",",
          " ", 
         RowBox[{"Evaluate", "[", "res", "]"}]}], "]"}], ",", " ", "res"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.86296478405648*^9, 3.862964797928751*^9}, {
   3.862964840111762*^9, 3.86296484217303*^9}, {3.862964908813917*^9, 
   3.862965009651157*^9}, {3.862965230282201*^9, 3.8629652312933197`*^9}, {
   3.862982580320877*^9, 3.862982580674638*^9}, {3.862982612367734*^9, 
   3.862982684798275*^9}, {3.862985770571732*^9, 3.8629857710576897`*^9}, 
   3.862986393099662*^9, {3.862987297807922*^9, 3.862987298614695*^9}, {
   3.8629998794574614`*^9, 3.862999955613813*^9}, {3.86300013671996*^9, 
   3.8630002598486156`*^9}, {3.8630003429524*^9, 3.863000356166847*^9}, {
   3.863000537168293*^9, 3.863000537854085*^9}, {3.863000836901215*^9, 
   3.863000849734869*^9}, {3.863000946118361*^9, 3.863000957287278*^9}, {
   3.863001060051186*^9, 3.863001093500208*^9}, {3.86300117353445*^9, 
   3.863001174004702*^9}, {3.863001214606779*^9, 3.863001228030488*^9}, {
   3.8630013724091377`*^9, 3.8630013733736067`*^9}, {3.863001482606349*^9, 
   3.8630014827433443`*^9}, {3.863001546764303*^9, 3.863001552983993*^9}, {
   3.863001618394167*^9, 3.8630016422593822`*^9}, {3.863055654185041*^9, 
   3.863055751910643*^9}, 3.8631457963368073`*^9, {3.8631458394781637`*^9, 
   3.863145842214869*^9}, {3.863511239810791*^9, 3.863511278393475*^9}, {
   3.863511320933571*^9, 3.863511327252615*^9}, {3.8635115277365026`*^9, 
   3.863511565013465*^9}, {3.863511886919592*^9, 3.863511888146443*^9}, {
   3.863515215303681*^9, 3.863515219307349*^9}, {3.863568772466608*^9, 
   3.863568772793222*^9}},ExpressionUUID->"c3e1fed8-7f33-4a22-a40f-\
88b01dc112ff"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.8635115866615667`*^9},
 CellLabel->
  "(Local2) In[1]:=",ExpressionUUID->"dbd30af6-fbab-4a1c-a766-9abd91a01201"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.8635115873645906`*^9},
 CellLabel->
  "(Local2) In[2]:=",ExpressionUUID->"d3e21d59-9dc2-4d16-85ba-894a902dbe5e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.863513268478696*^9, 3.863513405963005*^9}, {
   3.863513869709668*^9, 3.863513898013938*^9}, {3.8635142797076893`*^9, 
   3.8635143195004873`*^9}, {3.863514356633698*^9, 3.8635143678182487`*^9}, {
   3.863514543391507*^9, 3.8635145577814074`*^9}, {3.863514635473084*^9, 
   3.8635146850028152`*^9}, {3.8635148302311068`*^9, 3.863514841037352*^9}, 
   3.8635149466967154`*^9, {3.863515030203992*^9, 3.863515132066566*^9}, 
   3.8635152091466503`*^9},ExpressionUUID->"d72708ac-f179-4b04-adac-\
87dcc8147b53"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8635115840525827`*^9, 
  3.863511585149434*^9}},ExpressionUUID->"92830325-beb7-4baa-8db9-\
8dada3c897a5"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fun", " ", "=", " ", 
     RowBox[{"FKKSZ", "[", 
      RowBox[{
       RowBox[{"AllSolutions", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<AsCompiled\>\"", "->", "True"}], "|>"}]}], "]"}]}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DensityPlot3D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fun", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Norm", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], ",", 
        RowBox[{"ArcCos", "[", 
         FractionBox["z", 
          RowBox[{"Norm", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]], "]"}], ",", 
        RowBox[{"ArcTan", "[", 
         FractionBox["y", "x"], "]"}]}], "]"}], "//", "Abs"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "5000"}], ",", "5000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "5000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "5000"}], ",", "5000"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.862954035698812*^9, 3.862954071176742*^9}, {
   3.8629543042237453`*^9, 3.8629543862986937`*^9}, {3.8629544409278803`*^9, 
   3.8629544479808197`*^9}, {3.8629555019628563`*^9, 3.862955519649441*^9}, 
   3.862955575999558*^9, {3.86296393804699*^9, 3.8629639445310717`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"58fef78e-6e32-4909-ad27-9572aad875b3"]
},
Evaluator->"Local2",
WindowSize->{720., 762.75},
WindowMargins->{{0, Automatic}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"422e4b80-3b30-4473-81df-e2b209a10e34"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 38540, 1021, 4018, "Input",ExpressionUUID->"c3e1fed8-7f33-4a22-a40f-88b01dc112ff"],
Cell[39101, 1043, 179, 3, 64, "Input",ExpressionUUID->"dbd30af6-fbab-4a1c-a766-9abd91a01201"],
Cell[39283, 1048, 179, 3, 64, "Input",ExpressionUUID->"d3e21d59-9dc2-4d16-85ba-894a902dbe5e"],
Cell[39465, 1053, 555, 8, 29, "Input",ExpressionUUID->"d72708ac-f179-4b04-adac-87dcc8147b53"],
Cell[40023, 1063, 689, 11, 484, "Input",ExpressionUUID->"92830325-beb7-4baa-8db9-8dada3c897a5"],
Cell[40715, 1076, 1596, 41, 129, "Input",ExpressionUUID->"58fef78e-6e32-4909-ad27-9572aad875b3"]
}
]
*)

