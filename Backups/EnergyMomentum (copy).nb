(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70250,       1840]
NotebookOptionsPosition[     69047,       1810]
NotebookOutlinePosition[     69481,       1827]
CellTagsIndexPosition[     69438,       1824]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["xAct setup", "Chapter",
 CellChangeTimes->{{3.864772106535747*^9, 
  3.864772109240108*^9}},ExpressionUUID->"df089bd2-7508-4f17-af93-\
48e1db9523e7"],

Cell[BoxData[{
 RowBox[{"<<", "KerrWithProca`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", 
    RowBox[{"<<", "xAct`xCoba`"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"$PrePrint", "=", "ScreenDollarIndices"}], ";"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{"ValidateSymbol", "::", "used"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{"ValidateSymbol", "::", "invalid"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$DefInfoQ", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$UndefInfoQ", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$CVSimplify", "=", "Identity"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"$Assumptions", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", ">", "0"}], ",", 
       RowBox[{"M", ">", "0"}], ",", 
       RowBox[{"J", ">", "0"}], ",", 
       RowBox[{"1", ">", "a", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{
       "\[Pi]", "\[GreaterEqual]", "\[Theta]", "\[GreaterEqual]", "0"}], ",", 
       " ", 
       RowBox[{"\[Lambda]", "\[Element]", "Complexes"}], ",", 
       RowBox[{"\[Omega]", "\[Element]", "Complexes"}], ",", " ", 
       RowBox[{"\[Nu]", "\[Element]", "Complexes"}], ",", " ", 
       RowBox[{
        RowBox[{"R", "[", "r", "]"}], "\[NotEqualTilde]", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"S", "[", "\[Theta]", "]"}], "\[NotEqualTilde]", "0"}], ",", 
       " ", 
       RowBox[{"\[Sigma]", "\[NotEqualTilde]", "0"}], ",", " ", 
       RowBox[{"\[CapitalSigma]", "\[NotEqualTilde]", "0"}], ",", " ", 
       RowBox[{"\[CapitalDelta]", "\[NotEqualTilde]", "0"}]}], "}"}]}], ";"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Since", " ", "were", " ", "only", " ", "using", " ", "one", " ", 
     "covariant", " ", "derivative"}], ",", " ", 
    RowBox[{"redefine", " ", "printed", " ", "symbols"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "RiemannCD", "]"}], "^=", "\"\<R\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "RicciCD", "]"}], "^=", "\"\<R\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "RicciScalarCD", "]"}], "^=", "\"\<R\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "ChristoffelCD", "]"}], "^=", 
   "\"\<\[CapitalGamma]\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrintAs", "[", "EinsteinCD", "]"}], "^=", "\"\<G\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "basic", " ", "objects", " ", "of", " ", "xAct"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefManifold", "[", 
    RowBox[{"\[ScriptCapitalM]", ",", "4", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Rho]", 
       ",", "\[Sigma]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Iota]"}], 
      "}"}]}], "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Manifold", " ", "of", " ", "our", " ", "spacetime"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefChart", "[", 
    RowBox[{"sphericalchart", ",", " ", "\[ScriptCapitalM]", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t", "[", "]"}], ",", 
       RowBox[{"r", "[", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "]"}], ",", 
       RowBox[{"\[Phi]", "[", "]"}]}], "}"}], ",", " ", 
     RowBox[{"FormatBasis", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<Partials\>\"", ",", " ", "\"\<Differentials\>\""}], 
       "}"}]}], ",", " ", 
     RowBox[{"ChartColor", "\[Rule]", "Blue"}]}], "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Spherical", " ", "co"}], "-", 
    RowBox[{"ordinate", " ", "chart"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Cast", " ", "numerical", " ", "indices", " ", "to", " ", 
    RowBox[{"latin", "/", "greek"}], " ", "representation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ch", "/:", 
   RowBox[{"CIndexForm", "[", 
    RowBox[{"0", ",", "ch"}], "]"}], ":=", "\"\<t\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ch", "/:", 
   RowBox[{"CIndexForm", "[", 
    RowBox[{"1", ",", "ch"}], "]"}], ":=", "\"\<r\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ch", "/:", 
   RowBox[{"CIndexForm", "[", 
    RowBox[{"2", ",", "ch"}], "]"}], ":=", "\"\<\[Theta]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ch", "/:", 
    RowBox[{"CIndexForm", "[", 
     RowBox[{"3", ",", "ch"}], "]"}], ":=", "\"\<\[Phi]\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "the", " ", "constants", " ", "of", " ", "the", " ", 
    "system"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "M", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Mass", " ", "of", " ", "BH"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "J", "]"}], 
  RowBox[{"(*", 
   RowBox[{"Angular", " ", "momentum", " ", "of", " ", "BH"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "a", "]"}], 
  RowBox[{"(*", 
   RowBox[{"Dimensionless", " ", "spin"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "G", "]"}], 
  RowBox[{"(*", 
   RowBox[{"Newtons", " ", "constant"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "\[Lambda]", "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "separation", " ", "constant", " ", "for", " ", "polarization", " ", 
    "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "\[Omega]", "]"}], 
  RowBox[{"(*", 
   RowBox[{"angular", " ", "frequency"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "m", "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "projected", " ", "angular", " ", "momentum", " ", "quantum", " ", 
    "number"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefConstantSymbol", "[", "\[CapitalMu]", "]"}], 
   RowBox[{"(*", 
    RowBox[{"Mass", " ", "of", " ", "proca", " ", "field"}], "*)"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", ">", "0"}], ",", 
       RowBox[{"M", ">", "0"}], ",", 
       RowBox[{"J", ">", "0"}], ",", 
       RowBox[{"1", ">", "a", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{
       "\[Pi]", "\[GreaterEqual]", "\[Theta]", "\[GreaterEqual]", "0"}], ",", 
       " ", 
       RowBox[{"\[Lambda]", "\[Element]", "Complexes"}], ",", 
       RowBox[{"\[Omega]", "\[Element]", "Complexes"}], ",", " ", 
       RowBox[{"\[Nu]", "\[Element]", "Complexes"}]}], "}"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolutionPath", " ", "=", " ", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Solutions/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllSolutions", " ", "=", " ", 
   RowBox[{"getResults", "[", "SolutionPath", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]OrderingIndex", " ", "=", " ", 
   RowBox[{"Ordering", "@", 
    RowBox[{"AllSolutions", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", " ", "\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], 
      "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllSolutions", " ", "=", " ", 
   RowBox[{"AllSolutions", "[", 
    RowBox[{"[", "\[Mu]OrderingIndex", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrepareArguments", "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"expr", "/.", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "]"}], "\[Rule]", "\[Theta]"}]}], "/.", 
      RowBox[{
       RowBox[{"t", "[", "]"}], "\[Rule]", "t"}]}], "/.", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "]"}], "\[Rule]", "\[Phi]"}]}], "/.", 
    RowBox[{
     RowBox[{"r", "[", "]"}], "\[Rule]", "r"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AnalyticSolution", " ", "=", " ", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", "\[Epsilon]"}], ",", 
        RowBox[{"\"\<\[Mu]Nv\>\"", "\[Rule]", "\[Mu]Nv"}], ",", 
        RowBox[{"\"\<m\>\"", "\[Rule]", "m"}], ",", 
        RowBox[{"\"\<n\>\"", "\[Rule]", "n"}], ",", 
        RowBox[{"\"\<\[Chi]\>\"", "\[Rule]", "\[Chi]"}], ",", 
        RowBox[{"\"\<M\>\"", "\[Rule]", "M"}]}], "\[RightAssociation]"}]}], 
     ",", 
     RowBox[{"\"\<Solution\>\"", "\[Rule]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", "\[Omega]"}], ",", 
        RowBox[{"\"\<\[Nu]\>\"", "\[Rule]", "\[Nu]"}], ",", 
        RowBox[{"\"\<R(r)\>\"", "\[Rule]", "R"}], ",", 
        RowBox[{"\"\<S(\[Theta])\>\"", "\[Rule]", "S"}]}], 
       "\[RightAssociation]"}]}]}], "\[RightAssociation]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"77961498-7f7f-4deb-a3b2-0c7e8c450b6d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Quantity Definitions", "Chapter",
 CellChangeTimes->{{3.864772452586278*^9, 
  3.864772455242476*^9}},ExpressionUUID->"29d04ea6-d448-4f2a-903b-\
a84be54376ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "metric", " ", "object"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DefMetric", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"g", "[", 
      RowBox[{
       RowBox[{"-", "\[Mu]"}], ",", 
       RowBox[{"-", "\[Nu]"}]}], "]"}], ",", " ", "CD", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<;\>\"", ",", " ", "\"\<\[Del]\>\""}], "}"}], ",", 
     RowBox[{"PrintAs", "\[Rule]", "\"\<g\>\""}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KerrComponents", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox[
             RowBox[{"2", " ", "M", " ", "r"}], 
             RowBox[{
              FractionBox[
               RowBox[{
                SuperscriptBox["J", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
               SuperscriptBox["M", "2"]], "+", 
              SuperscriptBox["r", "2"]}]]}], ",", "0", ",", "0", ",", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", "J", " ", "r", "*", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
             RowBox[{
              FractionBox[
               RowBox[{
                SuperscriptBox["J", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
               SuperscriptBox["M", "2"]], "+", 
              SuperscriptBox["r", "2"]}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["J", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
             RowBox[{
              SuperscriptBox["M", "2"], " ", 
              SuperscriptBox["r", "2"]}]}], 
            RowBox[{
             SuperscriptBox["J", "2"], "+", 
             RowBox[{
              SuperscriptBox["M", "2"], " ", "r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}]], ",", 
           "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["J", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
             SuperscriptBox["M", "2"]], "+", 
            SuperscriptBox["r", "2"]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", "J", " ", "r", " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
             RowBox[{
              FractionBox[
               RowBox[{
                SuperscriptBox["J", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
               SuperscriptBox["M", "2"]], "+", 
              SuperscriptBox["r", "2"]}]]}], ",", "0", ",", "0", ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               SuperscriptBox["J", "2"], 
               SuperscriptBox["M", "2"]], "+", 
              SuperscriptBox["r", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", 
                 SuperscriptBox["J", "2"], " ", "M", " ", "r", " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["J", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
                 RowBox[{
                  SuperscriptBox["M", "2"], " ", 
                  SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], "}"}]}],
         "}"}], "/.", 
       RowBox[{"J", "\[Rule]", 
        RowBox[{"a", "*", "M"}]}]}], "//", "FullSimplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IKerrComponents", " ", "=", " ", 
     RowBox[{
      RowBox[{"Inverse", "[", "KerrComponents", "]"}], "//", 
      "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Define", " ", "the", " ", "components", " ", "of", " ", "the", " ", 
      RowBox[{"metric", ".", " ", "Note"}]}], ",", " ", 
     RowBox[{
      RowBox[{"the", " ", "chart", " ", "co"}], "-", 
      RowBox[{"ordinates", " ", "are", " ", "scalar", " ", "functions"}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KerrComponents", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            FractionBox[
             RowBox[{"2", " ", "M", " ", 
              RowBox[{"r", "[", "]"}]}], 
             RowBox[{
              FractionBox[
               RowBox[{
                SuperscriptBox["J", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}], 
               SuperscriptBox["M", "2"]], "+", 
              SuperscriptBox[
               RowBox[{"r", "[", "]"}], "2"]}]]}], ",", "0", ",", "0", ",", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", "J", " ", 
              RowBox[{"r", "[", "]"}], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}], 
             RowBox[{
              FractionBox[
               RowBox[{
                SuperscriptBox["J", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}], 
               SuperscriptBox["M", "2"]], "+", 
              SuperscriptBox[
               RowBox[{"r", "[", "]"}], "2"]}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["J", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}], "+", 
             RowBox[{
              SuperscriptBox["M", "2"], " ", 
              SuperscriptBox[
               RowBox[{"r", "[", "]"}], "2"]}]}], 
            RowBox[{
             SuperscriptBox["J", "2"], "+", 
             RowBox[{
              SuperscriptBox["M", "2"], " ", 
              RowBox[{"r", "[", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "M"}], "+", 
                RowBox[{"r", "[", "]"}]}], ")"}]}]}]], ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["J", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}], 
             SuperscriptBox["M", "2"]], "+", 
            SuperscriptBox[
             RowBox[{"r", "[", "]"}], "2"]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", "J", " ", 
              RowBox[{"r", "[", "]"}], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}], 
             RowBox[{
              FractionBox[
               RowBox[{
                SuperscriptBox["J", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}], 
               SuperscriptBox["M", "2"]], "+", 
              SuperscriptBox[
               RowBox[{"r", "[", "]"}], "2"]}]]}], ",", "0", ",", "0", ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               SuperscriptBox["J", "2"], 
               SuperscriptBox["M", "2"]], "+", 
              SuperscriptBox[
               RowBox[{"r", "[", "]"}], "2"], "+", 
              FractionBox[
               RowBox[{"2", " ", 
                SuperscriptBox["J", "2"], " ", "M", " ", 
                RowBox[{"r", "[", "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}], 
               RowBox[{
                RowBox[{
                 SuperscriptBox["J", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Cos", "[", 
                   RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["M", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"r", "[", "]"}], "2"]}]}]]}], ")"}]}]}], "}"}]}], 
        "}"}], "/.", 
       RowBox[{"J", "\[Rule]", 
        RowBox[{"a", "*", "M"}]}]}], "//", "FullSimplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SchwarComponents", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox[
           RowBox[{"2", " ", "M"}], 
           RowBox[{"r", "[", "]"}]]}], ",", "0", ",", "0", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", "M"}], 
            RowBox[{"r", "[", "]"}]]}]], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         SuperscriptBox[
          RowBox[{"r", "[", "]"}], "2"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"r", "[", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}]}], "}"}]}], "}"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"met", " ", "=", " ", 
     RowBox[{"CTensor", "[", 
      RowBox[{"KerrComponents", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "sphericalchart"}], ",", 
         RowBox[{"-", "sphericalchart"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetCMetric", "[", 
     RowBox[{"met", ",", 
      RowBox[{"-", "sphericalchart"}], ",", 
      RowBox[{"SignatureOfMetric", "->", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "0"}], "}"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", "met"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"MetricInBasis", "[", 
      RowBox[{"g", ",", 
       RowBox[{"-", "sphericalchart"}], ",", "SchwarComponents"}], "]"}], 
     ";"}], " ", 
    RowBox[{"(*", 
     RowBox[{
     "Cast", " ", "the", " ", "components", " ", "onto", " ", "the", " ", 
      "metric", " ", "object"}], "*)"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MetricCompute", "[", 
     RowBox[{"g", ",", "sphericalchart", ",", "All"}], "]"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Precompute", " ", "all", " ", "metric"}], "-", 
      RowBox[{"derived", " ", "quantities"}]}], ",", " ", 
     RowBox[{"e", ".", "g", ".", " ", "christoffel"}], ",", " ", "riemann", 
     ",", " ", 
     RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "represent", " ", "the", " ", "metric", " ", "in", " ", "a", " ", 
     "CTensor", " ", "form"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"met", " ", "=", " ", 
       RowBox[{
        RowBox[{"ToCTensor", "[", 
         RowBox[{"g", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "sphericalchart"}], ",", " ", 
            RowBox[{"-", "sphericalchart"}]}], "}"}]}], "]"}], "/.", 
        RowBox[{"TensorValues", "[", "g", "]"}]}]}], ")"}], "[", 
     RowBox[{
      RowBox[{"-", "\[Mu]"}], ",", 
      RowBox[{"-", "\[Nu]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "the", " ", "covariant", " ", "derivative", " ", "of", " ",
      "this", " ", "CTensor", " ", "metric"}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Cd", " ", "=", " ", 
     RowBox[{"CovDOfMetric", "[", "met", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "christoffel", " ", "in", " ", "CTensor", " ", 
     RowBox[{"repr", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"christoffel", " ", "=", " ", 
     RowBox[{"Head", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ChristoffelFromMetric", "[", 
          RowBox[{
           RowBox[{"met", "[", 
            RowBox[{
             RowBox[{"-", "\[Mu]"}], ",", 
             RowBox[{"-", "\[Nu]"}]}], "]"}], ",", " ", "sphericalchart"}], 
          "]"}], "[", 
         RowBox[{"\[Alpha]", ",", 
          RowBox[{"-", "\[Beta]"}], ",", 
          RowBox[{"-", "\[Gamma]"}]}], "]"}], "//", "FromBasisExpand"}], "//",
        "Simplification"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Delta", " ", "=", " ", 
      RowBox[{
       SuperscriptBox["r", "2"], "-", 
       RowBox[{"2", "*", "M", "*", "r"}], "+", 
       SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Sigma", " ", "=", " ", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], "*", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qr", " ", "=", " ", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       SuperscriptBox["\[Lambda]", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"qth", " ", "=", " ", 
      RowBox[{
       SuperscriptBox["\[Lambda]", "2"], "-", 
       RowBox[{
        SuperscriptBox["a", "2"], "*", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Polarization", " ", "tensor", " ", "components"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"See", " ", 
       RowBox[{"arXiv", ":", "2004.09536"}]}], "*)"}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dr", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dt", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d\[Theta]", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d\[Phi]", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"h", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "*", "dr"}], " ", "+", " ", 
           RowBox[{
            SuperscriptBox["a", "2"], "*", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", "d\[Theta]"}]}], 
          ")"}], "\[TensorWedge]", "dt"}]}], " ", "+", " ", 
       RowBox[{"a", "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "*", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", "dr"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r", "2"], "+", 
              SuperscriptBox["a", "2"]}], ")"}], "*", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", "d\[Theta]"}]}], 
          ")"}], "\[TensorWedge]", "d\[Phi]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Bsymb", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<B\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sys", " ", "=", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Bsymb", "[", 
             RowBox[{"[", 
              RowBox[{"\[Alpha]", ",", "\[Gamma]"}], "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"KerrComponents", "[", 
               RowBox[{"[", 
                RowBox[{"\[Gamma]", ",", "\[Beta]"}], "]"}], "]"}], " ", "+", 
              " ", 
              RowBox[{"I", "*", 
               FractionBox[
                RowBox[{"h", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Gamma]", ",", "\[Beta]"}], "]"}], "]"}], 
                "\[Lambda]"]}]}], ")"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"equ", " ", "=", 
      RowBox[{"Flatten", "[", " ", 
       RowBox[{"Thread", "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"sys", "==", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Coeffs", " ", "=", " ", 
      RowBox[{"Flatten", "@", "Bsymb"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol", " ", "=", " ", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{"equ", ",", " ", "Coeffs", ",", " ", 
         RowBox[{"Assumptions", "\[Rule]", "True"}]}], "]"}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PolarizationComponents", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Bsymb", "/.", "sol"}], "//", "FullSimplify"}], "//", 
       "First"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PolarizationComponents", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox["\[Lambda]", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "+", 
                    SuperscriptBox["r", "2"]}], ")"}], "2"], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
                   ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    SuperscriptBox["\[Lambda]", "2"]}], ")"}]}]]}], "+", 
               FractionBox[
                RowBox[{
                 SuperscriptBox["a", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
                RowBox[{
                 SuperscriptBox["\[Lambda]", "2"], "-", 
                 RowBox[{
                  SuperscriptBox["a", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], 
              ")"}]}], 
            RowBox[{
             SuperscriptBox["r", "2"], "+", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]], ",", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "r", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               SuperscriptBox["r", "2"]}], ")"}], " ", "\[Lambda]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               SuperscriptBox["\[Lambda]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]], 
           ",", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["a", "2"], " ", "\[Lambda]", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Lambda]", "2"], "-", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], " ", 
             
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]], 
           ",", 
           FractionBox[
            RowBox[{"a", " ", 
             SuperscriptBox["\[Lambda]", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{
                  SuperscriptBox["a", "2"], "+", 
                  SuperscriptBox["r", "2"]}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
                   ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    SuperscriptBox["\[Lambda]", "2"]}], ")"}]}]]}], "+", 
               FractionBox["1", 
                RowBox[{
                 SuperscriptBox["\[Lambda]", "2"], "-", 
                 RowBox[{
                  SuperscriptBox["a", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], 
              ")"}]}], 
            RowBox[{
             SuperscriptBox["r", "2"], "+", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "r", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                SuperscriptBox["r", "2"]}], ")"}], " ", "\[Lambda]"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r", "2"], "+", 
                SuperscriptBox["\[Lambda]", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r", "2"], "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]]}],
            ",", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
              ")"}], " ", 
             SuperscriptBox["\[Lambda]", "2"]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               SuperscriptBox["\[Lambda]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]], 
           ",", "0", ",", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "a", " ", "r", " ", "\[Lambda]"}], 
             
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r", "2"], "+", 
                SuperscriptBox["\[Lambda]", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r", "2"], "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], 
               ")"}]}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", 
              SuperscriptBox["a", "2"], " ", "\[Lambda]", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Lambda]", "2"], "-", 
                RowBox[{
                 SuperscriptBox["a", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r", "2"], "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]]}],
            ",", "0", ",", 
           FractionBox[
            SuperscriptBox["\[Lambda]", "2"], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Lambda]", "2"], "-", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], " ", 
             
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]], 
           ",", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "a", " ", "\[Lambda]", " ", 
              RowBox[{"Cot", "[", "\[Theta]", "]"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Lambda]", "2"], "-", 
                RowBox[{
                 SuperscriptBox["a", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r", "2"], "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], 
               ")"}]}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"a", " ", 
             SuperscriptBox["\[Lambda]", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{
                  SuperscriptBox["a", "2"], "+", 
                  SuperscriptBox["r", "2"]}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
                   ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    SuperscriptBox["\[Lambda]", "2"]}], ")"}]}]]}], "+", 
               FractionBox["1", 
                RowBox[{
                 SuperscriptBox["\[Lambda]", "2"], "-", 
                 RowBox[{
                  SuperscriptBox["a", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], 
              ")"}]}], 
            RowBox[{
             SuperscriptBox["r", "2"], "+", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]], ",", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "a", " ", "r", " ", "\[Lambda]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               SuperscriptBox["\[Lambda]", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]], 
           ",", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "a", " ", "\[Lambda]", " ", 
             RowBox[{"Cot", "[", "\[Theta]", "]"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Lambda]", "2"], "-", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], " ", 
             
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]], 
           ",", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[Lambda]", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 SuperscriptBox["a", "2"], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
                   ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    SuperscriptBox["\[Lambda]", "2"]}], ")"}]}]]}], "+", 
               FractionBox[
                SuperscriptBox[
                 RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], 
                RowBox[{
                 SuperscriptBox["\[Lambda]", "2"], "-", 
                 RowBox[{
                  SuperscriptBox["a", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], 
              ")"}]}], 
            RowBox[{
             SuperscriptBox["r", "2"], "+", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], "}"}]}], 
        "}"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "->", 
         RowBox[{"r", "[", "]"}]}], ",", 
        RowBox[{"\[Theta]", "->", 
         RowBox[{"\[Theta]", "[", "]"}]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Define", " ", "the", " ", "polarization", " ", "tensor", " ", 
      "object"}], ",", " ", 
     RowBox[{"then", " ", "assign", " ", "values", " ", "to", " ", "it"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefTensor", "[", 
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], ",", " ", "\[ScriptCapitalM]", 
      ",", " ", 
      RowBox[{"PrintAs", "->", " ", "\"\<B\>\""}]}], "]"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "the", " ", "tensor", " ", "object"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "Print", "}"}], ",", 
      RowBox[{"ComponentValue", "[", 
       RowBox[{
        RowBox[{"ComponentArray", "[", 
         RowBox[{"B", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "sphericalchart"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "sphericalchart"}], "}"}]}], "]"}], "]"}], 
        ",", " ", "PolarizationComponents"}], "]"}]}], "]"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "Assign", " ", "values", " ", "to", " ", "the", " ", "components"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Convert", " ", "to", " ", "the", " ", "CTensor", " ", "representation"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Polarization", " ", "=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ToCTensor", "[", 
        RowBox[{"B", ",", 
         RowBox[{"{", 
          RowBox[{"sphericalchart", ",", "sphericalchart"}], "}"}]}], "]"}], "/.", 
       RowBox[{"TensorValues", "[", "B", "]"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"\[CapitalSigma]", ",", "\[CapitalDelta]", ",", "\[Sigma]"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "some", " ", "scalar", " ", "fields"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefScalarFunction", "[", "Z", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefScalarFunction", "[", "S", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefScalarFunction", "[", "R", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefConstantSymbol", "[", "q", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefConstantSymbol", "[", "\[Pi]", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z", " ", "=", " ", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"r", "[", "]"}], "]"}], "*", 
      RowBox[{"S", "[", 
       RowBox[{"\[Theta]", "[", "]"}], "]"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "\[Omega]", "*", 
        RowBox[{"t", "[", "]"}]}], "]"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", "*", "m", "*", 
        RowBox[{"\[Phi]", "[", "]"}]}], "]"}]}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "Apply", " ", "the", " ", "FKKS", " ", "ansatz", " ", "decomposition", 
      " ", "of", " ", "auxiliary", " ", "field"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Define", " ", "the", " ", "FKKS", " ", "ansatz", " ", "for", " ", "the",
       " ", "vector", " ", "field"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gradZ", " ", "=", " ", 
     RowBox[{"Head", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cd", "[", 
         RowBox[{"-", "\[Nu]"}], "]"}], "@", "Z"}], "//", "FromBasisExpand"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FKKSA", " ", "=", " ", 
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Polarization", "[", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "*", 
         RowBox[{"gradZ", "[", 
          RowBox[{"-", "\[Nu]"}], "]"}]}], "//", "Simplify"}], "]"}], "//", 
      "Simplify"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.864772193368342*^9, 3.864772193684873*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"52cf0a52-63c4-4ef2-b325-04cc6b72b9ea"]
}, Closed]],

Cell[CellGroupData[{

Cell["Helper Functions", "Chapter",
 CellChangeTimes->{{3.8647721731001368`*^9, 
  3.864772174705913*^9}},ExpressionUUID->"20249831-5b11-485b-8e40-\
234137a89763"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OvertoneModeGroup", "[", 
    RowBox[{
     RowBox[{"nvalue_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"mvalue_", "?", "NumberQ"}]}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"AllSolutions", ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<Parameters\>\"", "]"}], "[", "\"\<n\>\"", 
          "]"}], "\[Equal]", "nvalue"}], "&"}]}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "\"\<Parameters\>\"", "]"}], "[", "\"\<m\>\"", 
        "]"}], "\[Equal]", "mvalue"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "59944"}], "/", "extracting"}], "-", "the", "-", 
     "function", "-", "from", "-", "interpolatingfunction", "-", 
     RowBox[{
      RowBox[{"object", "/", "59963"}], "#59963"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InterpolationToPiecewise", "[", 
    RowBox[{"if_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"main", ",", "default", ",", "grid"}], "}"}], ",", 
      RowBox[{
       RowBox[{"grid", "=", 
        RowBox[{"if", "[", "\"\<Grid\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Piecewise", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"if", "@", 
              RowBox[{"\"\<GetPolynomial\>\"", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x", "-", "#"}]}], "]"}]}], ",", 
             RowBox[{"x", "<", 
              RowBox[{"First", "@", "#"}]}]}], "}"}], "&"}], "/@", 
          RowBox[{"grid", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"if", "@", 
            RowBox[{"\"\<GetPolynomial\>\"", "[", 
             RowBox[{"#", ",", 
              RowBox[{"x", "-", "#"}]}], "]"}]}], "&"}], "@", 
          RowBox[{"grid", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}]}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"if", "[", "\"\<InterpolationMethod\>\"", "]"}], "==", 
     "\"\<Hermite\>\""}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CompileInterpolating", "[", "interp_InterpolatingFunction", "]"}],
    ":=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", "\[Psi]", "}"}], ",", " ", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"InterpolationToPiecewise", "[", 
       RowBox[{"interp", ",", " ", "\[Psi]"}], "]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParamsToReprRule", "[", "solution_", "]"}], ":=", 
   RowBox[{
    RowBox[{"AssociationThread", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Symbol", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"solution", "[", " ", "\"\<Parameters\>\"", "]"}], "//", 
          "Keys"}], ")"}]}], ")"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"solution", "[", " ", "\"\<Parameters\>\"", "]"}], "//", 
        "Values"}], ")"}]}], "]"}], "//", "Normal"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolToReprRule", "[", "solution_", "]"}], ":=", 
   RowBox[{"AssociationThread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", "\[Nu]", ",", "R", ",", "S"}], "}"}], "->", 
     RowBox[{"Values", "[", 
      RowBox[{"solution", "[", 
       RowBox[{"[", 
        RowBox[{"\"\<Solution\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\[Omega]\>\"", ",", " ", "\"\<\[Nu]\>\"", ",", " ", 
           "\"\<R\>\"", ",", " ", "\"\<S\>\""}], "}"}]}], "]"}], "]"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HorizonCoordToRadial", "[", 
    RowBox[{"xN_", ",", " ", "\[Chi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"xN", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rplusN", "[", "\[Chi]", "]"}], "-", 
       RowBox[{"rminusN", "[", "\[Chi]", "]"}]}], ")"}]}], " ", "+", " ", 
    RowBox[{"rplusN", "[", "\[Chi]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RadialToHorizonCoord", "[", 
     RowBox[{"rN_", ",", "\[Chi]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"rN", "-", 
       RowBox[{"rplusN", "[", "\[Chi]", "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rplusN", "[", "\[Chi]", "]"}], "-", 
       RowBox[{"rminusN", "[", "\[Chi]", "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToParamSymbols", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "->", "\[Chi]"}], ",", " ", 
      RowBox[{"\[Lambda]", "->", 
       FractionBox["1", "\[Nu]"]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ApplySolutionSet", "[", "solution_", "]"}], "[", "expr_", "]"}],
     ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"expr", "/.", "ToParamSymbols"}], "/.", 
      RowBox[{"ParamsToReprRule", "[", "solution", "]"}]}], "/.", 
     RowBox[{"SolToReprRule", "[", "solution", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToXACTSymbol", "[", "expr_", "]"}], ":=", 
  RowBox[{"expr", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "->", 
      RowBox[{"t", "[", "]"}]}], ",", " ", 
     RowBox[{"r", "->", 
      RowBox[{"r", "[", "]"}]}], ",", " ", 
     RowBox[{"\[Theta]", "->", 
      RowBox[{"\[Theta]", "[", "]"}]}], ",", " ", 
     RowBox[{"\[Phi]", "->", 
      RowBox[{"\[Phi]", "[", "]"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FromXACTSymbol", "[", "expr_", "]"}], ":=", 
  RowBox[{"expr", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"t", "[", "]"}], "->", "t"}], ",", 
     RowBox[{
      RowBox[{"r", "[", "]"}], "->", "r"}], ",", " ", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "]"}], "->", "\[Theta]"}], ",", " ", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "]"}], "->", " ", "\[Phi]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyParameters", "[", "solution_", "]"}], "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "->", 
       RowBox[{"solution", "[", 
        RowBox[{"[", 
         RowBox[{"\"\<Parameters\>\"", ",", "\"\<\[Chi]\>\""}], "]"}], 
        "]"}]}], ",", " ", 
      RowBox[{"\[Lambda]", "->", " ", 
       RowBox[{"1", "/", 
        RowBox[{"solution", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}], 
         "]"}]}]}], ",", " ", 
      RowBox[{"m", "->", " ", 
       RowBox[{"solution", "[", 
        RowBox[{"[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], 
        "]"}]}], ",", " ", 
      RowBox[{"n", "->", " ", 
       RowBox[{"solution", "[", 
        RowBox[{"[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<n\>\""}], "]"}], 
        "]"}]}]}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OptimizedFunction", "[", "expr_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmpOE", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmpOE", " ", "=", " ", 
      RowBox[{"Experimental`OptimizeExpression", "[", 
       RowBox[{"expr", ",", " ", 
        RowBox[{"OptimizationSymbol", "->", "a"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmpOE", "/.", 
      RowBox[{
       RowBox[{"Experimental`OptimizedExpression", "[", "f_", "]"}], ":>", 
       RowBox[{"Function", "@@", 
        RowBox[{"Hold", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
          ",", " ", "f"}], "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8647722131139297`*^9, 3.8647723018369303`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"87013ee7-0c72-4433-8d6c-a434a81e80fd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculations", "Chapter",
 CellChangeTimes->{{3.86477246720536*^9, 
  3.864772468619419*^9}},ExpressionUUID->"d3e09280-d5e4-416f-bcb3-\
f5fbef1a6b9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"FSFilePath", " ", "=", " ", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Expressions/FKKSFieldStrengthCTensor.mx\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "FSFilePath", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FKKSFieldStrength", " ", "=", " ", 
        RowBox[{"Import", "[", "FSFilePath", "]"}]}], ";"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FKKSFieldStrength", " ", "=", " ", 
        RowBox[{"Head", "[", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Cd", "[", 
              RowBox[{"-", "\[Mu]"}], "]"}], "@", 
             RowBox[{"FKKSA", "[", 
              RowBox[{"-", "\[Nu]"}], "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"Cd", "[", 
              RowBox[{"-", "\[Nu]"}], "]"}], "@", 
             RowBox[{"FKKSA", "[", 
              RowBox[{"-", "\[Mu]"}], "]"}]}]}], ",", " ", 
           RowBox[{"TimeConstraint", "\[Rule]", "Infinity"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"FSFilePath", ",", " ", "FKKSFieldStrength"}], "]"}], ";"}]}],
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"EMFilePath", " ", "=", " ", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Expressions/FKKSEnergyMomentumCTensor.mx\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "EMFilePath", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FKKSEnergyMomentum", " ", "=", " ", 
        RowBox[{"Import", "[", "EMFilePath", "]"}]}], ";"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FKKSEnergyMomentum", "=", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"Head", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FKKSFieldStrength", "[", 
             RowBox[{
              RowBox[{"-", "\[Mu]"}], ",", 
              RowBox[{"-", "\[Gamma]"}]}], "]"}], 
            RowBox[{"FKKSFieldStrength", "[", 
             RowBox[{
              RowBox[{"-", "\[Nu]"}], ",", "\[Gamma]"}], "]"}]}], " ", "+", 
           " ", 
           RowBox[{
            SuperscriptBox["\[Mu]N", "2"], "*", 
            RowBox[{"FKKSA", "[", 
             RowBox[{"-", "\[Mu]"}], "]"}], 
            RowBox[{"FKKSA", "[", 
             RowBox[{"-", "\[Nu]"}], "]"}]}], " ", "-", " ", 
           RowBox[{
            RowBox[{"met", "[", 
             RowBox[{
              RowBox[{"-", "\[Mu]"}], ",", 
              RowBox[{"-", "\[Nu]"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["1", "4"], 
               RowBox[{"FKKSFieldStrength", "[", 
                RowBox[{
                 RowBox[{"-", "\[Iota]"}], ",", 
                 RowBox[{"-", "\[Gamma]"}]}], "]"}], 
               RowBox[{"FKKSFieldStrength", "[", 
                RowBox[{"\[Iota]", ",", "\[Gamma]"}], "]"}]}], " ", "+", " ", 
              
              RowBox[{
               FractionBox["1", "2"], "*", 
               SuperscriptBox["\[Mu]N", "2"], 
               RowBox[{"FKKSA", "[", 
                RowBox[{"-", "\[Gamma]"}], "]"}], 
               RowBox[{"FKKSA", "[", "\[Gamma]", "]"}]}]}], ")"}]}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "FKKSEnergyMomentum", "]"}], "!=", 
           "CTensor"}], "]"}], ",", 
         RowBox[{"Print", "[", "\"\<ERROR\>\"", "]"}], ",", 
         RowBox[{"Export", "[", 
          RowBox[{"EMFilePath", ",", "FKKSEnergyMomentum"}], "]"}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FKKSEnergyDensity", "[", "solution_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", " ", "resOE"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ENFilePath", " ", "=", " ", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
          "\"\<Expressions/FKKSEnergyDensity.mx\>\""}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "[", "ENFilePath", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"Import", "[", "ENFilePath", "]"}]}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{
             RowBox[{"FKKSEnergyMomentum", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "sphericalchart"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "sphericalchart"}]}], "}"}]}], "]"}], "//", 
             "PrepareArguments"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{"ENFilePath", ",", " ", "res"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"OptimizedResult", " ", "=", " ", 
      RowBox[{"OptimizedFunction", "[", 
       RowBox[{
        RowBox[{"ApplySolutionSet", "[", "solution", "]"}], "[", "res", "]"}],
        "]"}]}], ";", "\[IndentingNewLine]", " ", "OptimizedResult"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.86296478405648*^9, 3.862964797928751*^9}, {
   3.862964840111762*^9, 3.86296484217303*^9}, {3.862964908813917*^9, 
   3.862965009651157*^9}, {3.862965230282201*^9, 3.8629652312933197`*^9}, {
   3.862982580320877*^9, 3.862982580674638*^9}, {3.862982612367734*^9, 
   3.862982684798275*^9}, {3.862985770571732*^9, 3.8629857710576897`*^9}, 
   3.862986393099662*^9, {3.862987297807922*^9, 3.862987298614695*^9}, {
   3.8629998794574614`*^9, 3.862999955613813*^9}, {3.86300013671996*^9, 
   3.8630002598486156`*^9}, {3.8630003429524*^9, 3.863000356166847*^9}, {
   3.863000537168293*^9, 3.863000537854085*^9}, {3.863000836901215*^9, 
   3.863000849734869*^9}, {3.863000946118361*^9, 3.863000957287278*^9}, {
   3.863001060051186*^9, 3.863001093500208*^9}, {3.86300117353445*^9, 
   3.863001174004702*^9}, {3.863001214606779*^9, 3.863001228030488*^9}, {
   3.8630013724091377`*^9, 3.8630013733736067`*^9}, {3.863001482606349*^9, 
   3.8630014827433443`*^9}, {3.863001546764303*^9, 3.863001552983993*^9}, {
   3.863001618394167*^9, 3.8630016422593822`*^9}, {3.863055654185041*^9, 
   3.863055751910643*^9}, 3.8631457963368073`*^9, {3.8631458394781637`*^9, 
   3.863145842214869*^9}, {3.863511239810791*^9, 3.863511278393475*^9}, {
   3.863511320933571*^9, 3.863511327252615*^9}, {3.8635115277365026`*^9, 
   3.863511565013465*^9}, {3.863511886919592*^9, 3.863511888146443*^9}, {
   3.863515215303681*^9, 3.863515219307349*^9}, {3.863568772466608*^9, 
   3.863568772793222*^9}, {3.863569067503461*^9, 3.863569067866576*^9}, {
   3.863584130137822*^9, 3.863584162574316*^9}, {3.863584384767589*^9, 
   3.863584385511188*^9}, 3.8635852480519037`*^9, {3.863587837291803*^9, 
   3.863587849387588*^9}, {3.863588561766613*^9, 3.863588570688809*^9}, 
   3.8635890565352163`*^9, {3.863589099528594*^9, 3.863589101192083*^9}, 
   3.8635891326703444`*^9, 3.863589189064715*^9, 3.8635893661742563`*^9, 
   3.863589592161407*^9, {3.86365359842999*^9, 3.863653621119597*^9}, {
   3.863669052591894*^9, 3.863669159958745*^9}, {3.8636692224936657`*^9, 
   3.863669345464683*^9}, {3.863669425804551*^9, 3.86366952756924*^9}, {
   3.863673393878797*^9, 3.863673529046822*^9}, 3.863673564377694*^9, {
   3.863677078940943*^9, 3.863677182450512*^9}, {3.8636772255896387`*^9, 
   3.863677324354272*^9}, {3.863677437581396*^9, 3.863677438005031*^9}, {
   3.863677487680975*^9, 3.863677513204133*^9}, {3.863678868009391*^9, 
   3.863678938033601*^9}, {3.8636791698004827`*^9, 3.863679170081979*^9}, 
   3.8636793815563917`*^9, {3.863680683089189*^9, 3.863680689727603*^9}, {
   3.863681434418895*^9, 3.8636814379244204`*^9}, {3.863681561268018*^9, 
   3.8636815897717113`*^9}, {3.863681711146172*^9, 3.863681712532827*^9}, {
   3.863682024042235*^9, 3.863682099037199*^9}, {3.8637441945801287`*^9, 
   3.863744198640541*^9}, {3.863744599275713*^9, 3.8637446499998083`*^9}, {
   3.863744680528454*^9, 3.8637447274483128`*^9}, {3.863744767015079*^9, 
   3.8637448215524893`*^9}, {3.8637491391595783`*^9, 
   3.8637491510398693`*^9}, {3.863749488654451*^9, 3.8637494953357763`*^9}, {
   3.863749539579193*^9, 3.8637495503904543`*^9}, {3.863749695422399*^9, 
   3.863749733971833*^9}, {3.863749799862486*^9, 3.863749802019219*^9}, {
   3.8637498407174263`*^9, 3.863749890526331*^9}, {3.863749972067936*^9, 
   3.863749986369752*^9}, {3.863750038491314*^9, 3.8637500410629*^9}, {
   3.8637500925878363`*^9, 3.8637501619839897`*^9}, {3.8637502115410767`*^9, 
   3.8637502304309893`*^9}, {3.863751140276918*^9, 3.863751243800275*^9}, {
   3.863751316901599*^9, 3.863751322106007*^9}, {3.863751618142516*^9, 
   3.863751744503286*^9}, {3.863751841164825*^9, 3.863751891543674*^9}, {
   3.86375200791372*^9, 3.8637525650962677`*^9}, {3.863753858610589*^9, 
   3.8637539996473217`*^9}, {3.863754061056967*^9, 3.863754076221389*^9}, {
   3.8638523613869877`*^9, 3.863852365594386*^9}, {3.863853289166148*^9, 
   3.863853289341065*^9}, {3.864089815544677*^9, 3.864089973412528*^9}, {
   3.864090016347048*^9, 3.8640900221050587`*^9}, {3.864101234269256*^9, 
   3.8641012520768957`*^9}, {3.8641026389910717`*^9, 3.864102669797254*^9}, {
   3.864106893737994*^9, 3.864106901760868*^9}, {3.864106958800797*^9, 
   3.8641070027230873`*^9}, {3.864107417034274*^9, 3.864107417997458*^9}, {
   3.864115775564822*^9, 3.864115780393888*^9}, 3.8641160484733458`*^9, {
   3.864116480590489*^9, 3.864116482712187*^9}, {3.864116960953964*^9, 
   3.864116968336052*^9}, 3.864117327680854*^9, {3.864117360685666*^9, 
   3.864117368602954*^9}, {3.864194550233235*^9, 3.86419455054154*^9}, {
   3.864195634567072*^9, 3.864195636202647*^9}, {3.864280829563128*^9, 
   3.864280833954232*^9}, {3.864718960114452*^9, 3.864718990868341*^9}, {
   3.864719055734871*^9, 3.864719058686265*^9}, 3.864721913903487*^9, {
   3.864722640788136*^9, 3.8647226771991158`*^9}, 3.8647228349461393`*^9, {
   3.8647230103566732`*^9, 3.8647230127169733`*^9}, {3.8647721632948437`*^9, 
   3.864772231699917*^9}, {3.864772498829484*^9, 3.8647725310222588`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"c3e1fed8-7f33-4a22-a40f-88b01dc112ff"]
}, Closed]]
},
WindowSize->{1440, 756},
WindowMargins->{{0, Automatic}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"422e4b80-3b30-4473-81df-e2b209a10e34"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 155, 3, 69, "Chapter",ExpressionUUID->"df089bd2-7508-4f17-af93-48e1db9523e7"],
Cell[738, 27, 9658, 256, 939, "Input",ExpressionUUID->"77961498-7f7f-4deb-a3b2-0c7e8c450b6d"]
}, Closed]],
Cell[CellGroupData[{
Cell[10433, 288, 165, 3, 58, "Chapter",ExpressionUUID->"29d04ea6-d448-4f2a-903b-a84be54376ee"],
Cell[10601, 293, 38133, 1021, 1808, "Input",ExpressionUUID->"52cf0a52-63c4-4ef2-b325-04cc6b72b9ea"]
}, Closed]],
Cell[CellGroupData[{
Cell[48771, 1319, 163, 3, 58, "Chapter",ExpressionUUID->"20249831-5b11-485b-8e40-234137a89763"],
Cell[48937, 1324, 8658, 247, 627, "Input",ExpressionUUID->"87013ee7-0c72-4433-8d6c-a434a81e80fd"]
}, Closed]],
Cell[CellGroupData[{
Cell[57632, 1576, 156, 3, 58, "Chapter",ExpressionUUID->"d3e09280-d5e4-416f-bcb3-f5fbef1a6b9e"],
Cell[57791, 1581, 11240, 226, 737, "Input",ExpressionUUID->"c3e1fed8-7f33-4a22-a40f-88b01dc112ff"]
}, Closed]]
}
]
*)

