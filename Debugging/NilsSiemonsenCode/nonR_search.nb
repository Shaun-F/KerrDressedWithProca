(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    133770,       3288]
NotebookOptionsPosition[    132923,       3265]
NotebookOutlinePosition[    133379,       3283]
CellTagsIndexPosition[    133336,       3280]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"min", "=", "1"}], ";", 
  RowBox[{"nin", "=", "0"}], ";", 
  RowBox[{"spin", "=", "0.9"}], ";", 
  RowBox[{"\[Mu]sta", "=", 
   FractionBox["3", "25"]}], ";", " ", 
  RowBox[{"\[Mu]sto", "=", "0.121"}], ";", 
  RowBox[{"branch1", "=", "1"}], ";", 
  RowBox[{"\[Omega]ImIn", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]]}], ";", 
  RowBox[{"Sin", "=", 
   RowBox[{"-", "1"}]}], ";", 
  RowBox[{"direc", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"QNMnonRel", "[", 
  RowBox[{
  "1", ",", "0", ",", "0.9", ",", "\[Mu]sta", ",", "\[Mu]sto", ",", "1", ",", 
   
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]], ",", 
   RowBox[{"-", "1"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8607373887257957`*^9, 3.860737427124851*^9}, {
  3.860737800618721*^9, 3.860737800993079*^9}, {3.8607383011218157`*^9, 
  3.8607383012585297`*^9}, {3.861190978124674*^9, 3.861190980354725*^9}, {
  3.8611910164856167`*^9, 3.8611910199921417`*^9}, {3.861622928786317*^9, 
  3.861622954674384*^9}},
 CellLabel->
  "(Local2) In[4]:=",ExpressionUUID->"1c2b1f05-e261-482b-aca3-7d09633fb8a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rstop", "[", "\[Mu]sta", "]"}]], "Input",
 CellChangeTimes->{{3.8616237525770397`*^9, 3.861623768410502*^9}},
 CellLabel->
  "(Local2) In[20]:=",ExpressionUUID->"53f434b0-848b-4f5c-9872-b309f5c1b278"],

Cell[BoxData[
 FractionBox["12500", "9"]], "Output",
 CellChangeTimes->{{3.861623762307742*^9, 3.8616237688617773`*^9}},
 CellLabel->
  "(Local2) Out[20]=",ExpressionUUID->"4c68787c-3ca9-4675-99fd-c0b7f83bd38e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"modedataoutput", "[", 
  RowBox[{"[", 
   RowBox[{"-", "2"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", "r", "]"}], "//", "Abs"}], ",", 
   " ", 
   RowBox[{"{", 
    RowBox[{"r", ",", "1.426", ",", " ", "200"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.861623528546232*^9, 3.861623569864367*^9}},
 CellLabel->
  "(Local2) In[16]:=",ExpressionUUID->"4b95c475-8145-4ac5-9b81-20add96494e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QNMnonRel", "[", 
    RowBox[{
    "min_", ",", "nin_", ",", "spin_", ",", "\[Mu]sta_", ",", "\[Mu]sto_", 
     ",", "branch1_", ",", "\[Omega]ImIn_", ",", "Sin_", ",", "direc_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"min1", "=", "min"}], ",", 
       RowBox[{"nin1", "=", "nin"}], ",", 
       RowBox[{"spin1", "=", "spin"}], ",", 
       RowBox[{"\[Mu]sta1", "=", "\[Mu]sta"}], ",", 
       RowBox[{"\[Mu]sto1", "=", "\[Mu]sto"}], ",", 
       RowBox[{"branch2", "=", "branch1"}], ",", 
       RowBox[{"wijk", "=", "\[Omega]ImIn"}], ",", 
       RowBox[{"Sin1", "=", "Sin"}]}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"destinationPATH", "=", 
       RowBox[{
       "ToString", "[", 
        "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_\
Field_Dynamical_Friction/ProcaAroundKerr/NilsSiemonsenCode/surrogate\>\"", 
        "]"}]}], ";", "\n", 
      RowBox[{"$Assumptions", "=", 
       RowBox[{
        RowBox[{"M", ">", "0"}], "&&", 
        RowBox[{"x", "!=", "0"}]}]}], ";", "\n", 
      RowBox[{"kmax", "=", "5"}], ";", "\n", 
      RowBox[{"xmax", "=", "2"}], ";", "\n", 
      RowBox[{"\[Epsilon]", "=", 
       RowBox[{"10", "^", 
        RowBox[{"-", "6"}]}]}], ";", "\n", 
      RowBox[{"xstart", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", " ", "M"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rp", "[", "a", "]"}], "-", 
            RowBox[{"rm", "[", "a", "]"}]}], ")"}]}], "//", "Simplify"}], "//", 
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";", "\n", 
      RowBox[{"\[Omega]nmax", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", " ", "\[Chi]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"1", "-", 
               RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}], ")"}]}], ")"}]}], "//",
         "Simplify"}]}], ";", "\n", 
      RowBox[{"setprec", "=", "24"}], ";", "\n", 
      RowBox[{"maxstep", "=", 
       RowBox[{"10", "^", "8"}]}], ";", "\n", 
      RowBox[{"modeprec", "=", "20"}], ";", "\n", "\n", 
      RowBox[{"m", "=", "min"}], ";", "\n", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Sin", "==", "0"}], ",", "1", ",", "0"}], "]"}]}], ";", "\n", 
      RowBox[{"nh", "=", "nin"}], ";", "\n", 
      RowBox[{"S", "=", "Sin"}], ";", "\n", 
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"Abs", "[", "m", "]"}], "+", "nh", "+", "S", "+", "1"}]}], 
      ";", "\n", 
      RowBox[{"\[Chi]", "=", 
       RowBox[{"spin", "//", 
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";", "\n", "\n", 
      RowBox[{
      "Print", "[", "\"\<We consider the following parameters:\>\"", "]"}], 
      ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<m = \>\"", "<>", 
        RowBox[{"ToString", "[", "m", "]"}]}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<n = \>\"", "<>", 
        RowBox[{"ToString", "[", "nh", "]"}]}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<\[Chi] = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"\[Chi]", "//", "N"}], "]"}]}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<S = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Sin", "//", "N"}], "]"}]}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<branch = \>\"", "<>", 
        RowBox[{"ToString", "[", "branch1", "]"}]}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Log of precision cutoff = 10^-\>\"", "<>", 
        RowBox[{"ToString", "[", "modeprec", "]"}]}], "]"}], ";", "\n", 
      RowBox[{
      "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
      ";", "\n", "\n", 
      RowBox[{"a", "=", 
       RowBox[{"\[Chi]", " ", "M"}]}], ";", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"\[Mu]n", "/", "M"}]}], " ", ";", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Omega]nr", "+", 
          RowBox[{"I", " ", "\[Omega]ni"}]}], ")"}], "/", "M"}]}], ";", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{"\[Nu]n", "/", "M"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"rp", "[", "a_", "]"}], ":=", 
       RowBox[{"M", "+", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"M", "^", "2"}], "-", 
          RowBox[{"a", "^", "2"}]}], "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"rm", "[", "a_", "]"}], ":=", 
       RowBox[{"M", "-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"M", "^", "2"}], "-", 
          RowBox[{"a", "^", "2"}]}], "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"rstop", "[", "\[Mu]_", "]"}], ":=", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"10", 
            RowBox[{"(", 
             RowBox[{"m", "+", "nh"}], ")"}]}], ")"}], "/", 
          RowBox[{"\[Mu]", "^", "2"}]}]}], "//", 
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"rtstart", "[", "a_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"xstart", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rp", "[", "a", "]"}], "-", 
               RowBox[{"rm", "[", "a", "]"}]}], ")"}]}], "+", 
            RowBox[{"rp", "[", "a", "]"}]}], ")"}], "/", "M"}], "//", 
         "Simplify"}], "//", 
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"\[CapitalOmega]H", "[", "a_", "]"}], ":=", 
       RowBox[{"a", "/", 
        RowBox[{"(", 
         RowBox[{"2", "M", " ", 
          RowBox[{"rp", "[", "a", "]"}]}], ")"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"\[CapitalDelta]", "[", 
        RowBox[{"r_", ",", "a_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"r", "^", "2"}], "-", 
        RowBox[{"2", "M", " ", "r"}], "+", 
        RowBox[{"a", "^", "2"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"Kr", "[", 
        RowBox[{"r_", ",", "a_", ",", "\[Omega]_", ",", "m_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "^", "2"}], "+", 
           RowBox[{"r", "^", "2"}]}], ")"}], "\[Omega]"}], "-", 
        RowBox[{"a", " ", "m"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"qr", "[", 
        RowBox[{"r_", ",", "\[Nu]_"}], "]"}], ":=", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"\[Nu]", "^", "2"}], " ", 
         RowBox[{"r", "^", "2"}]}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{
        "\[Nu]_", ",", "\[Mu]_", ",", "a_", ",", "m_", ",", "\[Omega]_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Mu]", "^", "2"}], "/", 
         RowBox[{"\[Nu]", "^", "2"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Omega]", "+", 
           RowBox[{"a", " ", 
            RowBox[{"\[Nu]", "^", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "-", 
              RowBox[{"a", " ", "\[Omega]"}]}], ")"}]}]}], ")"}], "/", 
         "\[Nu]"}], "+", 
        RowBox[{"2", "a", " ", "\[Omega]", " ", "m"}], "-", 
        RowBox[{
         RowBox[{"a", "^", "2"}], " ", 
         RowBox[{"\[Omega]", "^", "2"}]}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"\[Omega]_", ",", "\[Mu]_"}], "]"}], ":=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"\[Omega]", "^", "2"}], "-", 
         RowBox[{"\[Mu]", "^", "2"}]}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"\[Omega]_", ",", "a_", ",", "\[Nu]_", ",", "m_"}], "]"}], ":=", 
       RowBox[{"\[Omega]", "+", 
        RowBox[{"a", " ", 
         RowBox[{"\[Nu]", "^", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "-", 
           RowBox[{"a", " ", "\[Omega]"}]}], ")"}]}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"Three", "[", 
        RowBox[{"l1_", ",", "l2_", ",", "l3_", ",", "m1_"}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"l3", ">", 
           RowBox[{"l1", "+", "l2"}]}], "||", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"l1", "-", "l2"}], "]"}], ">", "l3"}], " ", "||", 
          RowBox[{
           RowBox[{"Abs", "[", "m1", "]"}], ">", "l1"}], "||", 
          RowBox[{
           RowBox[{"Abs", "[", "m1", "]"}], ">", "l3"}]}], ",", "0", ",", 
         RowBox[{"ThreeJSymbol", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l1", ",", 
             RowBox[{"-", "m1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l3", ",", "m1"}], "}"}]}], "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"Bracket", "[", 
        RowBox[{"l1_", ",", "l2_", ",", "l3_", ",", "m_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", "m"}], " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "l1"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "l2"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "l3"}], "+", "1"}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"4", "\[Pi]"}], ")"}]}], "]"}], 
        RowBox[{"Three", "[", 
         RowBox[{"l1", ",", "l2", ",", "l3", ",", "0"}], "]"}], 
        RowBox[{"Three", "[", 
         RowBox[{"l1", ",", "l2", ",", "l3", ",", "m"}], "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"c2", "[", 
        RowBox[{"l_", ",", "m_", ",", "lp_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"Sqrt", "[", "\[Pi]", "]"}]}], ")"}], "/", "3"}], " ", 
         RowBox[{"Bracket", "[", 
          RowBox[{"l", ",", "0", ",", "lp", ",", "m"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"4", "/", "3"}], " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "/", "5"}], "]"}], 
         RowBox[{"Bracket", "[", 
          RowBox[{"l", ",", "2", ",", "lp", ",", "m"}], "]"}]}]}]}], ";", 
      "\n", 
      RowBox[{
       RowBox[{"c4", "[", 
        RowBox[{"l_", ",", "m_", ",", "lp_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"Sqrt", "[", "\[Pi]", "]"}]}], ")"}], "/", "5"}], " ", 
         RowBox[{"Bracket", "[", 
          RowBox[{"l", ",", "0", ",", "lp", ",", "m"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"8", "/", "7"}], " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "/", "5"}], "]"}], 
         RowBox[{"Bracket", "[", 
          RowBox[{"l", ",", "2", ",", "lp", ",", "m"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"16", 
            RowBox[{"Sqrt", "[", "\[Pi]", "]"}]}], ")"}], "/", "105"}], " ", 
         RowBox[{"Bracket", "[", 
          RowBox[{"l", ",", "4", ",", "lp", ",", "m"}], "]"}]}]}]}], ";", 
      "\n", 
      RowBox[{
       RowBox[{"d2", "[", 
        RowBox[{"l_", ",", "m_", ",", "lp_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[Pi]"}], ")"}], "/", "3"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lp", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"lp", "+", "1"}], ")"}], "^", "2"}], "-", 
               RowBox[{"m", "^", "2"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "lp"}], "+", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "lp"}], "+", "3"}], ")"}]}], ")"}]}], "]"}], 
           RowBox[{"Bracket", "[", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"lp", "+", "1"}], ",", "m"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"lp", "+", "1"}], ")"}], 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lp", "^", "2"}], "-", 
               RowBox[{"m", "^", "2"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "lp"}], "+", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "lp"}], "-", "1"}], ")"}]}], ")"}]}], "]"}], 
           RowBox[{"Bracket", "[", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"lp", "-", "1"}], ",", "m"}], "]"}]}]}], ")"}]}]}], ";", 
      "\n", 
      RowBox[{
       RowBox[{"Mtemp", "[", 
        RowBox[{
        "l_", ",", "m_", ",", "lp_", ",", "\[Nu]_", ",", "\[Mu]_", ",", "a_", 
         ",", "\[Omega]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalLambda]", "[", 
             RowBox[{
             "\[Nu]", ",", "\[Mu]", ",", "a", ",", "m", ",", "\[Omega]"}], 
             "]"}], "-", 
            RowBox[{"lp", 
             RowBox[{"(", 
              RowBox[{"lp", "+", "1"}], ")"}]}]}], ")"}], 
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"l", ",", "lp"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"\[Nu]", "^", "2"}]}], 
             RowBox[{"\[CapitalLambda]", "[", 
              RowBox[{
              "\[Nu]", ",", "\[Mu]", ",", "a", ",", "m", ",", "\[Omega]"}], 
              "]"}]}], "+", 
            RowBox[{
             RowBox[{"\[Nu]", "^", "2"}], " ", "lp", 
             RowBox[{"(", 
              RowBox[{"lp", "+", "1"}], ")"}]}], "-", 
            RowBox[{"2", 
             RowBox[{"\[Sigma]", "[", 
              RowBox[{"\[Omega]", ",", "a", ",", "\[Nu]", ",", "m"}], "]"}], 
             "\[Nu]"}], "+", 
            RowBox[{
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"\[Omega]", ",", "\[Mu]"}], "]"}], "^", "2"}]}], ")"}], 
          
          RowBox[{"a", "^", "2"}], " ", 
          RowBox[{"c2", "[", 
           RowBox[{"l", ",", "m", ",", "lp"}], "]"}]}], "-", 
         RowBox[{"2", 
          RowBox[{"a", "^", "2"}], " ", 
          RowBox[{"\[Nu]", "^", "2"}], " ", 
          RowBox[{"d2", "[", 
           RowBox[{"l", ",", "m", ",", "lp"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{"\[Omega]", ",", "\[Mu]"}], "]"}], "^", "2"}], " ", 
          RowBox[{"\[Nu]", "^", "2"}], " ", 
          RowBox[{"a", "^", "4"}], " ", 
          RowBox[{"c4", "[", 
           RowBox[{"l", ",", "m", ",", "lp"}], "]"}]}]}], "//", "Refine"}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"Mat", "[", 
        RowBox[{
        "m_", ",", "\[Eta]_", ",", "\[Nu]_", ",", "\[Mu]_", ",", "a_", ",", 
         "\[Omega]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Mtemp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "m", "]"}], "+", 
             RowBox[{"2", "k"}], "+", "\[Eta]"}], ",", "m", ",", 
            RowBox[{
             RowBox[{"Abs", "[", "m", "]"}], "+", 
             RowBox[{"2", "kp"}], "+", "\[Eta]"}], ",", "\[Nu]", ",", "\[Mu]",
             ",", "a", ",", "\[Omega]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "kmax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"kp", ",", "0", ",", "kmax"}], "}"}]}], "]"}], "//", 
        "Simplify"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"\[Kappa]", "[", 
        RowBox[{"a_", ",", "\[Omega]_", ",", "m_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", " ", "M", " ", 
           RowBox[{"rp", "[", "a", "]"}], 
           RowBox[{"(", 
            RowBox[{"\[Omega]", "-", 
             RowBox[{"m", " ", 
              RowBox[{"\[CapitalOmega]H", "[", "a", "]"}]}]}], ")"}]}], ")"}],
          "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rp", "[", "a", "]"}], "-", 
           RowBox[{"rm", "[", "a", "]"}]}], ")"}]}], "//", "Simplify"}]}], 
      ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Clear", "[", 
           RowBox[{
           "\[Chi]", ",", "\[Omega]ni", ",", "\[Omega]nr", ",", "\[Nu]n", ",",
             "\[Mu]n", ",", "m", ",", "\[Eta]", ",", "a", ",", "\[Omega]", 
            ",", "\[Mu]", ",", "\[Nu]"}], "]"}], "\n", "DiffRadr"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"r", ",", "a"}], "]"}], 
              RowBox[{"D", "[", 
               RowBox[{"#", ",", "r"}], "]"}]}], ",", "r"}], "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Kr", "[", 
                 RowBox[{"r", ",", "a", ",", "\[Omega]", ",", "m"}], "]"}], 
                "^", "2"}], "/", 
               RowBox[{"\[CapitalDelta]", "[", 
                RowBox[{"r", ",", "a"}], "]"}]}], "-", 
              RowBox[{"\[CapitalLambda]", "[", 
               RowBox[{
               "\[Nu]", ",", "\[Mu]", ",", "a", ",", "m", ",", "\[Omega]"}], 
               "]"}], "+", 
              RowBox[{"2", " ", "a", " ", "\[Omega]", " ", "m"}], "-", 
              RowBox[{
               RowBox[{"a", "^", "2"}], 
               RowBox[{"\[Omega]", "^", "2"}]}], "-", 
              RowBox[{
               RowBox[{"\[Mu]", "^", "2"}], 
               RowBox[{"r", "^", "2"}]}]}], ")"}], "#"}], "-", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "r", " ", 
               RowBox[{"\[Nu]", "^", "2"}]}], ")"}], "/", 
             RowBox[{"qr", "[", 
              RowBox[{"r", ",", "\[Nu]"}], "]"}]}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalDelta]", "[", 
                RowBox[{"r", ",", "a"}], "]"}], 
               RowBox[{"D", "[", 
                RowBox[{"#", ",", "r"}], "]"}]}], "+", 
              RowBox[{"r", " ", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"\[Omega]", ",", "a", ",", "\[Nu]", ",", "m"}], 
                 "]"}], "/", "\[Nu]"}], "#"}]}], ")"}]}]}], "&"}]}], ";", 
        "\n", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"DiffRadr", "@", 
               RowBox[{"Y", "[", "r", "]"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{"Y", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Y", "[", 
                   RowBox[{"#", "/", "M"}], "]"}], "&"}], ")"}]}], "}"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{"r", "\[Rule]", 
               RowBox[{"rt", " ", "M"}]}], "}"}]}], "//", "Simplify"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Y", "[", "rt", "]"}], ",", 
             RowBox[{
              RowBox[{"Y", "'"}], "[", "rt", "]"}], ",", 
             RowBox[{
              RowBox[{"Y", "''"}], "[", "rt", "]"}]}], "}"}]}], "]"}], "\n", 
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"DiffRadr", "@", 
                 RowBox[{"f", "[", "r", "]"}]}], "/.", 
                RowBox[{"{", 
                 RowBox[{"f", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"rp", "[", "a", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rp", "[", "a", "]"}], "-", 
                    RowBox[{"rm", "[", "a", "]"}]}], ")"}]}], "]"}], "&"}], 
                   ")"}]}], "}"}]}], "/.", 
               RowBox[{"{", 
                RowBox[{"r", "\[Rule]", 
                 RowBox[{
                  RowBox[{"x", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rp", "[", "a", "]"}], "-", 
                    RowBox[{"rm", "[", "a", "]"}]}], ")"}]}], "+", 
                  RowBox[{"rp", "[", "a", "]"}]}]}], "}"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"x", 
               RowBox[{"(", 
                RowBox[{"1", "+", "x"}], ")"}]}], ")"}]}], "//", "Simplify"}],
            ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"f", "[", "x", "]"}], ",", 
             RowBox[{
              RowBox[{"f", "'"}], "[", "x", "]"}], ",", 
             RowBox[{
              RowBox[{"f", "''"}], "[", "x", "]"}]}], "}"}]}], "]"}]}]}], 
       "*)"}], "\n", 
      RowBox[{"DiffRadrt", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", 
                 RowBox[{"rt", "^", "2"}], " ", "\[Nu]n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"m", " ", 
                    RowBox[{"\[Nu]n", "^", "2"}], " ", "\[Chi]"}], "-", 
                   RowBox[{"I", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"\[Nu]n", "^", "2"}], " ", 
                    RowBox[{"\[Chi]", "^", "2"}]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Omega]ni", "-", 
                    RowBox[{"I", " ", "\[Omega]nr"}]}], ")"}]}]}], ")"}]}], 
                ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    RowBox[{"rt", "^", "2"}], " ", 
                    RowBox[{"\[Nu]n", "^", "2"}]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "2"}], " ", "rt"}], "+", 
                   RowBox[{"rt", "^", "2"}], "+", 
                   RowBox[{"\[Chi]", "^", "2"}]}], ")"}]}], ")"}]}], ")"}]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"rt", "^", "2"}]}], " ", 
                RowBox[{"\[Mu]n", "^", "2"}]}], "-", 
               RowBox[{
                RowBox[{"\[Mu]n", "^", "2"}], "/", 
                RowBox[{"\[Nu]n", "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"m", " ", "\[Chi]"}], "-", 
                   RowBox[{"I", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rt", "^", "2"}], "+", 
                    RowBox[{"\[Chi]", "^", "2"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Omega]ni", "-", 
                    RowBox[{"I", " ", "\[Omega]nr"}]}], ")"}]}]}], ")"}], "^",
                  "2"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "rt"}], "+", 
                  RowBox[{"rt", "^", "2"}], "+", 
                  RowBox[{"\[Chi]", "^", "2"}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"I", " ", "\[Omega]ni"}], "+", "\[Omega]nr"}], 
                 ")"}], "/", "\[Nu]n"}], "+", 
               RowBox[{"\[Nu]n", " ", "\[Chi]", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "-", 
                  RowBox[{"\[Chi]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"I", " ", "\[Omega]ni"}], "+", "\[Omega]nr"}], 
                    ")"}]}]}], ")"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "rt"}], "+", 
               RowBox[{"rt", "^", "2"}], "+", 
               RowBox[{"\[Chi]", "^", "2"}]}], ")"}]}]}], ")"}], " ", "#"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", "rt", " ", 
                 RowBox[{"\[Nu]n", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"rt", "^", "2"}], " ", 
                  RowBox[{"\[Nu]n", "^", "2"}]}]}], ")"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "rt"}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "rt"}], "+", 
               RowBox[{"rt", "^", "2"}], "+", 
               RowBox[{"\[Chi]", "^", "2"}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"D", "[", 
           RowBox[{"#", ",", "rt"}], "]"}]}], "+", 
         RowBox[{"D", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"rt", ",", "2"}], "}"}]}], "]"}]}], "&"}]}], ";", "\n", 
      RowBox[{"DiffRadx", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"x", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "x"}], ")"}]}], ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Mu]n", "^", "2"}], "/", 
               RowBox[{"\[Nu]n", "^", "2"}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"\[Mu]n", "^", "2"}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"1", "-", 
                  RowBox[{"\[Chi]", "^", "2"}]}], "]"}], "+", 
                RowBox[{"2", " ", "x", " ", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"1", "-", 
                   RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}]}], ")"}], "^", 
              "2"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", "M", " ", "\[Nu]n", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"1", "-", 
                   RowBox[{"\[Chi]", "^", "2"}]}], "]"}], "+", 
                 RowBox[{"2", " ", "x", " ", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"\[Chi]", "^", "2"}], "+", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"1", "-", 
                   RowBox[{"\[Chi]", "^", "2"}]}], "]"}], "-", 
                 RowBox[{"2", " ", "x", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"\[Chi]", "^", "2"}]}], ")"}]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"m", " ", 
                  RowBox[{"\[Nu]n", "^", "2"}], " ", "\[Chi]"}], "-", 
                 RowBox[{"I", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"\[Nu]n", "^", "2"}], " ", 
                    RowBox[{"\[Chi]", "^", "2"}]}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Omega]ni", "-", 
                    RowBox[{"I", " ", "\[Omega]nr"}]}], ")"}]}]}], ")"}]}], 
              ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "-", 
                 RowBox[{"\[Chi]", "^", "2"}]}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{"M", "+", 
                 RowBox[{"M", " ", 
                  RowBox[{"\[Nu]n", "^", "2"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "-", 
                    RowBox[{"\[Chi]", "^", "2"}], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{"4", " ", 
                    RowBox[{"x", "^", "2"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"\[Chi]", "^", "2"}]}], ")"}]}], "+", 
                    RowBox[{"4", " ", "x", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}], ")"}]}]}], 
                   ")"}]}]}], ")"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"I", " ", "m", " ", "\[Chi]"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"x", "^", "2"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"\[Chi]", "^", "2"}]}], ")"}]}], "+", 
                   RowBox[{"2", " ", "x", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}], ")"}]}]}], ")"}],
                  " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Omega]ni", "-", 
                   RowBox[{"I", " ", "\[Omega]nr"}]}], ")"}]}]}], ")"}], "^", 
              "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"4", " ", "x", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "x"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"\[Chi]", "^", "2"}]}], ")"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"I", " ", "\[Omega]ni"}], "+", "\[Omega]nr"}], ")"}], 
             "/", "\[Nu]n"}], "+", 
            RowBox[{"\[Nu]n", " ", "\[Chi]", " ", 
             RowBox[{"(", 
              RowBox[{"m", "-", 
               RowBox[{"\[Chi]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"I", " ", "\[Omega]ni"}], "+", "\[Omega]nr"}], 
                 ")"}]}]}], ")"}]}]}], ")"}], " ", "#"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "x"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"4", " ", "M", " ", "x", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "x"}], ")"}], " ", 
                RowBox[{"\[Nu]n", "^", "2"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"\[Chi]", "^", "2"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}], "+", 
                  RowBox[{"2", " ", "x", " ", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"1", "-", 
                  RowBox[{"\[Chi]", "^", "2"}]}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{"M", "+", 
                  RowBox[{"M", " ", 
                   RowBox[{"\[Nu]n", "^", "2"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"\[Chi]", "^", "2"}], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{"4", " ", 
                    RowBox[{"x", "^", "2"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"\[Chi]", "^", "2"}]}], ")"}]}], "+", 
                    RowBox[{"4", " ", "x", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], ")"}]}]}], ")"}], " ", "/", 
           RowBox[{"(", 
            RowBox[{"x", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "x"}], ")"}]}], ")"}]}], " ", 
          RowBox[{"D", "[", 
           RowBox[{"#", ",", "x"}], "]"}]}], "+", 
         RowBox[{"D", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "&"}]}], ";", "\n", 
      "\n", 
      RowBox[{"prec", "=", 
       RowBox[{
        RowBox[{"SetPrecision", "[", 
         RowBox[{"#", ",", "setprec"}], "]"}], "&"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "angular", " ", "equation", " ", "in", " ", "matrix", " ", 
        "form"}], "*)"}], "\n", 
      RowBox[{"mat", "=", 
       RowBox[{"prec", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Mat", "[", 
           RowBox[{
           "m", ",", "\[Eta]", ",", "\[Nu]", ",", "\[Mu]", ",", "a", ",", 
            "\[Omega]"}], "]"}], 
          RowBox[{"\[Nu]n", "^", "2"}]}], ")"}]}]}], ";", "\n", 
      RowBox[{"matdettemp", "=", 
       RowBox[{"prec", "@", 
        RowBox[{"Det", "[", "mat", "]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"With", " ", "and", " ", "without", " ", "the", " ", 
         RowBox[{"\[Nu]n", "^", "12"}], " ", "in", " ", "front"}], ",", " ", 
        RowBox[{
        "which", " ", "is", " ", "analytically", " ", "equivalent", " ", "to",
          " ", "not", " ", "having", " ", "it", " ", "there"}], ",", " ", 
        RowBox[{
        "changes", " ", "the", " ", "resulting", " ", "root", " ", "starting",
          " ", "from", " ", "the", " ", "sixth", " ", "decimal"}]}], "*)"}], 
      "\n", 
      RowBox[{
       RowBox[{"matdet", "[", 
        RowBox[{"r\[Nu]_", ",", "i\[Nu]_"}], "]"}], ":=", 
       RowBox[{"prec", "@", 
        RowBox[{"(", 
         RowBox[{"matdettemp", "//.", 
          RowBox[{"{", 
           RowBox[{"\[Nu]n", "->", 
            RowBox[{"r\[Nu]", "+", 
             RowBox[{"I", " ", "i\[Nu]"}]}]}], "}"}]}], ")"}]}]}], ";", "\n", 
      
      RowBox[{
       RowBox[{"absdetmat", "[", 
        RowBox[{"r\[Nu]_", ",", "i\[Nu]_"}], "]"}], ":=", 
       RowBox[{"prec", "@", 
        RowBox[{"Log", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"matdet", "[", 
           RowBox[{"r\[Nu]", ",", "i\[Nu]"}], "]"}], "]"}], "]"}]}]}], ";", 
      "\n", "\n", 
      RowBox[{
       RowBox[{"Rmaxfunc", "[", 
        RowBox[{"wIn_", ",", "\[Nu]In_", ",", "\[Mu]In_", ",", "branch3_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"wIn1", "=", "wIn"}], ",", 
           RowBox[{"\[Nu]In1", "=", "\[Nu]In"}], ",", 
           RowBox[{"\[Mu]In1", "=", "\[Mu]In"}]}], "}"}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{"prec", "=", 
           RowBox[{
            RowBox[{"SetPrecision", "[", 
             RowBox[{"#", ",", "setprec"}], "]"}], "&"}]}], ";", "\n", "\t", 
          RowBox[{"\[Mu]i", "=", 
           RowBox[{"prec", "@", "\[Mu]In"}]}], ";", "\n", "\n", "\t", 
          RowBox[{"wrpoint", "=", 
           RowBox[{
            RowBox[{"Re", "[", "wIn", "]"}], "//", 
            RowBox[{
             RowBox[{"Rationalize", "[", 
              RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";", "\n", "\t", 
          RowBox[{"wipoint", "=", 
           RowBox[{
            RowBox[{"Im", "[", "wIn", "]"}], "//", 
            RowBox[{
             RowBox[{"Rationalize", "[", 
              RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";", "\n", "\n", 
          "\t", 
          RowBox[{"\[Nu]rpoint", "=", 
           RowBox[{
            RowBox[{"Re", "[", "\[Nu]In", "]"}], "//", 
            RowBox[{
             RowBox[{"Rationalize", "[", 
              RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";", "\n", "\t", 
          RowBox[{"\[Nu]ipoint", "=", 
           RowBox[{
            RowBox[{"Im", "[", "\[Nu]In", "]"}], "//", 
            RowBox[{
             RowBox[{"Rationalize", "[", 
              RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";", "\n", "\n", 
          "\t", 
          RowBox[{"\[Nu]rootSollist", "=", 
           RowBox[{"prec", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SetPrecision", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"matdettemp", "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Mu]n", "->", "\[Mu]i"}], ",", 
                    RowBox[{"\[Omega]nr", "->", "wrpoint"}], ",", 
                    RowBox[{"\[Omega]ni", "->", "wipoint"}]}], "}"}]}], ")"}],
                  ",", "setprec"}], "]"}], "==", "0"}], ",", "\[Nu]n", ",", 
              RowBox[{"WorkingPrecision", "->", "setprec"}]}], "]"}]}]}], ";",
           "\n", "\t", 
          RowBox[{"\[Nu]rootVallist", "=", 
           RowBox[{"prec", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Nu]n", "/.", 
                  RowBox[{"\[Nu]rootSollist", "[", 
                   RowBox[{"[", "l", "]"}], "]"}]}], "//", "Re"}], ",", 
                RowBox[{
                 RowBox[{"\[Nu]n", "/.", 
                  RowBox[{"\[Nu]rootSollist", "[", 
                   RowBox[{"[", "l", "]"}], "]"}]}], "//", "Im"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", 
                RowBox[{"Length", "[", "\[Nu]rootSollist", "]"}]}], "}"}]}], 
             "]"}]}]}], ";", "\n", "\t", 
          RowBox[{"\[Nu]roottemp", "=", 
           RowBox[{
            RowBox[{"prec", "@", 
             RowBox[{"Nearest", "[", 
              RowBox[{"\[Nu]rootVallist", ",", 
               RowBox[{"{", 
                RowBox[{"\[Nu]rpoint", ",", "\[Nu]ipoint"}], "}"}], ",", 
               RowBox[{"WorkingPrecision", "->", "setprec"}]}], "]"}]}], "//",
             "First"}]}], ";", "\n", "\t", 
          RowBox[{"\[Nu]root", "=", 
           RowBox[{"prec", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"r\[Nu]", "->", 
               RowBox[{"\[Nu]roottemp", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"i\[Nu]", "->", 
               RowBox[{"\[Nu]roottemp", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ";", "\n", 
          "\t\t\t", "\n", "\t", 
          RowBox[{
           RowBox[{"Frob", "[", "x_", "]"}], ":=", 
           RowBox[{
            RowBox[{"x", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "I"}], " ", "\[Lambda]"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Symbol", "[", 
                  RowBox[{"\"\<c\>\"", "<>", 
                   RowBox[{"ToString", "[", "n", "]"}]}], "]"}], 
                 RowBox[{"x", "^", "n"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
             ")"}]}]}], ";", "\n", "\t", 
          RowBox[{"exptemp", "=", 
           RowBox[{
            RowBox[{"Series", "[", 
             RowBox[{
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"I", " ", "\[Lambda]"}], " ", "+", "2"}], ")"}]}],
                   " ", 
                  RowBox[{"(", 
                   RowBox[{"DiffRadx", "@", 
                    RowBox[{"Frob", "[", "x", "]"}]}], ")"}]}], "//", 
                 "Simplify"}], ",", "setprec"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "2"}], "}"}]}], "]"}], "==", 
            "0"}]}], ";", "\n", "\t", 
          RowBox[{"\[CapitalKappa]", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "m"}], " ", "\[Chi]"}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"I", " ", "\[Omega]ni"}], "+", "\[Omega]nr"}], 
                 ")"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "-", 
                 RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}], ")"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Omega]nr", "->", "wrpoint"}], ",", 
              RowBox[{"\[Omega]ni", "->", "wipoint"}]}], "}"}]}]}], ";", "\n",
           "\t", 
          RowBox[{"exptemp1", "=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"exptemp", "/.", 
                  RowBox[{"{", 
                   RowBox[{"\[Mu]n", "->", "\[Mu]i"}], "}"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Omega]nr", "->", "wrpoint"}], ",", 
                   RowBox[{"\[Omega]ni", "->", "wipoint"}]}], "}"}]}], "/.", 
                RowBox[{"{", 
                 RowBox[{"\[Nu]n", "->", 
                  RowBox[{"r\[Nu]", "+", 
                   RowBox[{"I", " ", "i\[Nu]"}]}]}], "}"}]}], "/.", 
               "\[Nu]root"}], "//", "LogicalExpand"}], ",", "setprec"}], 
            "]"}]}], ";", "\n", "\t", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"setprecNSolve", "[", "ju_", "]"}], ":=", 
             RowBox[{"Piecewise", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"setprec", "-", "1"}], ",", 
                  RowBox[{"ju", "\[LessEqual]", " ", "22"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"setprec", "-", "2"}], ",", 
                  RowBox[{"ju", ">", "22"}]}], "}"}]}], "}"}], "]"}]}], ";"}],
            "*)"}], "\n", "\t", 
          RowBox[{"Coeff", "=", 
           RowBox[{
            RowBox[{"NSolve", "[", 
             RowBox[{"exptemp1", ",", 
              RowBox[{"{", 
               RowBox[{"\[Lambda]", ",", "c1", ",", "c2"}], "}"}], ",", 
              RowBox[{"WorkingPrecision", "->", 
               RowBox[{"setprec", "-", "2"}]}]}], 
             RowBox[{"(*", 
              RowBox[{"setprecNSolve", "[", "i", "]"}], "*)"}], "]"}], "[", 
            RowBox[{"[", "branch3", "]"}], "]"}]}], ";", "\n", "\t", 
          RowBox[{"\[Lambda]test", "=", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Lambda]", "/.", "Coeff"}], ")"}], "+", 
             "\[CapitalKappa]"}], "]"}]}], ";", "\n", "\t", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Log", "[", "\[Lambda]test", "]"}], "<", 
               RowBox[{"-", "15"}]}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{
               RowBox[{"Print", "[", "\[Lambda]test", "]"}], 
               RowBox[{
               "Print", "[", 
                "\"\<Error: Possible problem with value for \[Lambda] or \
\[Kappa]!\>\"", "]"}], 
               RowBox[{"Print", "[", 
                RowBox[{"Precision", "[", "\[CapitalKappa]", "]"}], "]"}]}]}],
              "]"}], ";"}], "*)"}], "\n", "\t", 
          RowBox[{
           RowBox[{"FrobOfr", "[", "rt_", "]"}], ":=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Frob", "[", "x", "]"}], "//.", "Coeff"}], "//.", 
                RowBox[{"{", 
                 RowBox[{"x", "->", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rt", " ", "M"}], "-", 
                    RowBox[{"rp", "[", "a", "]"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rp", "[", "a", "]"}], "-", 
                    RowBox[{"rm", "[", "a", "]"}]}], ")"}]}]}], "}"}]}], 
               RowBox[{"(*", 
                RowBox[{"/.", 
                 RowBox[{"{", 
                  RowBox[{"\[Lambda]", "\[Rule]", "\[CapitalKappa]"}], 
                  "}"}]}], "*)"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Mu]n", "->", "\[Mu]i"}], ",", 
                 RowBox[{"\[Omega]nr", "->", "wrpoint"}], ",", 
                 RowBox[{"\[Omega]ni", "->", "wipoint"}]}], "}"}]}], "//", 
              "Simplify"}], ",", "setprec"}], "]"}]}], ";", "\n", "\t", 
          RowBox[{"R0", "=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"Limit", "[", 
              RowBox[{
               RowBox[{"FrobOfr", "[", "rt", "]"}], ",", 
               RowBox[{"rt", "->", 
                RowBox[{"rtstart", "[", "a", "]"}]}]}], "]"}], ",", 
             "setprec"}], "]"}]}], ";", "\n", "\t", 
          RowBox[{"dR0", "=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"Limit", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"FrobOfr", "[", "rt", "]"}], ",", "rt"}], "]"}], ",", 
               RowBox[{"rt", "->", 
                RowBox[{"rtstart", "[", "a", "]"}]}]}], "]"}], ",", 
             "setprec"}], "]"}]}], ";", "\n", "\t\t", "\n", "\t", 
          RowBox[{"solR", "=", 
           RowBox[{
            RowBox[{"NDSolve", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"DiffRadrt", "@", 
                    RowBox[{"R", "[", "rt", "]"}]}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[Nu]n", "->", 
                    RowBox[{"r\[Nu]", "+", 
                    RowBox[{"I", " ", "i\[Nu]"}]}]}], "}"}]}], "/.", 
                    "\[Nu]root"}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Mu]n", "->", "\[Mu]i"}], ",", 
                    RowBox[{"\[Omega]nr", "->", "wrpoint"}], ",", 
                    RowBox[{"\[Omega]ni", "->", "wipoint"}]}], "}"}]}], ")"}],
                  "==", "0"}], ",", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"rtstart", "[", "a", "]"}], "]"}], "==", "R0"}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"R", "'"}], "[", 
                  RowBox[{"rtstart", "[", "a", "]"}], "]"}], "==", "dR0"}]}], 
               "}"}], ",", "R", ",", 
              RowBox[{"{", 
               RowBox[{"rt", ",", 
                RowBox[{"rtstart", "[", "a", "]"}], ",", 
                RowBox[{"rstop", "[", "\[Mu]i", "]"}]}], "}"}], ",", 
              RowBox[{"Method", "->", 
               RowBox[{"{", "\"\<StiffnessSwitching\>\"", "}"}]}], ",", 
              RowBox[{"WorkingPrecision", "->", 
               RowBox[{"setprec", "-", "2"}]}], ",", 
              RowBox[{"MaxSteps", "->", "maxstep"}]}], "]"}], "//", 
            "First"}]}], ";", "\n", "\n", "\t", 
          RowBox[{"Rmax", "=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"R", "[", "rt", "]"}], "/.", "solR"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"rt", "->", 
                  RowBox[{"rstop", "[", "\[Mu]i", "]"}]}], "}"}]}], "]"}], 
              "]"}], ",", "setprec"}], "]"}]}], ";", "\n", "\t", 
          RowBox[{"\[Nu]rootout", "=", 
           RowBox[{"prec", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Nu]roottemp", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", 
              RowBox[{"I", " ", 
               RowBox[{"\[Nu]roottemp", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], ";", "\n", 
          "\t", 
          RowBox[{"\[Omega]out", "=", 
           RowBox[{"prec", "@", "wIn"}]}], ";"}]}], "\n", "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{"Regime", " ", "of", " ", "consideration"}], "*)"}], "\n", 
      RowBox[{"\[Mu]start", "=", "\[Mu]sta"}], ";", "\n", 
      RowBox[{"\[Mu]stop", "=", "\[Mu]sto"}], ";", "\n", 
      RowBox[{"\[Omega]mesh", "=", "20"}], ";", "\n", 
      RowBox[{"\[Omega]precstep", "=", "2"}], ";", "\n", 
      RowBox[{"\[Omega]rstepsize", "=", "50"}], ";", "\n", 
      RowBox[{"\[Mu]mesh", "=", "1"}], ";", "\n", 
      RowBox[{"branch", "=", "branch1"}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"Non", "-", 
        RowBox[{
        "relativistic", " ", "limit", " ", "and", " ", "its", " ", "values", 
         " ", "as", " ", "first", " ", "guesses"}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"\[Omega]nonRel", "[", 
        RowBox[{"\[Mu]n_", ",", "na_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Mu]n", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"\[Mu]n", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", 
               RowBox[{"na", "^", "2"}]}], ")"}]}]}], ")"}]}], ")"}], "//", 
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "Provides", " ", "only", " ", "a", " ", "guess", " ", "for", " ", 
        "the", " ", "real", " ", 
        RowBox[{"part", "."}]}], "*)"}], "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Sin", "==", 
         RowBox[{"-", "1"}]}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"This", " ", "is", " ", "for", " ", "S"}], "=", 
          RowBox[{"-", "1"}]}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Picked S=-1 \[Nu]nonrel\>\"", "]"}], ";", 
         "\n", 
         RowBox[{
          RowBox[{"\[Nu]nonRel", "[", "\[Omega]a_", "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Omega]a"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"\[Chi]", " ", "\[Omega]a"}]}], ")"}]}], "//", 
           RowBox[{
            RowBox[{"Rationalize", "[", 
             RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";"}], " ", "\n", ",",
         "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Sin", "==", "0"}], ",", "\n", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"This", " ", "is", " ", "for", " ", "S"}], "=", "0"}], 
           "*)"}], "\n", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Picked S=0 \[Nu]nonrel\>\"", "]"}], ";",
            "\n", 
           RowBox[{
            RowBox[{"\[Nu]nonRel", "[", "\[Omega]a_", "]"}], ":=", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"2", "\[Chi]"}], ")"}]}], 
             RowBox[{"(", 
              RowBox[{"2", "-", 
               RowBox[{"\[Chi]", " ", "\[Omega]a"}], "+", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"\[Chi]", " ", "\[Omega]a"}]}], ")"}], "^", "2"}],
                  "+", 
                 RowBox[{"4", "\[Chi]", " ", "\[Omega]a"}]}], "]"}]}], 
              ")"}]}]}], ";"}], "\n", ",", "\n", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Sin", "==", "1"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"This", " ", "is", " ", "for", " ", "S"}], "=", 
              RowBox[{"+", "1"}]}], "*)"}], "\n", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Picked S=+1 \[Nu]nonrel\>\"", "]"}], 
             ";", "\n", 
             RowBox[{
              RowBox[{"\[Nu]nonRel", "[", "\[Omega]b_", "]"}], ":=", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "//.", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"NSolve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"a", " ", 
                    RowBox[{"v", "^", "3"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"a", " ", "\[Omega]a"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"6", "-", 
                    RowBox[{"a", " ", "\[Omega]a", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"a", " ", "\[Omega]a"}]}], ")"}]}]}], ")"}], 
                    RowBox[{"v", "^", "2"}]}], "+", 
                    RowBox[{"\[Omega]a", " ", "v"}], "+", 
                    RowBox[{"\[Omega]a", "^", "2"}]}], ",", "v"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "//", "Simplify"}], 
                  ")"}]}], "/.", 
                RowBox[{"{", 
                 RowBox[{"M", "->", "1"}], "}"}]}], "//.", 
               RowBox[{"{", 
                RowBox[{"\[Omega]a", "->", "\[Omega]b"}], "}"}]}]}], ";"}], 
            "\n", ",", "\n", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\<Error: S not in (-1,0,+1)!\>\"", "]"}], ";", 
             "\n", 
             RowBox[{"Abort", "[", "]"}], ";"}]}], "\n", "]"}]}], "]"}]}], 
       "]"}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", " ", "a", " ", "given", " ", "complex", " ", 
         RowBox[{"(", "!", ")"}], " ", "\[Omega]"}], ",", 
        RowBox[{
        "this", " ", "provides", " ", "an", " ", "initial", " ", "guess", " ",
          "for", " ", "real", " ", "and", " ", "imaginary", " ", "parts"}]}], 
       "*)"}], "\n", 
      RowBox[{"\[Mu]range", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"\[Mu]start", ",", "\[Mu]stop", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Mu]stop", "-", "\[Mu]start"}], ")"}], "/", 
              "\[Mu]mesh"}]}], "]"}]}], "}"}], "//", "Flatten"}], "//", 
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";", "\n", 
      RowBox[{"\[Mu]all", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"\[Mu]range", ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Length", "[", "\[Mu]range", "]"}]}], "+", "1"}]}], 
        "]"}]}], ";", "\n", 
      RowBox[{"\[Mu]rangenumber", "=", 
       RowBox[{
        RowBox[{"Length", "[", "\[Mu]range", "]"}], "-", "1"}]}], ";", "\n", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{"Initial", " ", "\[Omega]", " ", "guesses"}], "*)"}], "\n", 
      RowBox[{"\[Omega]intR", "=", 
       RowBox[{"\[Omega]nonRel", "[", 
        RowBox[{"\[Mu]start", ",", "n"}], "]"}]}], ";", "\n", 
      RowBox[{"\[Omega]intI", "=", "\[Omega]ImIn"}], ";", "\n", 
      RowBox[{"\[Nu]int", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r\[Nu]", "->", 
            RowBox[{"Re", "[", 
             RowBox[{"\[Nu]nonRel", "[", 
              RowBox[{"\[Omega]intR", "+", 
               RowBox[{"I", " ", "\[Omega]intI"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"i\[Nu]", "->", 
            RowBox[{"Im", "[", 
             RowBox[{"\[Nu]nonRel", "[", 
              RowBox[{"\[Omega]intR", "+", 
               RowBox[{"I", " ", "\[Omega]intI"}]}], "]"}], "]"}]}]}], "}"}], 
         ",", "setprec"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "function", " ", "to", " ", "be", " ", "minimized"}], 
       "*)"}], "\n", 
      RowBox[{
       RowBox[{"funcmin", "[", 
        RowBox[{"win_", ",", "\[Nu]in_", ",", "\[Mu]in_", ",", "branch_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"win1", "=", "win"}], ",", 
           RowBox[{"\[Nu]in1", "=", "\[Nu]in"}], ",", 
           RowBox[{"\[Mu]in1", "=", "\[Mu]in"}]}], "}"}], ",", "\n", 
         RowBox[{
          RowBox[{"Rmaxfunc", "[", 
           RowBox[{"win", ",", "\[Nu]in", ",", "\[Mu]in", ",", "branch"}], 
           "]"}], ";", "\n", "Rmax"}]}], "\n", "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"Isomorphism", " ", "from", " ", 
        RowBox[{"R", "^", "2"}], " ", "to", " ", "C", " ", 
        RowBox[{"(", 
         RowBox[{"and", " ", "inverse"}], ")"}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"R2toC", "[", "vec_", "]"}], ":=", 
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"I", " ", 
         RowBox[{"vec", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"CtoR2", "[", "num_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Re", "[", "num", "]"}], ",", 
         RowBox[{"Im", "[", "num", "]"}]}], "}"}]}], ";", "\n", "\n", 
      RowBox[{"\[Nu]rootminall", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "\[Mu]range", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"solRminall", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "\[Mu]range", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"\[Omega]minall", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "\[Mu]range", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"\[Mu]minall", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "\[Mu]range", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"plotlist", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "\[Mu]range", "]"}], ",", 
           "\[Omega]precstep"}], "}"}]}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"\[Nu]rootminout", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "\[Mu]range", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"solRminout", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "\[Mu]range", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"\[Omega]minout", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "\[Mu]range", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"\[Mu]minout", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "\[Mu]range", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"lminout", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "\[Mu]range", "]"}]}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "The", " ", "only", " ", "reliable", " ", "value", " ", "for", " ", 
         "\[Omega]", " ", "and", " ", "\[Nu]", " ", "is", " ", "starting", 
         " ", 
         RowBox[{"at", " ", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"since", " ", "in", " ", "the", " ", "first", " ", "step"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"we", " ", "use", " ", "the", " ", "non"}], "-", 
         RowBox[{
          RowBox[{"rel", ".", " ", "result"}], " ", "without", " ", 
          RowBox[{"(", "!", ")"}], " ", "optimization", " ", "and", " ", 
          "minimization", " ", "to", " ", "our", " ", 
          RowBox[{
           RowBox[{"equations", "!!"}], "!"}], " ", "Always", " ", "remove", 
          " ", "the", " ", "first", " ", "value", " ", "from", " ", "the", 
          " ", "list"}]}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"\[Nu]rootminall", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", "\[Nu]int"}], ";", "\n", 
      RowBox[{
       RowBox[{"\[Omega]minall", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"\[Omega]intR", "+", 
          RowBox[{"I", " ", "\[Omega]intI"}]}], ",", "setprec"}], "]"}]}], 
      ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "minimum", " ", "search", " ", "mesh", " ", "boundaries", 
        " ", "for", " ", "the", " ", "real", " ", "part", " ", "of", " ", 
        "\[Omega]"}], "*)"}], "\n", 
      RowBox[{"rrinitial", "=", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]nonRel", "[", 
           RowBox[{"\[Mu]start", ",", 
            RowBox[{"n", "+", "1"}]}], "]"}], "-", 
          RowBox[{"\[Omega]nonRel", "[", 
           RowBox[{"\[Mu]start", ",", "n"}], "]"}]}], ")"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"rrdelta", "[", "u_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"u", "==", "1"}], ",", "rrinitial", ",", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]nonRel", "[", 
             RowBox[{
              RowBox[{"\[Mu]range", "[", 
               RowBox[{"[", 
                RowBox[{"u", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{"n", "+", "1"}]}], "]"}], "-", 
            RowBox[{"\[Omega]nonRel", "[", 
             RowBox[{
              RowBox[{"\[Mu]range", "[", 
               RowBox[{"[", 
                RowBox[{"u", "+", "1"}], "]"}], "]"}], ",", "n"}], "]"}]}], 
           ")"}]}]}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "minimum", " ", "search", " ", "mesh", " ", "boundaries", 
        " ", "for", " ", "the", " ", "imaginary", " ", "part", " ", "of", " ",
         "\[Omega]"}], "*)"}], "\n", 
      RowBox[{"iiThreshhold", "=", 
       RowBox[{"10", "^", 
        RowBox[{"-", "1"}]}]}], ";", "\n", 
      RowBox[{"iiinitial", "=", "1"}], ";", "\n", 
      RowBox[{
       RowBox[{"iidelta", "[", "u_", "]"}], ":=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"u", "<", "4"}], ",", "iiinitial", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"Log10", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"\[Omega]minall", "[", 
                   RowBox[{"[", "u", "]"}], "]"}], "]"}], "]"}], "-", 
                RowBox[{"Log10", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"\[Omega]minall", "[", 
                   RowBox[{"[", 
                    RowBox[{"u", "-", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
               "]"}], ">", "iiThreshhold"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"Log10", "[", 
                RowBox[{"Im", "[", 
                 RowBox[{"\[Omega]minall", "[", 
                  RowBox[{"[", "u", "]"}], "]"}], "]"}], "]"}], "-", 
               RowBox[{"Log10", "[", 
                RowBox[{"Im", "[", 
                 RowBox[{"\[Omega]minall", "[", 
                  RowBox[{"[", 
                   RowBox[{"u", "-", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
              "]"}], ",", "0.5"}], "]"}]}], "]"}], ",", "setprec"}], "]"}]}], 
      ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"The", " ", 
        RowBox[{"code", ":"}]}], "*)"}], "\n", 
      RowBox[{"offset", "=", "0"}], ";", "\n", 
      RowBox[{"Clear", "[", "y", "]"}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", "\[Mu]rangenumber"}], ",", 
        RowBox[{"i", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"branchtemp", "=", "branch"}], ";", "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "<=", " ", "2"}], ",", 
           RowBox[{"{", "}"}], ",", "\n", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"Log10", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"\[Omega]minall", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", 
                RowBox[{"Log10", "[", 
                 RowBox[{"Im", "[", 
                  RowBox[{"\[Omega]minall", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
               "]"}], ">", "2"}], ",", "\n", 
             RowBox[{
              RowBox[{"branch", "=", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"#", "!=", "branchtemp"}], "&"}]}], "]"}], "//", 
                "First"}]}], ";", " ", "\n", 
              RowBox[{
               RowBox[{"\[Omega]minall", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "=", "\[Omega]minalltemp"}], 
              ";", "\n", 
              RowBox[{"i", "=", 
               RowBox[{"i", "-", "1"}]}], ";", "\n", 
              RowBox[{"Print", "[", "\"\<flip!\>\"", "]"}], ";"}], "\n", ",", 
             "\n", 
             RowBox[{"branch", "=", "branchtemp"}]}], "]"}]}], "]"}], ";", 
         "\n", "\n", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "i", "]"}], "<>", 
           RowBox[{"ToString", "[", "\"\</\>\"", "]"}], "<>", 
           RowBox[{"ToString", "[", "\[Mu]mesh", "]"}]}], "]"}], ";", "\n", 
         RowBox[{"\[Mu]i", "=", 
          RowBox[{"\[Mu]range", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"Print", "[", 
          RowBox[{"\[Mu]i", "//", "N"}], "]"}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "We", " ", "always", " ", "take", " ", "the", " ", "previous", " ",
             "\[Omega]", " ", "as", " ", "the", " ", "new", " ", "guess"}], 
           ",", " ", 
           RowBox[{
            RowBox[{
            "since", " ", "these", " ", "are", " ", "much", " ", "closer", 
             " ", "to", " ", "the", " ", "actual", " ", "value", " ", "than", 
             " ", "the", " ", "non"}], "-", 
            RowBox[{"rel", " ", 
             RowBox[{"limit", ".", " ", "In"}], " ", "the", " ", "very", " ", 
             "first", " ", "step"}]}], ",", " ", 
           RowBox[{
            RowBox[{"we", " ", "use", " ", "the", " ", "non"}], "-", 
            RowBox[{"rel", " ", "limit", " ", "as", " ", "guess"}]}]}], 
          "*)"}], "\n", 
         RowBox[{"wintr", "=", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"\[Omega]nonRel", "[", 
             RowBox[{"\[Mu]i", ",", "n"}], "]"}], ",", "setprec"}], "]"}]}], 
         ";", "\n", 
         RowBox[{"winti", "=", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"Im", "[", 
             RowBox[{"\[Omega]minall", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "setprec"}], 
           "]"}]}], ";", "\n", 
         RowBox[{"\[Nu]root", "=", 
          RowBox[{"\[Nu]rootminall", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "The", " ", "initial", " ", "iteration", " ", "boaundries"}], 
          "*)"}], "\n", 
         RowBox[{"rrboundary", "=", 
          RowBox[{"rrdelta", "[", "i", "]"}]}], ";", "\n", 
         RowBox[{"iiboundary", "=", 
          RowBox[{"iidelta", "[", "i", "]"}]}], ";", "     ", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "For", " ", "the", " ", "very", " ", "first", " ", "iteration"}], 
           ",", " ", 
           RowBox[{
           "we", " ", "choose", " ", "this", " ", "asymmetric", " ", "search",
             " ", "interval"}], ",", " ", 
           RowBox[{
           "since", " ", "the", " ", "real", " ", "part", " ", "of", " ", 
            "the", " ", "frequency", " ", "is", " ", "monotonically", " ", 
            "increasing", " ", "with", " ", "\[Mu]", " ", 
            RowBox[{"(", 
             RowBox[{"if", " ", "not", " ", "rescaled", " ", "by", " ", 
              RowBox[{"\[Mu]", "^", 
               RowBox[{"-", "1"}]}]}], ")"}]}]}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"\[Omega]rrange", "=", 
            RowBox[{"SetPrecision", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"wintr", "+", "rrboundary"}], "<", "\[Omega]nmax"}], 
                ",", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"wintr", "-", "rrboundary"}], ",", 
                  RowBox[{"wintr", "+", "rrboundary"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"2", "rrboundary"}], ")"}], "/", 
                   "\[Omega]mesh"}]}], "]"}], ",", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"wintr", "-", "rrboundary"}], ",", 
                  RowBox[{"\[Omega]nmax", "-", " ", 
                   RowBox[{"10", "^", 
                    RowBox[{"-", "6"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"wintr", "-", "rrboundary", "-", 
                    RowBox[{"(", 
                    RowBox[{"\[Omega]nmax", "-", " ", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "6"}]}]}], ")"}]}], "]"}], "/", 
                   "\[Omega]mesh"}]}], "]"}]}], "]"}], ",", "setprec"}], 
             "]"}]}], ";"}], "*)"}], "\n", 
         RowBox[{"\[Omega]irange", "=", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Log10", "[", "winti", "]"}], "-", "iiboundary"}], 
               ",", 
               RowBox[{
                RowBox[{"Log10", "[", "winti", "]"}], "+", "iiboundary"}], 
               ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", "iiboundary"}], ")"}], "/", "\[Omega]mesh"}]}], 
              "]"}]}], ",", "setprec"}], "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Omega]rrangeplot", "[", "i", "]"}], "=", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"\[Omega]rrange", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", 
                   RowBox[{"Length", "[", "\[Omega]rrange", "]"}]}], "}"}]}], 
                "]"}], "]"}], ",", 
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{"\[Omega]minall", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "//", "Re"}]}], "}"}], 
                 "}"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], "]"}]}], 
           ";"}], "*)"}], "\n", 
         RowBox[{
          RowBox[{"\[Omega]irangeplot", "[", "i", "]"}], "=", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListLogPlot", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"\[Omega]irange", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"Length", "[", "\[Omega]irange", "]"}]}], "}"}]}], 
              "]"}], "]"}], ",", 
            RowBox[{"ListLogPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"\[Omega]minall", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "//", "Im"}]}], "}"}], 
               "}"}], ",", 
              RowBox[{"PlotStyle", "->", "Red"}]}], "]"}]}], "]"}]}], ";", 
         "\n", "\n", 
         RowBox[{"\[Delta]\[Omega]r", "=", "0"}], ";", "\n", 
         RowBox[{"aa", "=", "1"}], ";", "\n", 
         RowBox[{"aatest", "=", 
          RowBox[{"-", "1"}]}], ";", "\n", 
         RowBox[{"wrpoint", "=", "wintr"}], ";", "\n", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"aatest", "<", "0"}], ",", "\n", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"AAtest", "=", 
              RowBox[{
               RowBox[{"maxR", "[", "2", "]"}], "-", 
               RowBox[{"maxR", "[", "1", "]"}]}]}], ";", "\n", "\t", 
             RowBox[{"wrpoint", "=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aa", "<=", "2"}], ",", 
                  RowBox[{"wintr", "-", 
                   RowBox[{"aa", " ", "\[Delta]\[Omega]r"}], "+", "offset"}], 
                  ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"AAtest", "<", "0"}], ",", 
                    RowBox[{"wintr", "-", 
                    RowBox[{"aa", " ", "\[Delta]\[Omega]r"}], "+", "offset"}],
                     ",", 
                    RowBox[{"wintr", "+", 
                    RowBox[{"aa", " ", "\[Delta]\[Omega]r"}], "+", 
                    "offset"}]}], "]"}]}], "]"}], ",", "setprec"}], "]"}]}], 
             ";", "\n", "\t", 
             RowBox[{"wipoint", "=", "winti"}], ";", "\n", "\n", "\t\t\t", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "To", " ", "pick", " ", "the", " ", "correct", " ", "\[Nu]", 
                " ", "solution", " ", "form", " ", "the", " ", "set", " ", 
                "of", " ", "roots", " ", "of", " ", "the", " ", "EVP"}], ",", 
               " ", 
               RowBox[{
                RowBox[{
                "we", " ", "compare", " ", "it", " ", "to", " ", "either", 
                 " ", "the", " ", "non"}], "-", 
                RowBox[{
                 RowBox[{"rel", ".", " ", "limit"}], " ", "using", " ", "the",
                  " ", "current", " ", "\[Omega]"}]}], ",", " ", 
               RowBox[{"or", " ", "the", " ", "previous", " ", 
                RowBox[{"(", 
                 RowBox[{"previous", " ", "mass"}], ")"}], " ", "minimal", 
                " ", "result", " ", "for", " ", "\[Nu]"}]}], "*)"}], "\n", 
             "\t\t\t", 
             RowBox[{"\[Nu]rpoint", "=", 
              RowBox[{"prec", "@", 
               RowBox[{"(", 
                RowBox[{"r\[Nu]", "/.", "\[Nu]root"}], ")"}]}]}], ";", "\n", 
             "\t\t\t", 
             RowBox[{"\[Nu]ipoint", "=", 
              RowBox[{"prec", "@", 
               RowBox[{"(", 
                RowBox[{"i\[Nu]", "/.", "\[Nu]root"}], ")"}]}]}], ";", "\n", 
             "\n", "\t\t\t", 
             RowBox[{"\[Nu]rootSollist", "=", 
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"SetPrecision", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"matdettemp", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Mu]n", "->", "\[Mu]i"}], ",", 
                    RowBox[{"\[Omega]nr", "->", "wrpoint"}], ",", 
                    RowBox[{"\[Omega]ni", "->", "wipoint"}]}], "}"}]}], ")"}],
                    ",", "setprec"}], "]"}], "==", "0"}], ",", "\[Nu]n", ",", 
                
                RowBox[{"WorkingPrecision", "->", "setprec"}]}], "]"}]}], ";",
              "\n", "\t\t\t", 
             RowBox[{"\[Nu]rootVallist", "=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Nu]n", "/.", 
                    RowBox[{"\[Nu]rootSollist", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "//", "Re"}], ",", 
                    RowBox[{
                    RowBox[{"\[Nu]n", "/.", 
                    RowBox[{"\[Nu]rootSollist", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "//", "Im"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", "1", ",", 
                    RowBox[{"Length", "[", "\[Nu]rootSollist", "]"}]}], 
                   "}"}]}], "]"}], ",", "setprec"}], "]"}]}], ";", "\n", 
             "\t\t\t", 
             RowBox[{"\[Nu]roottemp", "=", 
              RowBox[{
               RowBox[{"Nearest", "[", 
                RowBox[{"\[Nu]rootVallist", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Nu]rpoint", ",", "\[Nu]ipoint"}], "}"}], ",", 
                 RowBox[{"WorkingPrecision", "->", "setprec"}]}], "]"}], "//",
                "First"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"\[Nu]root", "=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"r\[Nu]", "->", 
                   RowBox[{"\[Nu]roottemp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{"i\[Nu]", "->", 
                   RowBox[{"\[Nu]roottemp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
                "setprec"}], "]"}]}], ";", "\n", "\t\t\t", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"Frob", "[", "x_", "]"}], ":=", 
              RowBox[{
               RowBox[{"x", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "I"}], " ", "\[Lambda]"}], ")"}]}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Symbol", "[", 
                    RowBox[{"\"\<c\>\"", "<>", 
                    RowBox[{"ToString", "[", "n", "]"}]}], "]"}], 
                    RowBox[{"x", "^", "n"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"n", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
                ")"}]}]}], ";", "\n", "\t\t\t", 
             RowBox[{"exptemp", "=", 
              RowBox[{
               RowBox[{"Series", "[", 
                RowBox[{
                 RowBox[{"SetPrecision", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"I", " ", "\[Lambda]"}], " ", "+", "2"}], ")"}]}],
                     " ", 
                    RowBox[{"(", 
                    RowBox[{"DiffRadx", "@", 
                    RowBox[{"Frob", "[", "x", "]"}]}], ")"}]}], "//", 
                    "Simplify"}], ",", "setprec"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0", ",", "2"}], "}"}]}], "]"}], "==", 
               "0"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"\[CapitalKappa]", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "m"}], " ", "\[Chi]"}], "+", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"I", " ", "\[Omega]ni"}], "+", "\[Omega]nr"}], 
                    ")"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"\[Chi]", "^", "2"}]}], "]"}]}], ")"}]}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Omega]nr", "->", "wrpoint"}], ",", 
                 RowBox[{"\[Omega]ni", "->", "wipoint"}]}], "}"}]}]}], ";", 
             "\n", "\t\t\t", 
             RowBox[{"exptemp1", "=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"exptemp", "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[Mu]n", "->", "\[Mu]i"}], "}"}]}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]nr", "->", "wrpoint"}], ",", 
                    RowBox[{"\[Omega]ni", "->", "wipoint"}]}], "}"}]}], "/.", 
                   
                   RowBox[{"{", 
                    RowBox[{"\[Nu]n", "->", 
                    RowBox[{"r\[Nu]", "+", 
                    RowBox[{"I", " ", "i\[Nu]"}]}]}], "}"}]}], "/.", 
                  "\[Nu]root"}], "//", "LogicalExpand"}], ",", "setprec"}], 
               "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"setprecNSolve", "[", "ju_", "]"}], ":=", 
                RowBox[{"Piecewise", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"setprec", "-", "1"}], ",", 
                    RowBox[{"ju", "\[LessEqual]", " ", "22"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"setprec", "-", "2"}], ",", 
                    RowBox[{"ju", ">", "22"}]}], "}"}]}], "}"}], "]"}]}], 
               ";"}], "*)"}], "\n", "\t\t\t", 
             RowBox[{"Coeff", "=", 
              RowBox[{
               RowBox[{"NSolve", "[", 
                RowBox[{"exptemp1", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Lambda]", ",", "c1", ",", "c2"}], "}"}], ",", 
                 RowBox[{"WorkingPrecision", "->", 
                  RowBox[{"setprec", "-", "2"}]}]}], 
                RowBox[{"(*", 
                 RowBox[{"setprecNSolve", "[", "i", "]"}], "*)"}], "]"}], "[", 
               RowBox[{"[", "branch", "]"}], "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"\[Lambda]test", "=", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Lambda]", "/.", "Coeff"}], ")"}], "+", 
                "\[CapitalKappa]"}], "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Log", "[", "\[Lambda]test", "]"}], "<", 
                  RowBox[{"-", "15"}]}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", "\[Lambda]test", "]"}], 
                  RowBox[{
                  "Print", "[", 
                   "\"\<Error: Possible problem with value for \[Lambda] or \
\[Kappa]!\>\"", "]"}], 
                  RowBox[{"Print", "[", 
                   RowBox[{"Precision", "[", "\[CapitalKappa]", "]"}], 
                   "]"}]}]}], "]"}], ";"}], "*)"}], "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"FrobOfr", "[", "rt_", "]"}], ":=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Frob", "[", "x", "]"}], "//.", "Coeff"}], "//.", 
                   
                   RowBox[{"{", 
                    RowBox[{"x", "->", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rt", " ", "M"}], "-", 
                    RowBox[{"rp", "[", "a", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rp", "[", "a", "]"}], "-", 
                    RowBox[{"rm", "[", "a", "]"}]}], ")"}]}]}], "}"}]}], 
                  RowBox[{"(*", 
                   RowBox[{"/.", 
                    RowBox[{"{", 
                    RowBox[{"\[Lambda]", "\[Rule]", "\[CapitalKappa]"}], 
                    "}"}]}], "*)"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Mu]n", "->", "\[Mu]i"}], ",", 
                    RowBox[{"\[Omega]nr", "->", "wrpoint"}], ",", 
                    RowBox[{"\[Omega]ni", "->", "wipoint"}]}], "}"}]}], "//", 
                 "Simplify"}], ",", "setprec"}], "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"R0", "=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{"Limit", "[", 
                 RowBox[{
                  RowBox[{"FrobOfr", "[", "rt", "]"}], ",", 
                  RowBox[{"rt", "->", 
                   RowBox[{"rtstart", "[", "a", "]"}]}]}], "]"}], ",", 
                "setprec"}], "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"dR0", "=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{"Limit", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"FrobOfr", "[", "rt", "]"}], ",", "rt"}], "]"}], 
                  ",", 
                  RowBox[{"rt", "->", 
                   RowBox[{"rtstart", "[", "a", "]"}]}]}], "]"}], ",", 
                "setprec"}], "]"}]}], ";", "\n", "\t\t", "\n", "\t\t\t", 
             RowBox[{"solR", "=", 
              RowBox[{
               RowBox[{"NDSolve", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"DiffRadrt", "@", 
                    RowBox[{"R", "[", "rt", "]"}]}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[Nu]n", "->", 
                    RowBox[{"r\[Nu]", "+", 
                    RowBox[{"I", " ", "i\[Nu]"}]}]}], "}"}]}], "/.", 
                    "\[Nu]root"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Mu]n", "->", "\[Mu]i"}], ",", 
                    RowBox[{"\[Omega]nr", "->", "wrpoint"}], ",", 
                    RowBox[{"\[Omega]ni", "->", "wipoint"}]}], "}"}]}], ")"}],
                     "==", "0"}], ",", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"rtstart", "[", "a", "]"}], "]"}], "==", "R0"}], 
                   ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"R", "'"}], "[", 
                    RowBox[{"rtstart", "[", "a", "]"}], "]"}], "==", 
                    "dR0"}]}], "}"}], ",", "R", ",", 
                 RowBox[{"{", 
                  RowBox[{"rt", ",", 
                   RowBox[{"rtstart", "[", "a", "]"}], ",", 
                   RowBox[{"rstop", "[", "\[Mu]i", "]"}]}], "}"}], ",", 
                 RowBox[{"Method", "->", 
                  RowBox[{"{", "\"\<StiffnessSwitching\>\"", "}"}]}], ",", 
                 RowBox[{"WorkingPrecision", "->", 
                  RowBox[{"setprec", "-", "2"}]}], ",", 
                 RowBox[{"MaxSteps", "->", "maxstep"}]}], "]"}], "//", 
               "First"}]}], ";", "\n", "\n", "\t\t    ", 
             RowBox[{
              RowBox[{"solRIterationR", "[", "aa", "]"}], "=", "solR"}], ";", 
             "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"\[Nu]rootIterationR", "[", "aa", "]"}], "=", 
              "\[Nu]root"}], ";", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"\[Omega]IterationR", "[", "aa", "]"}], "=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{"wrpoint", ",", "20"}], "]"}]}], ";", "\n", "\n", 
             "\t\t\t", 
             RowBox[{
              RowBox[{"maxR", "[", "aa", "]"}], "=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{"Log", "[", 
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"R", "[", "rt", "]"}], "/.", 
                    RowBox[{"solRIterationR", "[", "aa", "]"}]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{"rt", "->", 
                    RowBox[{"rstop", "[", "\[Mu]i", "]"}]}], "}"}]}], "]"}], 
                 "]"}], ",", "setprec"}], "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"aatest", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"aa", "<=", "2"}], ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{
                 RowBox[{"maxR", "[", "aa", "]"}], "-", 
                 RowBox[{"maxR", "[", 
                  RowBox[{"aa", "-", "1"}], "]"}]}]}], "]"}]}], ";", "\n", 
             "\t\t\t", 
             RowBox[{"\[Delta]\[Omega]r", "=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"rrdelta", "[", "i", "]"}], "/", 
                 "\[Omega]rstepsize"}], ",", "20"}], "]"}]}], ";", "\n", 
             "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"aa", ">", "500"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<aa>500: Terminated!\>\"", "]"}], 
                ";", 
                RowBox[{"Break", "[", "]"}]}], ",", 
               RowBox[{"{", "}"}]}], "]"}], ";"}], "\n", "\t\t", ";", 
            RowBox[{"aa", "++"}]}]}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"AAtest", "<", "0"}], ",", 
           RowBox[{"Print", "[", "\"\<-1\>\"", "]"}], ",", 
           RowBox[{"Print", "[", "\"\<+1\>\"", "]"}]}], "]"}], ";", "\n", 
         "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{"aa", "-", "1"}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"\[Omega]minR", "=", 
          RowBox[{"\[Omega]IterationR", "[", 
           RowBox[{"aa", "-", "1"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"aa", ">", "50"}], "&&", 
            RowBox[{"AAtest", "<", "0"}]}], ",", 
           RowBox[{"offset", "=", 
            RowBox[{"1", 
             RowBox[{"(", 
              RowBox[{"\[Omega]minR", "-", 
               RowBox[{"\[Omega]nonRel", "[", 
                RowBox[{"\[Mu]i", ",", "n"}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"aa", ">", "100"}], "&&", 
            RowBox[{"AAtest", "<", "0"}]}], ",", 
           RowBox[{"offset", "=", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"\[Omega]minR", "-", 
               RowBox[{"\[Omega]nonRel", "[", 
                RowBox[{"\[Mu]i", ",", "n"}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"\[Nu]transfer", "=", 
          RowBox[{
           RowBox[{"\[Nu]roottemp", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"I", " ", 
            RowBox[{"\[Nu]roottemp", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\n", "\t\t", 
         RowBox[{"\[Omega]transfer", "=", 
          RowBox[{"\[Omega]minR", "+", 
           RowBox[{"I", " ", "winti"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{"Initial", " ", "simplex", " ", "dimensions"}], "*)"}], 
         "\n", 
         RowBox[{"prec", "=", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "20"}], "]"}], "&"}]}], ";", "\n", "\n", 
         RowBox[{"Print", "[", "\"\<Simplex code...\>\"", "]"}], ";", "\n", 
         RowBox[{"rrinitial2", "=", 
          RowBox[{"\[Delta]\[Omega]r", "/", "10"}]}], ";", "\n", 
         RowBox[{"iiinitial2", "=", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log10", "[", 
              RowBox[{"Im", "[", 
               RowBox[{"\[Omega]minall", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "1"}], 
            ")"}]}]}], ";", "\n", 
         RowBox[{"\[Nu]int", "=", 
          RowBox[{"prec", "@", "\[Nu]transfer"}]}], ";", "\n", 
         RowBox[{"wint", "=", 
          RowBox[{"prec", "@", "\[Omega]transfer"}]}], ";", "\n", 
         RowBox[{"wvec0", "=", 
          RowBox[{"prec", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Re", "[", "wint", "]"}], ",", 
             RowBox[{"Im", "[", "wint", "]"}]}], "}"}]}]}], ";", "\n", 
         RowBox[{"wvec1", "=", 
          RowBox[{"prec", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Re", "[", "wint", "]"}], "-", "rrinitial2"}], ",", 
             RowBox[{"Im", "[", "wint", "]"}]}], "}"}]}]}], ";", "\n", 
         RowBox[{"wvec2", "=", 
          RowBox[{"prec", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Re", "[", "wint", "]"}], ",", 
             RowBox[{
              RowBox[{"Im", "[", "wint", "]"}], "-", "iiinitial2"}]}], 
            "}"}]}]}], ";", "\n", 
         RowBox[{"newsimplex", "=", 
          RowBox[{"prec", "@", 
           RowBox[{"{", 
            RowBox[{"wvec0", ",", "wvec1", ",", "wvec2"}], "}"}]}]}], ";", 
         "\n", "\n", 
         RowBox[{"Print", "[", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{"wint", ",", "20"}], "]"}], "]"}], ";", "\n", 
         RowBox[{"testnorm", "=", "1"}], ";", "\n", 
         RowBox[{"count", "=", "1"}], ";", "\n", 
         RowBox[{"temprint", " ", "=", " ", 
          RowBox[{"\"\<Count: \>\"", "<>", 
           RowBox[{"ToString", "[", "count", "]"}]}]}], ";", "\n", 
         RowBox[{"While", "[", "\n", 
          RowBox[{"(*", 
           RowBox[{"termination", " ", 
            RowBox[{"test", ":"}]}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"testnorm", ">", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log10", "[", 
                RowBox[{"Im", "[", "wint", "]"}], "]"}], "-", "modeprec"}], 
              ")"}]}]}], ",", "\n", "\n", "\n", 
           RowBox[{"(*", "Simplex", "*)"}], "\n", 
           RowBox[{
            RowBox[{"funcofsimplex", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"funcmin", "[", 
                RowBox[{
                 RowBox[{"R2toC", "[", 
                  RowBox[{"newsimplex", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", "\[Nu]int", 
                 ",", "\[Mu]i", ",", "branch"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
            "\n", 
            RowBox[{"fh", "=", 
             RowBox[{"prec", "@", 
              RowBox[{"Max", "[", "funcofsimplex", "]"}]}]}], ";", "\n", 
            RowBox[{"posfh", "=", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"funcofsimplex", ",", "fh"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
            RowBox[{"xh", "=", 
             RowBox[{
              RowBox[{"prec", "@", 
               RowBox[{"newsimplex", "[", 
                RowBox[{"[", "posfh", "]"}], "]"}]}], "//", "First"}]}], ";", 
            "\n", 
            RowBox[{"fl", "=", 
             RowBox[{"Min", "[", "funcofsimplex", "]"}]}], ";", "\n", 
            RowBox[{"posfl", "=", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"funcofsimplex", ",", "fl"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
            RowBox[{"xl", "=", 
             RowBox[{
              RowBox[{"prec", "@", 
               RowBox[{"newsimplex", "[", 
                RowBox[{"[", "posfl", "]"}], "]"}]}], "//", "First"}]}], ";", 
            "\n", 
            RowBox[{"fs", "=", 
             RowBox[{
              RowBox[{"prec", "@", 
               RowBox[{"Delete", "[", 
                RowBox[{"funcofsimplex", ",", 
                 RowBox[{"{", 
                  RowBox[{"posfh", ",", "posfl"}], "}"}]}], "]"}]}], "//", 
              "First"}]}], ";", "\n", 
            RowBox[{"posfs", "=", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"funcofsimplex", ",", "fs"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
            RowBox[{"xs", "=", 
             RowBox[{
              RowBox[{"prec", "@", 
               RowBox[{"newsimplex", "[", 
                RowBox[{"[", "posfs", "]"}], "]"}]}], "//", "First"}]}], ";", 
            "\n", 
            RowBox[{"centroid", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"prec", "@", "1"}], "/", "2"}], 
              RowBox[{"(", 
               RowBox[{"xl", "+", "xs"}], ")"}]}]}], ";", "\n", "\n", 
            RowBox[{"(*", 
             RowBox[{"Transformation", " ", "of", " ", "simplex"}], "*)"}], 
            "\n", 
            RowBox[{"\[Alpha]Simplex", "=", "1"}], ";", "\n", 
            RowBox[{"\[Beta]Simplex", "=", 
             RowBox[{"1", "/", "2"}]}], ";", "\n", 
            RowBox[{"\[Gamma]Simplex", "=", "2"}], ";", "\n", 
            RowBox[{"\[Delta]Simplex", "=", 
             RowBox[{"1", "/", "2"}]}], ";", "\n", 
            RowBox[{"(*", 
             RowBox[{"Reflection", " ", "point"}], "*)"}], "\n", 
            RowBox[{"xr", "=", 
             RowBox[{"prec", "@", 
              RowBox[{"(", 
               RowBox[{"centroid", "+", 
                RowBox[{"\[Alpha]Simplex", 
                 RowBox[{"(", 
                  RowBox[{"centroid", "-", "xh"}], ")"}]}]}], ")"}]}]}], ";", 
            "\n", 
            RowBox[{"fr", "=", 
             RowBox[{"prec", "@", 
              RowBox[{"funcmin", "[", 
               RowBox[{
                RowBox[{"R2toC", "[", "xr", "]"}], ",", "\[Nu]int", ",", 
                "\[Mu]i", ",", "branch"}], "]"}]}]}], ";", "\n", "\n", 
            RowBox[{"(*", 
             RowBox[{"Body", " ", "of", " ", "the", " ", "method"}], "*)"}], 
            "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"fl", "<=", " ", "fr"}], "&&", 
               RowBox[{"fr", "<", "fs"}]}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<Reflected 1\>\"", "]"}], ";"}], 
               "*)"}], "\n", 
              RowBox[{
               RowBox[{"xnew", "=", "xr"}], ";", "\n", 
               RowBox[{"x1", "=", "xs"}], ";", "\n", 
               RowBox[{"x2", "=", "xl"}], ";"}], "\n", ",", "\n", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"fr", "<", "fl"}], ",", "\n", 
                 RowBox[{"(*", "expansion", "*)"}], "\n", 
                 RowBox[{
                  RowBox[{"xe", "=", 
                   RowBox[{"prec", "@", 
                    RowBox[{"(", 
                    RowBox[{"centroid", "+", 
                    RowBox[{"\[Gamma]Simplex", 
                    RowBox[{"(", 
                    RowBox[{"xr", "-", "centroid"}], ")"}]}]}], ")"}]}]}], 
                  ";", "\n", 
                  RowBox[{"fe", "=", 
                   RowBox[{"prec", "@", 
                    RowBox[{"funcmin", "[", 
                    RowBox[{
                    RowBox[{"R2toC", "[", "xe", "]"}], ",", "\[Nu]int", ",", 
                    "\[Mu]i", ",", "branch"}], "]"}]}]}], ";", "\n", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"fe", "<", "fr"}], ",", "\n", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<Expanded\>\"", "]"}], ";"}], 
                    "*)"}], "\n", 
                    RowBox[{
                    RowBox[{"xnew", "=", "xe"}], ";", "\n", 
                    RowBox[{"x1", "=", "xs"}], ";", "\n", 
                    RowBox[{"x2", "=", "xl"}], ";"}], "\n", ",", "\n", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<Reflected 2\>\"", "]"}], ";"}],
                     "*)"}], "\n", 
                    RowBox[{
                    RowBox[{"xnew", "=", "xr"}], ";", "\n", 
                    RowBox[{"x1", "=", "xs"}], ";", "\n", 
                    RowBox[{"x2", "=", "xl"}], ";"}]}], "\n", "]"}], ";"}], 
                 "\n", ",", "\n", 
                 RowBox[{"(*", "contraction", "*)"}], "\n", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"fr", ">=", " ", "fs"}], ",", "\n", 
                    RowBox[{"(*", "outside", "*)"}], "\n", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"fr", "<", "fh"}], ",", "\n", 
                    RowBox[{
                    RowBox[{"xc", "=", 
                    RowBox[{"prec", "@", 
                    RowBox[{"(", 
                    RowBox[{"centroid", "+", 
                    RowBox[{"\[Beta]Simplex", 
                    RowBox[{"(", 
                    RowBox[{"xr", "-", "centroid"}], ")"}]}]}], ")"}]}]}], 
                    ";", "\n", 
                    RowBox[{"fc", "=", 
                    RowBox[{"prec", "@", 
                    RowBox[{"funcmin", "[", 
                    RowBox[{
                    RowBox[{"R2toC", "[", "xc", "]"}], ",", "\[Nu]int", ",", 
                    "\[Mu]i", ",", "branch"}], "]"}]}]}], ";", "\n", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"fc", "<=", " ", "fr"}], ",", "\n", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<Contracted 1\>\"", "]"}], 
                    ";"}], "*)"}], "\n", 
                    RowBox[{
                    RowBox[{"xnew", "=", "xc"}], ";", "\n", 
                    RowBox[{"x1", "=", "xs"}], ";", "\n", 
                    RowBox[{"x2", "=", "xl"}], ";"}], "\n", ",", "\n", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<Shrunk 1\>\"", "]"}], ";"}], 
                    "*)"}], "\n", 
                    RowBox[{
                    RowBox[{"xnew", "=", 
                    RowBox[{"prec", "@", 
                    RowBox[{"(", 
                    RowBox[{"xl", "+", 
                    RowBox[{"\[Delta]Simplex", 
                    RowBox[{"(", 
                    RowBox[{"xs", "-", "xl"}], ")"}]}]}], ")"}]}]}], ";", 
                    "\n", 
                    RowBox[{"x1", "=", 
                    RowBox[{"prec", "@", 
                    RowBox[{"(", 
                    RowBox[{"xl", "+", 
                    RowBox[{"\[Delta]Simplex", 
                    RowBox[{"(", 
                    RowBox[{"xh", "-", "xl"}], ")"}]}]}], ")"}]}]}], ";", 
                    "\n", 
                    RowBox[{"x2", "=", "xl"}], ";"}]}], "\n", "]"}], ";"}], 
                    "\n", ",", "\n", 
                    RowBox[{"(*", "inside", "*)"}], "\n", 
                    RowBox[{
                    RowBox[{"xc", "=", 
                    RowBox[{"prec", "@", 
                    RowBox[{"(", 
                    RowBox[{"centroid", "+", 
                    RowBox[{"\[Beta]Simplex", 
                    RowBox[{"(", 
                    RowBox[{"xh", "-", "centroid"}], ")"}]}]}], ")"}]}]}], 
                    ";", "\n", 
                    RowBox[{"fc", "=", 
                    RowBox[{"prec", "@", 
                    RowBox[{"funcmin", "[", 
                    RowBox[{
                    RowBox[{"R2toC", "[", "xc", "]"}], ",", "\[Nu]int", ",", 
                    "\[Mu]i", ",", "branch"}], "]"}]}]}], ";", "\n", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"fc", "<", "fh"}], ",", "\n", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<Contracted 2\>\""}], ")"}], 
                    "*)"}], "\n", 
                    RowBox[{
                    RowBox[{"xnew", "=", "xc"}], ";", "\n", 
                    RowBox[{"x1", "=", "xs"}], ";", "\n", 
                    RowBox[{"x2", "=", "xl"}], ";"}], "\n", ",", "\n", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<Shrunk 2\>\"", "]"}], ";"}], 
                    "*)"}], "\n", 
                    RowBox[{
                    RowBox[{"xnew", "=", 
                    RowBox[{"prec", "@", 
                    RowBox[{"(", 
                    RowBox[{"xl", "+", 
                    RowBox[{"\[Delta]Simplex", 
                    RowBox[{"(", 
                    RowBox[{"xs", "-", "xl"}], ")"}]}]}], ")"}]}]}], ";", 
                    "\n", 
                    RowBox[{"x1", "=", 
                    RowBox[{"prec", "@", 
                    RowBox[{"(", 
                    RowBox[{"xl", "+", 
                    RowBox[{"\[Delta]Simplex", 
                    RowBox[{"(", 
                    RowBox[{"xh", "-", "xl"}], ")"}]}]}], ")"}]}]}], ";", 
                    "\n", 
                    RowBox[{"x2", "=", "xl"}], ";"}]}], "\n", "]"}], ";"}], 
                    "\n", ",", 
                    RowBox[{"Print", "[", "\"\<Error1!\>\"", "]"}]}], "]"}], 
                    ";"}], "\n", "\n", ",", 
                    RowBox[{"Print", "[", "\"\<Error2!\>\"", "]"}]}], "]"}], 
                  ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
            RowBox[{"(*", 
             RowBox[{"new", " ", "simplex"}], "*)"}], "\n", 
            RowBox[{"newsimplex", "=", 
             RowBox[{"prec", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"xnew", ",", "x1", ",", "x2"}], "}"}], "//", "Abs"}],
                ")"}]}]}], ";", "\n", 
            RowBox[{"xnewprint", "=", 
             RowBox[{"R2toC", "[", "xnew", "]"}]}], ";", "\n", 
            RowBox[{
             RowBox[{"simplexset", "[", 
              RowBox[{"i", ",", "count"}], "]"}], "=", "newsimplex"}], ";", 
            "\n", 
            RowBox[{"\[Nu]int", "=", 
             RowBox[{"prec", "@", "\[Nu]rootout"}]}], ";", "\n", 
            RowBox[{"testnorm", "=", 
             RowBox[{"prec", "@", 
              RowBox[{"Max", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"xnew", "-", "x1"}], "]"}], ",", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"xnew", "-", "x2"}], "]"}], ",", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"x1", "-", "x2"}], "]"}]}], "}"}], "]"}]}]}], ";", 
            "\n", 
            RowBox[{
             RowBox[{"testnormset", "[", 
              RowBox[{"i", ",", "count"}], "]"}], "=", "testnorm"}], ";", 
            "\n", 
            RowBox[{"count", "=", 
             RowBox[{"count", "+", "1"}]}], ";", "\n", 
            RowBox[{"temprint", "=", 
             RowBox[{"\"\<Count: \>\"", "<>", 
              RowBox[{"ToString", "[", "count", "]"}]}]}], ";", "\n", 
            RowBox[{"Print", "[", "temprint", "]"}], ";", "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"count", ">", "5000"}], ",", 
              RowBox[{
               RowBox[{"Print", "[", "\"\<Terminated loop 3\>\"", "]"}], ";", 
               
               RowBox[{"Break", "[", "]"}]}], ",", 
              RowBox[{"{", "}"}]}], "]"}], ";"}]}], "\n", "]"}], ";", "\n", 
         "\t", 
         RowBox[{"\[Omega]minalltemp", "=", 
          RowBox[{"\[Omega]minall", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"funcmin", "[", 
          RowBox[{
           RowBox[{"prec", "@", 
            RowBox[{"R2toC", "[", 
             RowBox[{
              RowBox[{"1", "/", "3"}], 
              RowBox[{"(", 
               RowBox[{"xnew", "+", "x1", "+", "x2"}], ")"}]}], "]"}]}], ",", 
           "\[Nu]int", ",", "\[Mu]i", ",", "branch"}], "]"}], ";", "\n", "\t", 
         RowBox[{
          RowBox[{"\[Mu]minall", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", "\[Mu]i"}], ";", "\n",
          "\t", 
         RowBox[{
          RowBox[{"solRminall", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", "solR"}], ";", "\n", 
         "\t", 
         RowBox[{
          RowBox[{"\[Nu]rootminall", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"prec", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"r\[Nu]", "->", 
              RowBox[{"Re", "[", "\[Nu]rootout", "]"}]}], ",", 
             RowBox[{"i\[Nu]", "->", 
              RowBox[{"Im", "[", "\[Nu]rootout", "]"}]}]}], "}"}]}]}], ";", 
         "\n", "\t", 
         RowBox[{
          RowBox[{"\[Omega]minall", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", "\[Omega]out"}], ";", 
         "\n", "\t", 
         RowBox[{
          RowBox[{"lminout", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"\[Lambda]", "/.", "Coeff"}]}], ";", "\n", "\t", 
         RowBox[{"printw", "=", 
          RowBox[{"prec", "@", 
           RowBox[{"\[Omega]minall", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";", "\n", "\t", 
         RowBox[{"Print", "[", "printw", "]"}], ";", "\n", "\t", 
         RowBox[{
         "Print", "[", 
          "\"\<---------------------------------------------\>\"", "]"}], ";",
          "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"count", ">", "5000"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Terminated 3!\>\"", "]"}], ";", 
              RowBox[{"Break", "[", "]"}]}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ";"}], "*)"}], "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"aa", ">", "500"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Terminated 2!\>\"", "]"}], ";", 
            RowBox[{"Break", "[", "]"}]}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ";", "\n", 
         RowBox[{"Print", "[", "count", "]"}], ";", "\n", 
         RowBox[{"Print", "[", "testnorm", "]"}], ";", "\n", "\n", 
         RowBox[{
          RowBox[{"solRminout", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"solRminall", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"\[Omega]minout", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"\[Omega]minall", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"\[Nu]rootminout", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"\[Nu]rootminall", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"\[Mu]minout", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "\[Mu]i"}], ";", "\n", "\n", 
         RowBox[{"Print", "[", "\"\<Solving angular equation...\>\"", "]"}], 
         ";", "\n", 
         RowBox[{"b", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<b\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
         "\n", 
         RowBox[{"AnglCoeffList", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "\[Mu]minout", "]"}], "}"}]}], "]"}]}], 
         ";", "\n", 
         RowBox[{"AnglFuncList", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "\[Mu]minout", "]"}], "}"}]}], "]"}]}], 
         ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "The", " ", "b0", " ", "will", " ", "parameterize", " ", "all", 
            " ", "the", " ", "solutions", " ", 
            RowBox[{"for", " ", "\\", "vec"}], 
            RowBox[{"{", "b", "}"}], " ", "in", " ", "the", " ", "kernel", 
            " ", "of", " ", 
            RowBox[{"mat", ".", " ", "With"}], " ", "pick", " ", "a", " ", 
            "b0"}], ",", " ", 
           RowBox[{
            RowBox[{
            "such", " ", "that", " ", "the", " ", "resulting", " ", "angular",
              " ", "solution", " ", "has", " ", "a", " ", "global", " ", 
             "maximum", " ", "of", " ", "O", 
             RowBox[{"(", "1", ")"}]}], ";", " ", 
            RowBox[{"for", " ", "numerical", " ", 
             RowBox[{"convenience", "."}]}]}]}], "*)"}], "\n", 
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"l_", ",", "m_", ",", "\[Theta]_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "m", " ", "\[Phi]"}], "]"}]}], "//", 
           "Simplify"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"Sfunc", "[", 
           RowBox[{"m_", ",", "\[Theta]_", ",", "\[Eta]_"}], "]"}], ":=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<b\>\"", "<>", 
               RowBox[{"ToString", "[", "kp", "]"}]}], "]"}], 
             RowBox[{"Y", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", "m", "]"}], "+", 
                RowBox[{"2", "kp"}], "+", "\[Eta]"}], ",", "m", ",", 
               "\[Theta]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"kp", ",", "0", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
         "\n", "\n", 
         RowBox[{"Do", "[", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Note", " ", "the", " ", "multiplication", " ", "by", " ", "some",
              " ", "power", " ", "of", " ", "\[Nu]n", " ", "in", " ", "order",
              " ", "to", " ", "get", " ", "the", " ", "components", " ", "of",
              " ", "the", " ", "matrix", " ", "to", " ", "be", " ", "of", " ",
              "order", " ", "1"}], ",", " ", 
            RowBox[{
             RowBox[{"rather", " ", "than", " ", "e"}], "-", "10"}]}], "*)"}],
           "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"b0norm", "=", "10"}], ";", "\n", 
            RowBox[{"matplug", "=", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"prec", "@", 
                  RowBox[{"(", 
                   RowBox[{"mat", "//", "Simplify"}], ")"}]}], "//.", 
                 RowBox[{"{", 
                  RowBox[{"\[Nu]n", "->", 
                   RowBox[{"r\[Nu]", "+", 
                    RowBox[{"I", " ", "i\[Nu]"}]}]}], "}"}]}], "/.", 
                RowBox[{"\[Nu]rootminout", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Mu]n", "->", 
                  RowBox[{"\[Mu]minout", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                 RowBox[{"\[Omega]nr", "->", 
                  RowBox[{"Re", "[", 
                   RowBox[{"\[Omega]minout", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "]"}]}], ",", 
                 RowBox[{"\[Omega]ni", "->", 
                  RowBox[{"Im", "[", 
                   RowBox[{"\[Omega]minout", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "]"}]}]}], "}"}]}], "//", 
              "Simplify"}]}], ";", "\n", 
            RowBox[{"mattemp", "=", 
             RowBox[{
              RowBox[{"prec", "@", "matplug"}], " ", ".", " ", "b"}]}], ";", 
            "\n", 
            RowBox[{"linsys", "=", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"mattemp", "[", 
                  RowBox[{"[", "l", "]"}], "]"}], "==", "0"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "1", ",", 
                  RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], "//.", 
              RowBox[{"{", 
               RowBox[{"b0", "->", "b0norm"}], "}"}]}]}], ";", "\n", 
            RowBox[{"solvar", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Symbol", "[", 
                RowBox[{"\"\<b\>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
            "\n", 
            RowBox[{"AnglCoeff", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Solve", "[", 
                RowBox[{"linsys", ",", "solvar"}], "]"}], "//.", 
               RowBox[{"{", 
                RowBox[{"b0", "->", "b0norm"}], "}"}]}], "//", "Flatten"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"AnglCoeffList", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "=", "AnglCoeff"}], ";", "\n", 
            RowBox[{
             RowBox[{"Splot", "[", "\[Theta]_", "]"}], ":=", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sfunc", "[", 
                 RowBox[{"m", ",", "\[Theta]", ",", "\[Eta]"}], "]"}], "//.", 
                "AnglCoeff"}], "//.", 
               RowBox[{"{", 
                RowBox[{"b0", "->", "b0norm"}], "}"}]}], "//", "Simplify"}]}],
             ";", "\n", 
            RowBox[{
             RowBox[{"AnglFuncList", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "=", 
             RowBox[{"Splot", "[", "\[Theta]", "]"}]}], ";"}], "\n", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "i"}], "}"}]}], "]"}], ";", "\n", 
         RowBox[{"Print", "[", "\"\<Done\>\"", "]"}], ";", "\n", "\n", 
         RowBox[{"modedataoutput", "=", 
          RowBox[{"{", 
           RowBox[{
           "AnglCoeffList", ",", "AnglFuncList", ",", "\[Mu]minout", ",", 
            "\[Nu]rootminout", ",", "\[Omega]minout", ",", "solRminout", ",", 
            "lminout"}], "}"}]}], ";", "\n", 
         RowBox[{"spinstring", "=", 
          RowBox[{"NumberForm", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"spin", "*", 
              RowBox[{"10", "^", "6"}]}], "//", "Round"}], ",", "6", ",", 
            RowBox[{"DigitBlock", "->", "5"}], ",", 
            RowBox[{"ExponentStep", "->", "6"}], ",", 
            RowBox[{"NumberSeparator", "->", "\"\<\>\""}]}], "]"}]}], ";", 
         "\n", "\n", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "destinationPATH", "]"}], "<>", 
             "\"\</m\>\"", "<>", 
             RowBox[{"ToString", "[", "m", "]"}], "<>", 
             RowBox[{"ToString", "[", "\"\<n\>\"", "]"}], "<>", 
             RowBox[{"ToString", "[", "nh", "]"}], "<>", 
             RowBox[{"ToString", "[", "\"\<_a\>\"", "]"}], "<>", 
             RowBox[{"ToString", "[", "spinstring", "]"}], "<>", 
             RowBox[{"ToString", "[", "\"\<_S\>\"", "]"}], "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Sin", "<", "0"}], ",", "\"\<m\>\"", ",", 
                "\"\<p\>\""}], "]"}], "]"}], "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Abs", "[", "Sin", "]"}], "]"}], "<>", 
             RowBox[{"ToString", "[", "\"\<_prec_\>\"", "]"}], "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"direc", "<", "1"}], ",", "\"\<m\>\"", ",", 
                "\"\<p\>\""}], "]"}], "]"}], "<>", 
             RowBox[{"ToString", "[", "\"\<_HPee.mx\>\"", "]"}]}], "]"}], ",",
            "modedataoutput"}], "]"}], ";", "\n", "\n", 
         RowBox[{"ClearSystemCache", "[", "\"\<Numerical\>\"", "]"}], ";"}]}],
        "\n", "\n", "]"}], ";", "\n", 
      RowBox[{"Print", "[", "\"\<Minimization: Done!\>\"", "]"}], ";"}]}], 
    "\n", "]"}]}], ";"}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.860737365207632*^9, 3.8607379057723494`*^9, {3.860737940500987*^9, 
   3.860737940567479*^9}, {3.860737987370625*^9, 3.860738003021483*^9}, {
   3.860743973579569*^9, 3.860743984374996*^9}, {3.8611919762360773`*^9, 
   3.861191976514595*^9}, {3.8611922014044*^9, 3.861192201457994*^9}},
 CellLabel->
  "(Local2) In[3]:=",ExpressionUUID->"b639f28d-a6f6-4813-bd73-b6461749bf08"]
},
Evaluator->"Local2",
WindowSize->{720., 757.5},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"251ad071-be5b-4d18-a3ef-68b4af2687fd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1128, 28, 228, "Input",ExpressionUUID->"1c2b1f05-e261-482b-aca3-7d09633fb8a2"],
Cell[CellGroupData[{
Cell[1711, 52, 224, 4, 42, "Input",ExpressionUUID->"53f434b0-848b-4f5c-9872-b309f5c1b278"],
Cell[1938, 58, 211, 4, 62, "Output",ExpressionUUID->"4c68787c-3ca9-4675-99fd-c0b7f83bd38e"]
}, Open  ]],
Cell[2164, 65, 665, 19, 64, "Input",ExpressionUUID->"4b95c475-8145-4ac5-9b81-20add96494e9"],
Cell[2832, 86, 130087, 3177, 8338, "Code",ExpressionUUID->"b639f28d-a6f6-4813-bd73-b6461749bf08",
 InitializationCell->False]
}
]
*)

