(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32145,        820]
NotebookOptionsPosition[     27903,        764]
NotebookOutlinePosition[     28316,        781]
CellTagsIndexPosition[     28273,        778]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
  "$FKKSRoot", " ", "=", " ", 
   "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/Packages/\
HelperFunctions.wl\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/Packages/\
KerrWithProca.wl\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/Packages/\
EnergyMomentum.wl\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.883547714969243*^9, 3.8835477490947123`*^9}, {
  3.8835488820211983`*^9, 3.883548884611537*^9}, {3.88364325966225*^9, 
  3.8836432631771383`*^9}},
 CellLabel->
  "(Local 2) In[10]:=",ExpressionUUID->"9e34e096-7fab-4586-9c5e-292b6d188d45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"alldat", " ", "=", " ", 
   RowBox[{"Import", "/@", 
    RowBox[{"FileNames", "[", 
     RowBox[{"All", ",", " ", 
      RowBox[{"$FKKSRoot", "<>", "\"\<Solutions/\>\""}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alldata", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"alldat", ",", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}], "==",
          "0.6"}], " ", "&&", " ", 
        RowBox[{"Not", "@", 
         RowBox[{"StringQ", "[", 
          RowBox[{"#", "[", "\"\<Solution\>\"", "]"}], "]"}]}], "&&", " ", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "==", 
         "1"}], " ", "&&", " ", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<n\>\""}], "]"}], "==", 
         "0"}]}], " ", " ", "&"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alldata", " ", "=", " ", 
   RowBox[{"SortBy", "[", 
    RowBox[{"alldata", ",", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}], 
       "&"}], ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883547750617262*^9, 3.8835477969572973`*^9}, {
  3.883547847963887*^9, 3.883547869282447*^9}, {3.883548895465217*^9, 
  3.883548932269121*^9}, {3.883549087431589*^9, 3.883549117687058*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"479dcc76-76f4-4687-bdbb-449e00124260"],

Cell[BoxData[
 RowBox[{"alldata", "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", " ", "\"\<Parameters\>\"", ",", " ", "\"\<n\>\""}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8835491395369043`*^9, 3.883549146555462*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"588e07b3-e03b-4ad1-bea3-6baa55383d07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", " ", "=", " ", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"alldata", ",", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}], 
         "==", 
         RowBox[{"5", "/", "50"}]}], " ", "&"}], ")"}]}], "]"}], "//", 
    "First"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883548986570017*^9, 3.883549025712481*^9}, {
  3.8835490779739656`*^9, 3.883549081366125*^9}, {3.883549175883243*^9, 
  3.883549193202112*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"d85a58d7-e3cb-41cc-ab53-7b8de09f3082"],

Cell[BoxData[
 RowBox[{"tmp", "[", 
  RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}]], "Input",\

 CellChangeTimes->{{3.883549211417493*^9, 3.883549215626047*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"e9e3c8a2-0a3a-4dbb-85de-ea23d15a17af"],

Cell[BoxData[
 RowBox[{"tmp", " ", "=", " ", "dat"}]], "Input",
 CellChangeTimes->{{3.883560048358819*^9, 
  3.883560050883251*^9}},ExpressionUUID->"58bf9f84-6ff3-4a81-8313-\
4e9e9f8326d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"initomega", " ", "=", " ", 
   RowBox[{"tmp", "[", 
    RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parameters", "=", 
   RowBox[{"tmp", "[", "\"\<Parameters\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"omega", " ", "=", " ", 
     RowBox[{"x", "+", 
      RowBox[{"I", "*", "y"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"nunonrel", " ", "=", " ", 
     RowBox[{"nuNNonRel", "[", "parameters", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nu", " ", "=", " ", 
     RowBox[{"getNuValue", "[", 
      RowBox[{"omega", ",", "parameters", ",", "nunonrel"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"radsol", " ", "=", " ", 
     RowBox[{"getRadialSolution", "[", 
      RowBox[{"omega", ",", "nu", ",", "parameters"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"radsol", "[", "r", "]"}], "//", "Abs"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"parameters", "[", "\"\<StartingX\>\"", "]"}], ",", " ", 
        RowBox[{"parameters", "[", "\"\<EndingX\>\"", "]"}]}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"initomega", "//", "Re"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Re", "[", "initomega", "]"}], "-", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ",", " ", 
     RowBox[{
      RowBox[{"Re", "[", "initomega", "]"}], "+", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ",", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "20"}]]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"initomega", "//", "Im"}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"Im", "[", "initomega", "]"}], "-", 
      SuperscriptBox["10", 
       RowBox[{"-", "22"}]]}], ",", 
     RowBox[{
      RowBox[{"Im", "[", "initomega", "]"}], "+", 
      SuperscriptBox["10", 
       RowBox[{"-", "22"}]]}], ",", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "25"}]]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",\

 CellChangeTimes->{{3.883548769548172*^9, 3.8835488521331472`*^9}, {
  3.8835493821722507`*^9, 3.8835494992964907`*^9}, {3.883549542890502*^9, 
  3.883549686486281*^9}, {3.883549748327489*^9, 3.883549835105131*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"d50ec375-de2e-4697-a491-aa96ad001ce7"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.883551402843018*^9, 
  3.883551403509244*^9}},ExpressionUUID->"45b4737d-77f9-4be4-bfec-\
6a9dc64ba88c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.883551733825234*^9, 3.88355173426204*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"68cd7acd-ee9c-4eeb-a8f0-c61719098b22"],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.8835517351906023`*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"cbc3738e-04f8-43ef-a085-4df0a8fe535e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dat1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Import", "/@", 
     RowBox[{"FileNames", "[", 
      RowBox[{
      "All", ",", " ", 
       "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_\
Field_Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/\
Debugging/../Solutions/m1n0\[Chi]7_10\>\""}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"ReverseSortBy", "[", 
      RowBox[{"#", ",", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#1", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}], 
         "&"}], ")"}]}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dat1", "[", 
  RowBox[{"[", 
   RowBox[{
   "All", ",", " ", "\"\<Solution\>\"", ",", " ", "\"\<RadialPlot\>\""}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.883551411069201*^9, 3.883551433890884*^9}, {
   3.883552066876502*^9, 3.883552068263652*^9}, 3.883553035265047*^9, {
   3.883554205064184*^9, 3.88355420601652*^9}, {3.8835576977610807`*^9, 
   3.883557708998461*^9}, 3.88355781783074*^9, {3.883558524543831*^9, 
   3.88355852476899*^9}, {3.883561821613339*^9, 3.88356182325601*^9}},
 CellLabel->
  "(Local 2) \
In[136]:=",ExpressionUUID->"c9e380f1-bfd4-4d8e-a211-de7db37761c2"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.883561443563793*^9, 
  3.883561445657954*^9}},ExpressionUUID->"4d2bd025-a8de-4b8e-bcea-\
20723998be2d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmp", " ", "=", " ", 
   RowBox[{"dat1", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initomega", " ", "=", " ", 
   RowBox[{"tmp", "[", 
    RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parameters", "=", 
   RowBox[{"tmp", "[", "\"\<Parameters\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", " ", "=", " ", 
   RowBox[{"tmp", "[", 
    RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"omega", " ", "=", " ", 
     RowBox[{"x", "+", 
      RowBox[{"I", "*", "y"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"nunonrel", " ", "=", " ", 
     RowBox[{"nuNNonRel", "[", "parameters", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nu", " ", "=", " ", 
     RowBox[{"getNuValue", "[", 
      RowBox[{"omega", ",", "parameters", ",", "nunonrel"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"radsol", " ", "=", " ", 
     RowBox[{"getRadialSolution", "[", 
      RowBox[{"omega", ",", "nu", ",", "parameters"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"radsol", "[", "r", "]"}], "//", "Abs"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"parameters", "[", "\"\<StartingX\>\"", "]"}], ",", " ", 
        RowBox[{
         RowBox[{"parameters", "[", "\"\<EndingX\>\"", "]"}], "/", "2"}]}], 
       "}"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"ToString", "[", 
        RowBox[{"mu", ",", " ", "InputForm"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"initomega", "//", "Re"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Re", "[", "initomega", "]"}], "-", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ",", " ", 
     RowBox[{
      RowBox[{"Re", "[", "initomega", "]"}], "+", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ",", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "22"}]]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"initomega", "//", "Im"}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"Im", "[", "initomega", "]"}], "-", 
      SuperscriptBox["10", 
       RowBox[{"-", "22"}]]}], ",", 
     RowBox[{
      RowBox[{"Im", "[", "initomega", "]"}], "+", 
      SuperscriptBox["10", 
       RowBox[{"-", "22"}]]}], ",", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "28"}]]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",\

 CellChangeTimes->{{3.883559812647656*^9, 3.8835598975523233`*^9}, {
  3.883560057258514*^9, 3.883560137148738*^9}, {3.883560189430644*^9, 
  3.883560283620914*^9}, {3.883560347957443*^9, 3.883560387012816*^9}, {
  3.8835604215550222`*^9, 3.88356042905962*^9}, {3.8835604735443897`*^9, 
  3.883560479154821*^9}, {3.883560542691361*^9, 3.883560566574452*^9}, {
  3.883561447734123*^9, 3.883561470742117*^9}},
 CellLabel->
  "(Local 2) \
In[121]:=",ExpressionUUID->"663ca7b0-a3c7-47a3-8589-129a0a927e6e"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.883643214755999*^9},
 CellLabel->
  "(Local 2) In[4]:=",ExpressionUUID->"d38ff839-809b-4ea9-b718-a089886abc42"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.883643215797204*^9},
 CellLabel->
  "(Local 2) In[5]:=",ExpressionUUID->"3f7a2174-ff12-4b0e-aa37-7d436b356ef8"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.883643216404591*^9},
 CellLabel->
  "(Local 2) In[6]:=",ExpressionUUID->"c2a1c2d0-46f8-420a-86d4-d27504098735"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.883643216968585*^9},
 CellLabel->
  "(Local 2) In[7]:=",ExpressionUUID->"ed51cc30-8a96-449b-a1cb-54ba1d3105a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dat", " ", "=", " ", 
   RowBox[{
   "Import", "[", 
    "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/Solutions/\
m1n0\[Chi]17_20/RunData_\[Epsilon]1_10000\[Mu]Nv7_100m1\[Eta]0n0l0s-1\[Chi]17_\
20KMax4branch1.mx\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883643217917657*^9, 3.883643243352188*^9}},
 CellLabel->
  "(Local 2) In[9]:=",ExpressionUUID->"afd875f3-21cb-4b28-994b-7f0224a3b62b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testpoint", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "10", ",", "1", ",", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.88364332836504*^9, 3.8836433330791492`*^9}},
 CellLabel->
  "(Local 2) In[16]:=",ExpressionUUID->"500cb255-fa9c-4063-a76c-4d24c67d2038"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"res1", " ", "=", " ", 
   RowBox[{"FKKSEnergyDensity", "[", 
    RowBox[{"dat", ",", " ", 
     RowBox[{"SymbolicExpression", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res1oe", " ", "=", " ", 
   RowBox[{"OptimizedFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
     " ", 
     RowBox[{"Evaluate", "[", "res1", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883643250371153*^9, 3.883643269250966*^9}, {
  3.883643304086207*^9, 3.8836433172083063`*^9}},
 CellLabel->
  "(Local 2) In[14]:=",ExpressionUUID->"a584ebab-8bcb-448b-a8f4-89a76a74436f"],

Cell[BoxData[
 RowBox[{"res1oe", "[", 
  RowBox[{"Sequence", "@@", "testpoint"}], "]"}]], "Input",
 CellChangeTimes->{{3.883643357783642*^9, 3.883643363633466*^9}},
 CellLabel->
  "(Local 2) In[17]:=",ExpressionUUID->"d481eaba-e8f8-4469-a3c4-33e1a5ca436b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"res2", " ", "=", 
   RowBox[{"FKKSEnergyDensity", "[", 
    RowBox[{"dat", ",", " ", 
     RowBox[{"Optimized", "->", "True"}], ",", " ", 
     RowBox[{"WithProperties", "->", "False"}], ",", " ", 
     RowBox[{"ToCompiled", "->", "False"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8836433752475986`*^9, 3.883643401359041*^9}},
 CellLabel->
  "(Local 2) In[18]:=",ExpressionUUID->"a052f6b8-890a-480b-a89f-c4e3d76d6fe0"],

Cell[BoxData[
 RowBox[{"res2", "[", 
  RowBox[{"Sequence", "@@", "testpoint"}], "]"}]], "Input",
 CellChangeTimes->{{3.883643408391539*^9, 3.883643413213642*^9}},
 CellLabel->
  "(Local 2) In[19]:=",ExpressionUUID->"73c73634-1a86-4c32-a84d-f2d199cd9044"],

Cell[BoxData[
 RowBox[{
  RowBox[{"res3", " ", "=", " ", 
   RowBox[{"FKKSEnergyDensity", "[", 
    RowBox[{"dat", ",", " ", 
     RowBox[{"Optimized", "->", "True"}], ",", " ", 
     RowBox[{"WithProperties", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ToCompiled", "->", "False"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883643533206023*^9, 3.883643554297361*^9}},
 CellLabel->
  "(Local 2) In[25]:=",ExpressionUUID->"b51f67a0-1826-4df1-8ebc-6c40793dfde0"],

Cell[BoxData[
 RowBox[{"res3", "[", 
  RowBox[{"Sequence", "@@", "testpoint"}], "]"}]], "Input",
 CellChangeTimes->{{3.8836435550555573`*^9, 3.8836435623750257`*^9}},
 CellLabel->
  "(Local 2) In[26]:=",ExpressionUUID->"b2604e01-0427-48d9-b74b-2fa8ebe14600"],

Cell[BoxData[
 RowBox[{
  RowBox[{"res4", " ", "=", " ", 
   RowBox[{"FKKSEnergyDensity", "[", 
    RowBox[{"dat", ",", " ", 
     RowBox[{"Optimized", "->", "True"}], ",", " ", 
     RowBox[{"ToCompiled", "->", "True"}], ",", " ", 
     RowBox[{"CompilationTarget", "->", "\"\<WVM\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8836436109585867`*^9, 3.883643630521345*^9}},
 CellLabel->
  "(Local 2) In[27]:=",ExpressionUUID->"0a02c7d1-e4c3-44d4-969e-c8267268f838"],

Cell[BoxData[
 RowBox[{
  RowBox[{"res4", "[", 
   RowBox[{"Sequence", "@@", "testpoint"}], "]"}], "//", "Timing"}]], "Input",\

 CellChangeTimes->{{3.883643632465456*^9, 3.88364363622744*^9}, {
  3.883643712254608*^9, 3.88364371322336*^9}},
 CellLabel->
  "(Local 2) In[29]:=",ExpressionUUID->"6c8229bf-32e3-43c1-bf7b-4f2b57a9518a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"res5", " ", "=", " ", 
   RowBox[{"FKKSEnergyDensity", "[", 
    RowBox[{"dat", ",", " ", 
     RowBox[{"Optimized", "->", "True"}], ",", " ", 
     RowBox[{"ToCompiled", "->", "True"}], ",", " ", 
     RowBox[{"CompilationTarget", "->", "\"\<C\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8836437196159678`*^9, 3.883643724953073*^9}},
 CellLabel->
  "(Local 2) In[31]:=",ExpressionUUID->"a259cf57-bd12-4286-9e58-14c3b22ea9e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"res5", "[", 
   RowBox[{"Sequence", "@@", "testpoint"}], "]"}], "//", "Timing"}]], "Input",\

 CellChangeTimes->{{3.8836437305379753`*^9, 3.883643730704817*^9}},
 CellLabel->
  "(Local 2) In[32]:=",ExpressionUUID->"b48f644b-a48a-4e16-aa8d-0bffc0ed8a51"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.8836437837531157`*^9},
 CellLabel->
  "(Local 2) In[33]:=",ExpressionUUID->"109fcf1b-87bb-46ec-8e17-af6479873cc9"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.883643784459127*^9, 3.883643785961706*^9}},
 CellLabel->
  "(Local 2) In[34]:=",ExpressionUUID->"f179c8cb-c0ea-4b37-b3af-4c5ba5031170"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"alldatfiles", " ", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"All", ",", " ", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
       "$FKKSRoot", ",", " ", "\"\<Solutions\>\"", ",", " ", 
        "\"\<m1n0\[Chi]3_4\>\""}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alldat", " ", "=", " ", 
   RowBox[{"Import", "/@", "alldatfiles"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alldat", " ", "=", " ", 
   RowBox[{"SortBy", "[", 
    RowBox[{"alldat", ",", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}], 
       "&"}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mus", " ", "=", " ", 
   RowBox[{"alldat", "[", 
    RowBox[{"[", 
     RowBox[{
     "All", ",", " ", "\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], 
     "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8836437879039927`*^9, 3.883643884034967*^9}, {
  3.8836447836956253`*^9, 3.883644791826049*^9}},
 CellLabel->
  "(Local 2) In[86]:=",ExpressionUUID->"a23728c6-3dbb-4451-ac33-efc237ef3d32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"endens", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FKKSEnergyDensity", "[", 
      RowBox[{"i", ",", " ", 
       RowBox[{"ToCompiled", "->", "True"}], ",", " ", 
       RowBox[{"CompilationTarget", "->", "\"\<WVM\>\""}]}], "]"}], ",", " ", 
     
     RowBox[{"{", 
      RowBox[{"i", ",", "alldat"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883643965725273*^9, 3.883643987763576*^9}, {
  3.8836441891260033`*^9, 3.8836442066639423`*^9}, {3.883644774167233*^9, 
  3.88364477960145*^9}},ExpressionUUID->"14b48f09-f2f5-4cde-a17e-\
cd7f4f8156f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"radialdat", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "200", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thetadom", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0.001", ",", 
       RowBox[{"\[Pi]", "-", "0.001"}], ",", 
       RowBox[{"\[Pi]", "/", "100"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883644911419713*^9, 3.8836449473577967`*^9}, {
  3.883646842414802*^9, 3.883646842906351*^9}, {3.8836469123241053`*^9, 
  3.8836469257568007`*^9}, {3.883648005901257*^9, 3.883648017661422*^9}, {
  3.8836486273780613`*^9, 3.883648627525434*^9}, {3.883648929012776*^9, 
  3.883648931128528*^9}},
 CellLabel->
  "(Local 2) \
In[368]:=",ExpressionUUID->"a32b83cc-c7cb-49a9-9e3e-b01bb4f09648"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ran", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mus", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", "r", ",", "\[Theta]"}], 
          "}"}], ",", " ", 
         RowBox[{
          RowBox[{"endens", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"0", ",", "r", ",", "\[Theta]", ",", "0"}], "]"}]}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "endens", "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"r", ",", "radialdat"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "thetadom"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "2"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8836449660941477`*^9, 3.8836449755466557`*^9}, {
  3.883645043531247*^9, 3.88364510108144*^9}, {3.883648159124536*^9, 
  3.88364816317159*^9}},
 CellLabel->
  "(Local 2) \
In[370]:=",ExpressionUUID->"499cdba7-3d6f-4964-a391-37a0ab02a4dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ran", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "19800"}], "]"}], "]"}], "//", "Last"}]], "Input",
 CellChangeTimes->{{3.883648800059881*^9, 3.883648815514626*^9}, {
  3.883649593127043*^9, 3.8836496221078987`*^9}},
 CellLabel->
  "(Local 2) \
In[382]:=",ExpressionUUID->"9af93cc3-9f00-4c2a-b94a-e87dc5f696de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ran", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "19800"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], ",", " ", 
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1", ",", "3"}], "]"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"%", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Re"}]}], "}"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot3D", "[", 
  RowBox[{"%", ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.883648249990636*^9, 3.883648389588252*^9}, {
  3.8836484220444727`*^9, 3.883648450959703*^9}, {3.8836487957104797`*^9, 
  3.883648819387291*^9}, {3.883649624474321*^9, 3.8836496251652727`*^9}},
 CellLabel->
  "(Local 2) \
In[383]:=",ExpressionUUID->"99539b36-d4f6-43bc-baff-49958298e192"],

Cell[BoxData[
 RowBox[{"interp", " ", "=", " ", 
  RowBox[{"Interpolation", "[", 
   RowBox[{"ran", ",", " ", 
    RowBox[{"Method", "\[Rule]", "\"\<Spline\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8836481067292757`*^9, 3.883648147720709*^9}, {
  3.883648186703124*^9, 3.883648212533155*^9}, {3.883648244727622*^9, 
  3.883648247805233*^9}, {3.883648466624817*^9, 3.88364852796554*^9}},
 CellLabel->
  "(Local 2) \
In[386]:=",ExpressionUUID->"49acd801-0ac8-4d18-8f3e-6d21b8a2d577"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"interp", "[", 
    RowBox[{"0.012", ",", " ", "r", ",", " ", "1"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"r", ",", "2", ",", "200"}], "}"}], ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", "\"\<r\>\"", "}"}]}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8836485308320227`*^9, 3.883648613736699*^9}, {
  3.883648828650141*^9, 3.883648841212449*^9}, {3.88364966116203*^9, 
  3.88364973503643*^9}},
 CellLabel->
  "(Local 2) \
In[403]:=",ExpressionUUID->"5b2e8bff-2822-4cb3-8711-332a77ed0004"],

Cell[BoxData[
 RowBox[{"tmp1", "=", 
  RowBox[{"FKKSEnergyDensity", "[", 
   RowBox[{
    RowBox[{"alldat", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
    RowBox[{"ToCompiled", "->", "True"}], ",", " ", 
    RowBox[{"CompilationTarget", "->", "\"\<WVM\>\""}], ",", " ", 
    RowBox[{"Parallelization", "->", "True"}], ",", " ", 
    RowBox[{"RuntimeAttributes", "->", 
     RowBox[{"{", "Listable", "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.883647060262765*^9, 3.883647068909638*^9}, {
  3.88364713251915*^9, 3.883647133684305*^9}, {3.8836473691052513`*^9, 
  3.883647372377674*^9}, {3.883647439297452*^9, 3.883647440880427*^9}, {
  3.883647680058909*^9, 3.883647695001491*^9}},
 CellLabel->
  "(Local 2) \
In[206]:=",ExpressionUUID->"f1399756-d67c-4bbe-9afe-b2f437114ef2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp1", "[", 
   RowBox[{"0", ",", "10", ",", "1", ",", "0"}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.883647121413392*^9, 3.883647125755106*^9}},
 CellLabel->
  "(Local 2) \
In[207]:=",ExpressionUUID->"f56f7bef-d440-4c65-b888-b6902252d516"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pnts", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "r", ",", "1", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"r", ",", "4", ",", "100", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pntst", " ", "=", " ", 
   RowBox[{"Transpose", "[", "pnts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"endens", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"Sequence", "@@", "i"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", "pnts"}], "}"}]}], "]"}], ";"}], "//", "Timing"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmp1", "@@", "pntst"}], ";"}], "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.883647751210644*^9, 3.883647866143544*^9}},
 CellLabel->
  "(Local 2) \
In[267]:=",ExpressionUUID->"c2ddb9ed-9fce-4364-ba1d-9e3573847b12"]
},
Evaluator->"Local 2",
WindowSize->{720, 756},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bf9fd4b1-ee24-4874-b507-7a43fd74f4c1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1203, 23, 331, "Input",ExpressionUUID->"9e34e096-7fab-4586-9c5e-292b6d188d45"],
Cell[1764, 45, 1672, 44, 133, "Input",ExpressionUUID->"479dcc76-76f4-4687-bdbb-449e00124260"],
Cell[3439, 91, 309, 7, 29, "Input",ExpressionUUID->"588e07b3-e03b-4ad1-bea3-6baa55383d07"],
Cell[3751, 100, 662, 18, 29, "Input",ExpressionUUID->"d85a58d7-e3cb-41cc-ab53-7b8de09f3082"],
Cell[4416, 120, 265, 6, 29, "Input",ExpressionUUID->"e9e3c8a2-0a3a-4dbb-85de-ea23d15a17af"],
Cell[4684, 128, 189, 4, 29, "Input",ExpressionUUID->"58bf9f84-6ff3-4a81-8313-4e9e9f8326d9"],
Cell[4876, 134, 2680, 71, 264, "Input",ExpressionUUID->"d50ec375-de2e-4697-a491-aa96ad001ce7"],
Cell[7559, 207, 152, 3, 29, "Input",ExpressionUUID->"45b4737d-77f9-4be4-bfec-6a9dc64ba88c"],
Cell[7714, 212, 174, 3, 29, "Input",ExpressionUUID->"68cd7acd-ee9c-4eeb-a8f0-c61719098b22"],
Cell[7891, 217, 154, 3, 29, "Input",ExpressionUUID->"cbc3738e-04f8-43ef-a085-4df0a8fe535e"],
Cell[8048, 222, 1284, 31, 166, "Input",ExpressionUUID->"c9e380f1-bfd4-4d8e-a211-de7db37761c2"],
Cell[9335, 255, 152, 3, 29, "Input",ExpressionUUID->"4d2bd025-a8de-4b8e-bcea-20723998be2d"],
Cell[9490, 260, 3428, 90, 342, "Input",ExpressionUUID->"663ca7b0-a3c7-47a3-8589-129a0a927e6e"],
Cell[12921, 352, 178, 3, 62, "Input",ExpressionUUID->"d38ff839-809b-4ea9-b718-a089886abc42"],
Cell[13102, 357, 178, 3, 62, "Input",ExpressionUUID->"3f7a2174-ff12-4b0e-aa37-7d436b356ef8"],
Cell[13283, 362, 178, 3, 62, "Input",ExpressionUUID->"c2a1c2d0-46f8-420a-86d4-d27504098735"],
Cell[13464, 367, 178, 3, 62, "Input",ExpressionUUID->"ed51cc30-8a96-449b-a1cb-54ba1d3105a8"],
Cell[13645, 372, 531, 11, 124, "Input",ExpressionUUID->"afd875f3-21cb-4b28-994b-7f0224a3b62b"],
Cell[14179, 385, 314, 7, 41, "Input",ExpressionUUID->"500cb255-fa9c-4063-a76c-4d24c67d2038"],
Cell[14496, 394, 708, 18, 62, "Input",ExpressionUUID->"a584ebab-8bcb-448b-a8f4-89a76a74436f"],
Cell[15207, 414, 256, 5, 41, "Input",ExpressionUUID->"d481eaba-e8f8-4469-a3c4-33e1a5ca436b"],
Cell[15466, 421, 464, 10, 62, "Input",ExpressionUUID->"a052f6b8-890a-480b-a89f-c4e3d76d6fe0"],
Cell[15933, 433, 254, 5, 41, "Input",ExpressionUUID->"73c73634-1a86-4c32-a84d-f2d199cd9044"],
Cell[16190, 440, 484, 10, 62, "Input",ExpressionUUID->"b51f67a0-1826-4df1-8ebc-6c40793dfde0"],
Cell[16677, 452, 258, 5, 41, "Input",ExpressionUUID->"b2604e01-0427-48d9-b74b-2fa8ebe14600"],
Cell[16938, 459, 480, 11, 62, "Input",ExpressionUUID->"0a02c7d1-e4c3-44d4-969e-c8267268f838"],
Cell[17421, 472, 333, 8, 41, "Input",ExpressionUUID->"6c8229bf-32e3-43c1-bf7b-4f2b57a9518a"],
Cell[17757, 482, 478, 11, 62, "Input",ExpressionUUID->"a259cf57-bd12-4286-9e58-14c3b22ea9e9"],
Cell[18238, 495, 288, 7, 41, "Input",ExpressionUUID->"b48f644b-a48a-4e16-aa8d-0bffc0ed8a51"],
Cell[18529, 504, 181, 3, 62, "Input",ExpressionUUID->"109fcf1b-87bb-46ec-8e17-af6479873cc9"],
Cell[18713, 509, 526, 8, 331, "Input",ExpressionUUID->"f179c8cb-c0ea-4b37-b3af-4c5ba5031170"],
Cell[19242, 519, 1209, 33, 124, "Input",ExpressionUUID->"a23728c6-3dbb-4451-ac33-efc237ef3d32"],
Cell[20454, 554, 623, 15, 71, "Input",ExpressionUUID->"14b48f09-f2f5-4cde-a17e-cd7f4f8156f4"],
Cell[21080, 571, 934, 23, 62, "Input",ExpressionUUID->"a32b83cc-c7cb-49a9-9e3e-b01bb4f09648"],
Cell[22017, 596, 1206, 33, 83, "Input",ExpressionUUID->"499cdba7-3d6f-4964-a391-37a0ab02a4dd"],
Cell[23226, 631, 349, 9, 41, "Input",ExpressionUUID->"9af93cc3-9f00-4c2a-b94a-e87dc5f696de"],
Cell[23578, 642, 1041, 29, 83, "Input",ExpressionUUID->"99539b36-d4f6-43bc-baff-49958298e192"],
Cell[24622, 673, 490, 10, 41, "Input",ExpressionUUID->"49acd801-0ac8-4d18-8f3e-6d21b8a2d577"],
Cell[25115, 685, 629, 15, 41, "Input",ExpressionUUID->"5b2e8bff-2822-4cb3-8711-332a77ed0004"],
Cell[25747, 702, 794, 17, 83, "Input",ExpressionUUID->"f1399756-d67c-4bbe-9afe-b2f437114ef2"],
Cell[26544, 721, 295, 8, 41, "Input",ExpressionUUID->"f56f7bef-d440-4c65-b888-b6902252d516"],
Cell[26842, 731, 1057, 31, 124, "Input",ExpressionUUID->"c2ddb9ed-9fce-4364-ba1d-9e3573847b12"]
}
]
*)

