(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     21553,        552]
NotebookOptionsPosition[     19343,        517]
NotebookOutlinePosition[     19797,        535]
CellTagsIndexPosition[     19754,        532]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Import", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$FKKSRoot", " ", "=", " ", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<../\>\""}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "SpinWeightedSpheroidalHarmonics`"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "Teukolsky`"}], ";"}], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"NotebookEvaluate", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<../Tests/NilsFunctions.nb\>\""}], "]"}], ";"}],
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   StyleBox[
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<../Packages/HelperFunctions.wl\>\""}], "]"}], ";"}],
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   StyleBox[
    RowBox[{
     RowBox[{"testsol", " ", "=", " ", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<../Solutions/RunData_\[Epsilon]1_10000\[Mu]Nv31_100m1\[Eta]\
0n0l0s-1\[Chi]9_10KMax4branch1.mx\>\""}], "]"}]}], ";"}],
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"testsol", "[", 
       RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}], " ", "=", 
      " ", 
      RowBox[{"RecastInterpolationFunction", "[", 
       RowBox[{
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"HorizonCoordToRadial", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{"testsol", "[", 
            RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], 
            "]"}]}], "]"}], "&"}]}], "]"}]}], ";"}],
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   RowBox[{
    RowBox[{"TeukolskyTintegrandExpl", "=", 
     StyleBox[
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<TeukolskyTintegrandExplRunNilsCode.mx\>\""}], "]"}],
      FontSize->14]}], 
    StyleBox[";",
     FontSize->14]}]}]}]], "Input",
 CellChangeTimes->{{3.8743969073558683`*^9, 3.874396911842842*^9}, {
  3.8743987419898233`*^9, 3.8743987422448*^9}},
 CellLabel->
  "(Local2) In[8]:=",ExpressionUUID->"fb5f9014-b391-42a8-8795-1d50f5c992f3"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"mv", "=", " ", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"mTeu", "=", " ", 
       RowBox[{"2", "*", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}]}], 
      ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"nv", " ", "=", " ", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<n\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"spinin", " ", "=", " ", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Chi]1", " ", "=", " ", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Mini", " ", "=", " ", "1"}], ",", "\[IndentingNewLine]", "\t", 
      
      RowBox[{"\[Mu]v", " ", "=", " ", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Omega]rv", " ", "=", " ", 
       RowBox[{
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}], "//",
         "Re"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]Teu", " ", "=", " ", 
       RowBox[{"Re", "[", 
        RowBox[{"2", "*", 
         RowBox[{"testsol", "[", 
          RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Omega]iv", " ", "=", " ", 
       RowBox[{
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}], "//",
         "Im"}]}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Nu]rv", " ", "=", " ", 
       RowBox[{
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}], "//",
         "Re"}]}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Nu]iv", " ", "=", " ", 
       RowBox[{
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}], "//",
         "Im"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"rstopcdoe", " ", "=", " ", "621.36"}]}], "\[IndentingNewLine]",
      "}"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GenerateNilsMST", "[", 
       RowBox[{"spinin", ",", 
        RowBox[{"-", "2"}], ",", "j", ",", "l", ",", "2", ",", " ", 
        RowBox[{"2", "*", "\[Omega]rv"}], ",", " ", "rstop"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"l", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}],
  FontSize->14]], "Input",
 CellChangeTimes->{{3.874396671681785*^9, 3.874396718148231*^9}, 
   3.874397001550714*^9, {3.874397057426323*^9, 3.874397080894245*^9}, 
   3.874397364022031*^9, {3.874397451195053*^9, 3.87439749996684*^9}, {
   3.874397616700098*^9, 3.874397665118425*^9}, {3.874397702019395*^9, 
   3.874397731443062*^9}, {3.874398763512556*^9, 3.87439879763039*^9}, {
   3.874399337749592*^9, 3.874399345498548*^9}},
 CellLabel->
  "(Local2) In[42]:=",ExpressionUUID->"f5f442bd-bf2c-43e7-b5f9-01a5e8a16321"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.874396474448453*^9, 3.874396479006249*^9}, 
   3.874396513182232*^9, 
   3.874396659954919*^9},ExpressionUUID->"35467935-b538-433e-9150-\
a74442bd045b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllDat", " ", "=", " ", 
   RowBox[{"Import", "/@", 
    RowBox[{"FileNames", "[", 
     RowBox[{"All", ",", " ", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<../Solutions\>\""}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873535907394314*^9, 3.873535924028947*^9}},
 CellLabel->
  "(Local2) In[1]:=",ExpressionUUID->"373636e9-5f09-4438-9365-c1a46dc7a82a"],

Cell[BoxData[{
 RowBox[{"$FKKSRoot", "  ", "=", " ", 
  "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/Packages/\
HelperFunctions.wl\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<../Packages/xActSetup.wl\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/Packages/\
TeukolskySolver.wl\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.873536628891201*^9, 3.873536638608515*^9}, {
  3.873874207161171*^9, 3.87387426378848*^9}},
 CellLabel->
  "(Local2) In[34]:=",ExpressionUUID->"92a8dac7-7ad8-429b-acb4-838b12ee9444"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n0m1", "=", " ", 
   RowBox[{"OvertoneModeGroup", "[", 
    RowBox[{"0", ",", "3", ",", "AllDat"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873536619128325*^9, 3.8735366538199177`*^9}, {
  3.8735366866820297`*^9, 3.8735366939726143`*^9}},
 CellLabel->
  "(Local2) In[28]:=",ExpressionUUID->"cade7c25-1b78-409d-8602-4d12bc966f2b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inx", " ", "=", 
   RowBox[{
    RowBox[{"n0m1", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", " ", "\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], 
      "]"}], "]"}], "//", "Ordering"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dat", " ", "=", " ", 
   RowBox[{"n0m1", "[", 
    RowBox[{"[", "inx", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873536319418088*^9, 3.873536355529948*^9}, {
  3.873536552457923*^9, 3.873536571924281*^9}, {3.873536661024942*^9, 
  3.873536664870701*^9}},
 CellLabel->
  "(Local2) In[29]:=",ExpressionUUID->"d671892e-a188-4fb5-a554-bb5dc7be6057"],

Cell[BoxData[
 RowBox[{"getResults", "[", 
  RowBox[{"$SolutionPath", ","}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.8735367243989677`*^9, 
  3.8735367331544857`*^9}},ExpressionUUID->"33448313-a395-471a-9494-\
7ace6fd984ff"],

Cell[BoxData[
 RowBox[{"Dat", "[", 
  RowBox[{"[", 
   RowBox[{"-", "3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.873536466626968*^9, 3.873536508320067*^9}, {
  3.87353657403691*^9, 3.8735366035524893`*^9}, {3.873536670272008*^9, 
  3.8735366770958*^9}, {3.8735367421646423`*^9, 3.873536743928569*^9}},
 CellLabel->
  "(Local2) In[33]:=",ExpressionUUID->"4c2b2347-5eb0-4067-93b1-1789d4696369"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
  "s", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.873873844703176*^9, 3.8738738454386578`*^9}, 
   3.8738741807256403`*^9},ExpressionUUID->"8a932fdd-e622-434f-9ce8-\
34e9dc1f7c0a"],

Cell[BoxData["N1"], "Input",
 CellChangeTimes->{{3.873873991434148*^9, 3.87387399161952*^9}},
 CellLabel->
  "(Local2) In[156]:=",ExpressionUUID->"57d60243-d864-46e2-82e0-827f323e2901"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testsol", " ", "=", " ", 
   RowBox[{
   "Import", "[", 
    "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/Solutions/\
FullSolutionSetRunData_\[Epsilon]1_10000\[Mu]Nv11_100m3\[Eta]0n0l2s-1\[Chi]9_\
10KMax4branch1.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnntest", " ", "=", " ", 
   RowBox[{"Tnn", "[", 
    RowBox[{"testsol", ",", " ", 
     RowBox[{"AsOptimized", "->", "True"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8738738485162487`*^9, 3.8738738593201036`*^9}, {
  3.873874172057541*^9, 3.873874197621325*^9}},
 CellLabel->
  "(Local2) In[8]:=",ExpressionUUID->"3076ae87-9f7f-4bf1-976e-08b39a5c85ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"mat", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1"}], "}"}]}], "}"}]}], 
   ")"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"matinv", " ", "=", " ", 
    RowBox[{
     RowBox[{"Inverse", "[", "mat", "]"}], "//", "Simplify"}]}], ")"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"matinv", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Reprrule", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"N1", "->", 
      RowBox[{"tnntest", "[", 
       RowBox[{"0", ",", "r", ",", "\[Theta]", ",", "0"}], "]"}]}], ",", " ", 
     
     RowBox[{"N2", "->", 
      RowBox[{"tnntest", "[", 
       RowBox[{"0", ",", "r", ",", "\[Theta]", ",", 
        FractionBox["\[Pi]", 
         RowBox[{"4", "*", 
          RowBox[{"testsol", "[", 
           RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}]]}], 
       "]"}]}], ",", " ", 
     RowBox[{"N3", "->", 
      RowBox[{"tnntest", "[", 
       RowBox[{"0", ",", "r", ",", "\[Theta]", ",", 
        FractionBox["\[Pi]", 
         RowBox[{"8", "*", 
          RowBox[{"testsol", "[", 
           RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}]]}], 
       "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coefflist", " ", "=", " ", 
   RowBox[{
    RowBox[{"matinv", ".", 
     RowBox[{"{", 
      RowBox[{"N1", ",", "N2", ",", "N3"}], "}"}]}], "//", "FullSimplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeff1", " ", "=", " ", 
   RowBox[{"coefflist", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeff2", " ", "=", " ", 
   RowBox[{"coefflist", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeff3", " ", "=", " ", 
   RowBox[{"coefflist", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873873866378639*^9, 3.8738738695807962`*^9}, 
   3.8738739465327253`*^9, {3.873873982956087*^9, 3.873873983431493*^9}, {
   3.873874294058981*^9, 3.873874312976594*^9}, 3.873874595865171*^9},
 CellLabel->
  "(Local2) In[10]:=",ExpressionUUID->"fc6a3d89-35de-4322-907a-e5afe7edaafd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeff11", " ", "=", " ", 
   RowBox[{"OptimizedFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
     " ", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"coeff1", "/.", "Reprrule"}], "]"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.873874340237546*^9, 3.873874359159753*^9}},
 CellLabel->
  "(Local2) In[20]:=",ExpressionUUID->"f078b50d-9f81-40d4-acb1-fc3dfcbf352c"],

Cell[BoxData[
 RowBox[{"coeff11", "[", 
  RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.873874165790391*^9, 3.873874165980925*^9}, {
  3.8738743681725273`*^9, 3.873874410999605*^9}},
 CellLabel->
  "(Local2) In[23]:=",ExpressionUUID->"a8c3533c-d69c-420f-b857-fb405e4de233"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solution", " ", "=", " ", "testsol"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmat", "[", 
   RowBox[{"phi1_", ",", " ", "phi2_", ",", " ", "phi3_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi1"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi1"}], "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi2"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi2"}], "]"}], ",", "1"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi3"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi3"}], "]"}], ",", "1"}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.8738746170759573`*^9, 3.8738746245095453`*^9}},
 CellLabel->
  "(Local2) In[28]:=",ExpressionUUID->"b6269b6b-c4f8-46f3-a78c-50d9533d0d39"],

Cell[BoxData[
 RowBox[{"\[Phi]sampling", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", " ", 
    RowBox[{"\[Pi]", "/", 
     RowBox[{"(", 
      RowBox[{"4", "*", 
       RowBox[{"solution", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], 
      ")"}]}], ",", " ", 
    FractionBox["\[Pi]", 
     RowBox[{"8", "*", 
      RowBox[{"solution", "[", 
       RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}]]}], 
   "}"}]}]], "Input",
 CellLabel->
  "(Local2) In[30]:=",ExpressionUUID->"9976aa1a-a402-48b0-ad0a-cfa4d572b259"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinearSolve", "[", 
   RowBox[{
    RowBox[{"Dmat", "[", 
     RowBox[{"Sequence", "@@", "\[Phi]sampling"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Aa", ",", "Bb", ",", "Cc"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8738746511404047`*^9, 3.87387465256693*^9}},
 CellLabel->
  "(Local2) In[32]:=",ExpressionUUID->"905d2d4a-90d8-4abb-93ab-9d1c9b68416a"],

Cell[BoxData[
 RowBox[{"tnnif", " ", "=", " ", 
  RowBox[{"Tnn", "[", 
   RowBox[{"testsol", ",", " ", 
    RowBox[{"AsInterpolatingFunction", "->", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.873874717437265*^9, 3.873874726672521*^9}},
 CellLabel->
  "(Local2) In[38]:=",ExpressionUUID->"55bccc46-50b0-4e87-b8e8-6f7da885c341"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tnnif", "[", 
    RowBox[{"4", ",", "100", ",", "2", ",", "5"}], "]"}], "/.", 
   RowBox[{"r", "->", "100"}]}], "/.", 
  RowBox[{"\[Theta]", "->", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{"tnntest", "[", 
  RowBox[{"4", ",", "100", ",", "2", ",", "5"}], "]"}]}], "Input",
 CellChangeTimes->{{3.87387518159277*^9, 3.873875231203724*^9}},
 CellLabel->
  "(Local2) In[45]:=",ExpressionUUID->"d2f8743a-bdb4-4787-984a-8545e0efb8c2"]
},
Evaluator->"Local2",
WindowSize->{720, 756},
WindowMargins->{{0, Automatic}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d567b409-a330-43e9-ab3b-827fed3a0f02"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2639, 78, 331, "Input",ExpressionUUID->"fb5f9014-b391-42a8-8795-1d50f5c992f3"],
Cell[3200, 100, 3775, 84, 474, "Input",ExpressionUUID->"f5f442bd-bf2c-43e7-b5f9-01a5e8a16321"],
Cell[6978, 186, 713, 12, 463, "Input",ExpressionUUID->"35467935-b538-433e-9150-a74442bd045b"],
Cell[7694, 200, 438, 11, 41, "Input",ExpressionUUID->"373636e9-5f09-4438-9365-c1a46dc7a82a"],
Cell[8135, 213, 1073, 21, 269, "Input",ExpressionUUID->"92a8dac7-7ad8-429b-acb4-838b12ee9444"],
Cell[9211, 236, 372, 8, 41, "Input",ExpressionUUID->"cade7c25-1b78-409d-8602-4d12bc966f2b"],
Cell[9586, 246, 655, 17, 62, "Input",ExpressionUUID->"d671892e-a188-4fb5-a554-bb5dc7be6057"],
Cell[10244, 265, 228, 5, 29, "Input",ExpressionUUID->"33448313-a395-471a-9494-7ace6fd984ff"],
Cell[10475, 272, 400, 8, 41, "Input",ExpressionUUID->"4c2b2347-5eb0-4067-93b1-1789d4696369"],
Cell[10878, 282, 448, 9, 236, "Input",ExpressionUUID->"8a932fdd-e622-434f-9ce8-34e9dc1f7c0a"],
Cell[11329, 293, 185, 3, 41, "Input",ExpressionUUID->"57d60243-d864-46e2-82e0-827f323e2901"],
Cell[11517, 298, 779, 17, 166, "Input",ExpressionUUID->"3076ae87-9f7f-4bf1-976e-08b39a5c85ee"],
Cell[12299, 317, 2643, 72, 288, "Input",ExpressionUUID->"fc6a3d89-35de-4322-907a-e5afe7edaafd"],
Cell[14945, 391, 486, 13, 41, "Input",ExpressionUUID->"f078b50d-9f81-40d4-acb1-fc3dfcbf352c"],
Cell[15434, 406, 311, 6, 41, "Input",ExpressionUUID->"a8c3533c-d69c-420f-b857-fb405e4de233"],
Cell[15748, 414, 1762, 48, 186, "Input",ExpressionUUID->"b6269b6b-c4f8-46f3-a78c-50d9533d0d39"],
Cell[17513, 464, 572, 16, 84, "Input",ExpressionUUID->"9976aa1a-a402-48b0-ad0a-cfa4d572b259"],
Cell[18088, 482, 433, 11, 41, "Input",ExpressionUUID->"905d2d4a-90d8-4abb-93ab-9d1c9b68416a"],
Cell[18524, 495, 336, 7, 41, "Input",ExpressionUUID->"55bccc46-50b0-4e87-b8e8-6f7da885c341"],
Cell[18863, 504, 476, 11, 62, "Input",ExpressionUUID->"d2f8743a-bdb4-4787-984a-8545e0efb8c2"]
}
]
*)

