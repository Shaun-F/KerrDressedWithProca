(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     39803,        985]
NotebookOptionsPosition[     36105,        928]
NotebookOutlinePosition[     36569,        946]
CellTagsIndexPosition[     36526,        943]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["init", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8747267662590857`*^9, 
  3.874726772903491*^9}},ExpressionUUID->"a846862e-f443-4df6-9152-\
a1bc8c14831c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Import", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$FKKSRoot", " ", "=", " ", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<../\>\""}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$SolutionPath", " ", "=", " ", 
     RowBox[{"$FKKSRoot", "<>", "\"\<Solutions/\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "SpinWeightedSpheroidalHarmonics`"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "Teukolsky`"}], ";"}], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"NotebookEvaluate", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<../Tests/NilsFunctions.nb\>\""}], "]"}], ";"}],
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   StyleBox[
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<../Packages/HelperFunctions.wl\>\""}], "]"}], ";"}],
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   StyleBox[
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<../Packages/KerrWithProca.wl\>\""}], "]"}], ";"}],
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   StyleBox[
    RowBox[{
     RowBox[{"testsol", " ", "=", " ", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<../Solutions/RunData_\[Epsilon]1_10000\[Mu]Nv31_100m1\[Eta]\
0n0l0s-1\[Chi]9_10KMax4branch1.mx\>\""}], "]"}]}], ";"}],
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   RowBox[{
    RowBox[{"TeukolskyTintegrandExpl", "=", 
     StyleBox[
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<TeukolskyTintegrandExplRunNilsCode.mx\>\""}], "]"}],
      FontSize->14]}], 
    StyleBox[";",
     FontSize->14]}], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14], 
   RowBox[{
    RowBox[{"NilsSolToMySol", "[", 
     RowBox[{
     "nilssol_List", ",", " ", "mval_Integer", ",", " ", "nval_Integer", ",", 
      " ", 
      RowBox[{"spin_", "?", "NumericQ"}], ",", " ", "pol_Integer"}], "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "anglcoeffs", ",", " ", "anglfunc", ",", " ", "anglfunctmp", ",", 
        "\[Mu]Nv", ",", " ", "\[Nu]", ",", "\[Omega]", ",", "rsol", ",", " ", 
        "frobeniusexp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"anglcoeffs", " ", "=", " ", 
        RowBox[{
         RowBox[{"nilssol", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"anglfunctmp", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"nilssol", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/.", 
          RowBox[{"QNMcode`\[Theta]", "->", "\[Theta]"}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"anglfunc", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", "\[Theta]", "}"}], "|->", 
         RowBox[{"anglfunctmp", "//", "Evaluate"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Mu]Nv", " ", "=", " ", 
        RowBox[{"nilssol", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Nu]", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"QNMcode`r\[Nu]", "+", 
           RowBox[{"I", "*", "QNMcode`i\[Nu]"}]}], ")"}], "/.", 
         RowBox[{"nilssol", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", " ", "=", " ", 
        RowBox[{"nilssol", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rsol", " ", "=", 
        RowBox[{"(", " ", 
         RowBox[{"QNMcode`R", "/.", 
          RowBox[{"nilssol", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"frobeniusexp", " ", "=", " ", 
        RowBox[{"nilssol", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Parameters\>\"", "->", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<m\>\"", "->", "mval"}], ",", " ", 
            RowBox[{"\"\<n\>\"", "->", "nval"}], ",", " ", 
            RowBox[{"\"\<\[Chi]\>\"", "->", "spin"}], ",", " ", 
            RowBox[{"\"\<s\>\"", "->", "pol"}], ",", " ", 
            RowBox[{"\"\<\[Mu]Nv\>\"", "->", "\[Mu]Nv"}]}], "|>"}]}], ",", 
         " ", 
         RowBox[{"\"\<Solution\>\"", "->", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<R\>\"", "->", "rsol"}], ",", " ", 
            RowBox[{"\"\<S\>\"", "->", "anglfunc"}], ",", " ", 
            RowBox[{"\"\<Scoeffs\>\"", "->", "anglcoeffs"}], ",", " ", 
            RowBox[{"\"\<\[Nu]\>\"", "->", "\[Nu]"}], ",", " ", 
            RowBox[{"\"\<\[Omega]\>\"", "->", "\[Omega]"}]}], "|>"}]}]}], 
        "|>"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.8743969073558683`*^9, 3.874396911842842*^9}, {
   3.8743987419898233`*^9, 3.8743987422448*^9}, {3.87446985726682*^9, 
   3.87446986156383*^9}, {3.874470207126178*^9, 3.874470208617731*^9}, {
   3.874486819890048*^9, 3.8744868495707893`*^9}, 3.8747267729038754`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"fb5f9014-b391-42a8-8795-1d50f5c992f3"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SolutionSet", " ", "=", " ", 
    RowBox[{"getResults", "[", "$SolutionPath", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MySolution", "[", "\"\<Derived\>\"", "]"}], " ", "=", " ", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Einf\>\"", "->", 
        RowBox[{"MySolution", "[", 
         RowBox[{"\"\<Derived\>\"", ",", " ", "\"\<Einf\>\""}], "]"}]}], ",", 
       
       RowBox[{"\"\<Tlmw\>\"", "->", 
        RowBox[{"MySolution", "[", 
         RowBox[{"\"\<Derived\>\"", ",", "\"\<Tlmw\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<Normalization\>\"", "->", 
        RowBox[{"MySolution", "[", 
         RowBox[{
         "\"\<Derived\>\"", ",", "\"\<Normalization\>\"", ",", " ", 
          "\"\<Normalization\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<TotalEnergy\>\"", "->", 
        RowBox[{"MySolution", "[", 
         RowBox[{
         "\"\<Derived\>\"", ",", "\"\<Normalization\>\"", ",", 
          "\"\<TotalEnergy\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<FinalMass\>\"", "->", 
        RowBox[{"MySolution", "[", 
         RowBox[{
         "\"\<Derived\>\"", ",", " ", "\"\<Normalization\>\"", ",", " ", 
          "\"\<FinalMass\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<FinalSpin\>\"", "->", 
        RowBox[{"MySolution", "[", 
         RowBox[{
         "\"\<Derived\>\"", ",", " ", "\"\<Normalization\>\"", ",", " ", 
          "\"\<FinalSpin\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<Zinf\>\"", "->", 
        RowBox[{"MySolution", "[", 
         RowBox[{"\"\<Derived\>\"", ",", " ", "\"\<Zinf\>\""}], "]"}]}]}], 
      "|>"}]}], ";"}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"converter", "[", "sol_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MySolution", "=", "sol"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"MySolution", "[", "\"\<Derived\>\"", "]"}], " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Einf\>\"", "->", 
         RowBox[{"MySolution", "[", 
          RowBox[{"\"\<Derived\>\"", ",", " ", "\"\<Einf\>\""}], "]"}]}], ",", 
        RowBox[{"\"\<Tlmw\>\"", "->", 
         RowBox[{"MySolution", "[", 
          RowBox[{"\"\<Derived\>\"", ",", "\"\<Tlmw\>\""}], "]"}]}], ",", 
        RowBox[{"\"\<Normalization\>\"", "->", 
         RowBox[{"MySolution", "[", 
          RowBox[{
          "\"\<Derived\>\"", ",", "\"\<Normalization\>\"", ",", " ", 
           "\"\<Normalization\>\""}], "]"}]}], ",", 
        RowBox[{"\"\<TotalEnergy\>\"", "->", 
         RowBox[{"MySolution", "[", 
          RowBox[{
          "\"\<Derived\>\"", ",", "\"\<Normalization\>\"", ",", 
           "\"\<TotalEnergy\>\""}], "]"}]}], ",", 
        RowBox[{"\"\<FinalMass\>\"", "->", 
         RowBox[{"MySolution", "[", 
          RowBox[{
          "\"\<Derived\>\"", ",", " ", "\"\<Normalization\>\"", ",", " ", 
           "\"\<FinalMass\>\""}], "]"}]}], ",", 
        RowBox[{"\"\<FinalSpin\>\"", "->", 
         RowBox[{"MySolution", "[", 
          RowBox[{
          "\"\<Derived\>\"", ",", " ", "\"\<Normalization\>\"", ",", " ", 
           "\"\<FinalSpin\>\""}], "]"}]}], ",", 
        RowBox[{"\"\<Zinf\>\"", "->", 
         RowBox[{"MySolution", "[", 
          RowBox[{"\"\<Derived\>\"", ",", " ", "\"\<Zinf\>\""}], "]"}]}]}], 
       "|>"}]}], ";", "\[IndentingNewLine]", "MySolution"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.876412795662654*^9, 3.876412796210503*^9}, {
   3.8764134104461603`*^9, 3.876413414979945*^9}, {3.8764785141585503`*^9, 
   3.876478560571372*^9}, {3.876478832812722*^9, 3.876478836646398*^9}, 
   3.87647995703341*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"e3f4fa89-c5eb-4786-87e8-cf168d5f5ab0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SolutionSet", "[", 
  RowBox[{"[", 
   RowBox[{
   "10", ",", " ", "\"\<Derived\>\"", ",", " ", "\"\<Normalization\>\""}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8764844034792547`*^9, 3.8764844244080343`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"45f47052-c299-448f-b6fa-0a36695be694"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Normalization\"\>", "\[Rule]", "0.00012146681894963388`"}], 
   ",", 
   RowBox[{"\<\"NormalizationFractionalError\"\>", "\[Rule]", 
    "9.961174028995116`*^-6"}], ",", 
   RowBox[{"\<\"TotalEnergy\"\>", "\[Rule]", "0.04629276785767902`"}], ",", 
   RowBox[{"\<\"TotalEnergyErrors\"\>", "\[Rule]", 
    "4.6113031691421217`*^-7"}], ",", 
   RowBox[{"\<\"FinalMass\"\>", "\[Rule]", 
    "0.95370723214232097788496140022827839752`18."}], ",", 
   RowBox[{"\<\"FinalSpin\"\>", "\[Rule]", 
    "0.26233588306960186972619677190736912512`16.136891496099985"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.876484407209903*^9, 3.876484424678459*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"144606f0-59b3-488c-9c86-278244b07c3d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ConvertSolutionsetToPythonReadable", "[", 
  RowBox[{"data", ",", " ", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.876412817036379*^9, 3.8764128197641373`*^9}, {
  3.876480217196477*^9, 3.8764802344233637`*^9}, {3.876484566491437*^9, 
  3.876484569552164*^9}, {3.8764846061421633`*^9, 3.876484617015381*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"a045a2fc-5bf6-4fce-9338-b34bca429077"],

Cell[BoxData["\<\"/home/shaunf/Documents/Computer/Code/projects/Massive_\
Vector_Field_Dynamical_Friction/ProcaAroundKerr/FKKSsolver/\
KerrDressedWithProca/Debugging/SolutionSet.dat\"\>"], "Output",
 CellChangeTimes->{3.8764846373789253`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"50d76e76-2464-4b24-a6e3-197a5fa78251"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.874726757219326*^9, 3.874726758199748*^9}, 
   3.875153942197577*^9},ExpressionUUID->"edc2972a-2425-4d9c-80de-\
ae817b141fdf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nilsdat", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"NilsSolToMySol", "[", 
      RowBox[{"#", ",", " ", "1", ",", "0", ",", "0.9", ",", 
       RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Import", "[", 
       "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_\
Field_Dynamical_Friction/ProcaAroundKerr/NilsSiemonsenCode/OG_Code_\
MyExecution/surrogate/m1n0_a900000_Sm1_prec_p_HPee.mx\>\"", "]"}], "//", 
      "Transpose"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mydat", " ", "=", " ", 
   RowBox[{
    RowBox[{"getResults", "[", 
     RowBox[{"$SolutionPath", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<m\>\"", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<n\>\"", ",", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Mu]Nv\>\"", ",", " ", "\"\<3_50\>\""}], "}"}]}], 
       "}"}]}], "]"}], "//", "First"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nilssol", " ", "=", " ", 
   RowBox[{"nilsdat", "[", 
    RowBox[{"[", "6", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8744867855342827`*^9, 3.874486918903492*^9}, {
  3.8744869677263193`*^9, 3.874486979886724*^9}, {3.8744872030833*^9, 
  3.874487213819165*^9}, {3.874487285064083*^9, 3.874487290483452*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"98fb52d3-e8e9-4961-b754-b4aea6d8a323"],

Cell[BoxData[{
 RowBox[{"nilr", " ", "=", 
  RowBox[{"nilssol", "[", 
   RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"myr", "=", 
  RowBox[{"RecastInterpolationFunction", "[", 
   RowBox[{
    RowBox[{"mydat", "[", 
     RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"HorizonCoordToRadial", "[", 
      RowBox[{"#", ",", "0.9"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"LogPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"nilr", "[", "r", "]"}], "//", "Abs"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"r", ",", "1.436", ",", " ", "1000"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"myr", "[", "r", "]"}], "//", "Abs"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"r", ",", "1.436", ",", " ", "1000"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.874486924101156*^9, 3.874486931962432*^9}, {
  3.8744869864321136`*^9, 3.8744869865613947`*^9}, {3.874487182755382*^9, 
  3.874487401282093*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"c50c3f54-5b41-4577-9b87-c2f78f175e95"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.874486782467061*^9, 
  3.874486783293581*^9}},ExpressionUUID->"5fad55d9-5cbb-490d-836e-\
ecfaae012720"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"startingr", " ", "=", " ", 
   RowBox[{"testsol", "[", 
    RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<StartingX\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endingr", " ", "=", " ", 
   RowBox[{"testsol", "[", 
    RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<EndingX\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FrobeniusSystem", "[", 
   RowBox[{"\[Kappa]", ",", "c1", ",", "c2", ",", " ", 
    RowBox[{"testsol", "[", 
     RowBox[{"\"\<Solution\>\"", ",", "\"\<\[Nu]\>\""}], "]"}], ",", " ", 
    RowBox[{"testsol", "[", 
     RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}], ",", 
    " ", 
    RowBox[{"testsol", "[", "\"\<Parameters\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NSolve", "[", 
   RowBox[{"%", ",", " ", 
    RowBox[{"{", 
     RowBox[{"\[Kappa]", ",", "c1", ",", "c2"}], "}"}], ",", " ", 
    RowBox[{"VerifySolutions", "->", "True"}], ",", " ", 
    RowBox[{"WorkingPrecision", "->", 
     RowBox[{
      RowBox[{"testsol", "[", "\"\<Parameters\>\"", "]"}], "[", 
      "\"\<precision\>\"", "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FrobeniusSeries", "[", 
   RowBox[{"xN", ",", " ", 
    RowBox[{"Sequence", "@@", "%"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogPlot", "[", 
  RowBox[{
   RowBox[{"%", "//", "Abs"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"xN", ",", " ", "0.0001", ",", " ", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"testsol", "[", 
      RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}], "[", "r", 
     "]"}], "//", "Abs"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0.0001", ",", "416"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.874469867857524*^9, 3.87446986848925*^9}, {
  3.874469900769256*^9, 3.874469990212716*^9}, {3.8744700331273727`*^9, 
  3.874470156332486*^9}, {3.874470217118539*^9, 3.8744702761771717`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"e240ba92-bfe3-4f66-9bac-62040cae2008"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TruncateInterpolatingFunction", "[", 
   RowBox[{
    RowBox[{"testsol", "[", 
     RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}], ",", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "<", "250"}], "&"}], ")"}], ",", " ", 
    RowBox[{"OnDomain", "->", "True"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"LogPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"%", "[", "r", "]"}], "//", "Abs"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0.0001", ",", "250"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.874478218770417*^9, 3.8744782271652613`*^9}, {
  3.874478281306472*^9, 3.874478328296414*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"1f9328ca-9435-4b62-af0e-ae18f0b5cd0f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8744698421572447`*^9, 
  3.874469852425412*^9}},ExpressionUUID->"3b888b35-5e06-428c-8427-\
2cae4a052da5"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"mv", "=", " ", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"mTeu", "=", " ", 
       RowBox[{"2", "*", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}]}], 
      ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"nv", " ", "=", " ", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<n\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"spinin", " ", "=", " ", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Chi]1", " ", "=", " ", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Mini", " ", "=", " ", "1"}], ",", "\[IndentingNewLine]", "\t", 
      
      RowBox[{"\[Mu]v", " ", "=", " ", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Omega]rv", " ", "=", " ", 
       RowBox[{
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}], "//",
         "Re"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]Teu", " ", "=", " ", 
       RowBox[{"Re", "[", 
        RowBox[{"2", "*", 
         RowBox[{"testsol", "[", 
          RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Omega]iv", " ", "=", " ", 
       RowBox[{
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}], "//",
         "Im"}]}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Nu]rv", " ", "=", " ", 
       RowBox[{
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}], "//",
         "Re"}]}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Nu]iv", " ", "=", " ", 
       RowBox[{
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}], "//",
         "Im"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"rstopcdoe", " ", "=", " ", "621.36"}]}], "\[IndentingNewLine]",
      "}"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GenerateNilsMST", "[", 
       RowBox[{"spinin", ",", 
        RowBox[{"-", "2"}], ",", "j", ",", "l", ",", "2", ",", " ", 
        RowBox[{"2", "*", "\[Omega]rv"}], ",", " ", "rstop"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"l", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}],
  FontSize->14]], "Input",
 CellChangeTimes->{{3.874396671681785*^9, 3.874396718148231*^9}, 
   3.874397001550714*^9, {3.874397057426323*^9, 3.874397080894245*^9}, 
   3.874397364022031*^9, {3.874397451195053*^9, 3.87439749996684*^9}, {
   3.874397616700098*^9, 3.874397665118425*^9}, {3.874397702019395*^9, 
   3.874397731443062*^9}, {3.874398763512556*^9, 3.87439879763039*^9}, {
   3.874399337749592*^9, 3.874399345498548*^9}},
 CellLabel->
  "(Local2) In[42]:=",ExpressionUUID->"f5f442bd-bf2c-43e7-b5f9-01a5e8a16321"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.874396474448453*^9, 3.874396479006249*^9}, 
   3.874396513182232*^9, 
   3.874396659954919*^9},ExpressionUUID->"35467935-b538-433e-9150-\
a74442bd045b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllDat", " ", "=", " ", 
   RowBox[{"Import", "/@", 
    RowBox[{"FileNames", "[", 
     RowBox[{"All", ",", " ", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<../Solutions\>\""}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873535907394314*^9, 3.873535924028947*^9}},
 CellLabel->
  "(Local2) In[1]:=",ExpressionUUID->"373636e9-5f09-4438-9365-c1a46dc7a82a"],

Cell[BoxData[{
 RowBox[{"$FKKSRoot", "  ", "=", " ", 
  "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/Packages/\
HelperFunctions.wl\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<../Packages/xActSetup.wl\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/Packages/\
TeukolskySolver.wl\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.873536628891201*^9, 3.873536638608515*^9}, {
  3.873874207161171*^9, 3.87387426378848*^9}},
 CellLabel->
  "(Local2) In[34]:=",ExpressionUUID->"92a8dac7-7ad8-429b-acb4-838b12ee9444"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n0m1", "=", " ", 
   RowBox[{"OvertoneModeGroup", "[", 
    RowBox[{"0", ",", "3", ",", "AllDat"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.873536619128325*^9, 3.8735366538199177`*^9}, {
  3.8735366866820297`*^9, 3.8735366939726143`*^9}},
 CellLabel->
  "(Local2) In[28]:=",ExpressionUUID->"cade7c25-1b78-409d-8602-4d12bc966f2b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inx", " ", "=", 
   RowBox[{
    RowBox[{"n0m1", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", " ", "\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], 
      "]"}], "]"}], "//", "Ordering"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dat", " ", "=", " ", 
   RowBox[{"n0m1", "[", 
    RowBox[{"[", "inx", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873536319418088*^9, 3.873536355529948*^9}, {
  3.873536552457923*^9, 3.873536571924281*^9}, {3.873536661024942*^9, 
  3.873536664870701*^9}},
 CellLabel->
  "(Local2) In[29]:=",ExpressionUUID->"d671892e-a188-4fb5-a554-bb5dc7be6057"],

Cell[BoxData[
 RowBox[{"getResults", "[", 
  RowBox[{"$SolutionPath", ","}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.8735367243989677`*^9, 
  3.8735367331544857`*^9}},ExpressionUUID->"33448313-a395-471a-9494-\
7ace6fd984ff"],

Cell[BoxData[
 RowBox[{"Dat", "[", 
  RowBox[{"[", 
   RowBox[{"-", "3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.873536466626968*^9, 3.873536508320067*^9}, {
  3.87353657403691*^9, 3.8735366035524893`*^9}, {3.873536670272008*^9, 
  3.8735366770958*^9}, {3.8735367421646423`*^9, 3.873536743928569*^9}},
 CellLabel->
  "(Local2) In[33]:=",ExpressionUUID->"4c2b2347-5eb0-4067-93b1-1789d4696369"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
  "s", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.873873844703176*^9, 3.8738738454386578`*^9}, 
   3.8738741807256403`*^9},ExpressionUUID->"8a932fdd-e622-434f-9ce8-\
34e9dc1f7c0a"],

Cell[BoxData["N1"], "Input",
 CellChangeTimes->{{3.873873991434148*^9, 3.87387399161952*^9}},
 CellLabel->
  "(Local2) In[156]:=",ExpressionUUID->"57d60243-d864-46e2-82e0-827f323e2901"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testsol", " ", "=", " ", 
   RowBox[{
   "Import", "[", 
    "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/FKKSsolver/KerrDressedWithProca/Solutions/\
FullSolutionSetRunData_\[Epsilon]1_10000\[Mu]Nv11_100m3\[Eta]0n0l2s-1\[Chi]9_\
10KMax4branch1.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnntest", " ", "=", " ", 
   RowBox[{"Tnn", "[", 
    RowBox[{"testsol", ",", " ", 
     RowBox[{"AsOptimized", "->", "True"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8738738485162487`*^9, 3.8738738593201036`*^9}, {
  3.873874172057541*^9, 3.873874197621325*^9}},
 CellLabel->
  "(Local2) In[8]:=",ExpressionUUID->"3076ae87-9f7f-4bf1-976e-08b39a5c85ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"mat", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1"}], "}"}]}], "}"}]}], 
   ")"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"matinv", " ", "=", " ", 
    RowBox[{
     RowBox[{"Inverse", "[", "mat", "]"}], "//", "Simplify"}]}], ")"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"matinv", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Reprrule", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"N1", "->", 
      RowBox[{"tnntest", "[", 
       RowBox[{"0", ",", "r", ",", "\[Theta]", ",", "0"}], "]"}]}], ",", " ", 
     
     RowBox[{"N2", "->", 
      RowBox[{"tnntest", "[", 
       RowBox[{"0", ",", "r", ",", "\[Theta]", ",", 
        FractionBox["\[Pi]", 
         RowBox[{"4", "*", 
          RowBox[{"testsol", "[", 
           RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}]]}], 
       "]"}]}], ",", " ", 
     RowBox[{"N3", "->", 
      RowBox[{"tnntest", "[", 
       RowBox[{"0", ",", "r", ",", "\[Theta]", ",", 
        FractionBox["\[Pi]", 
         RowBox[{"8", "*", 
          RowBox[{"testsol", "[", 
           RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}]]}], 
       "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coefflist", " ", "=", " ", 
   RowBox[{
    RowBox[{"matinv", ".", 
     RowBox[{"{", 
      RowBox[{"N1", ",", "N2", ",", "N3"}], "}"}]}], "//", "FullSimplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeff1", " ", "=", " ", 
   RowBox[{"coefflist", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeff2", " ", "=", " ", 
   RowBox[{"coefflist", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeff3", " ", "=", " ", 
   RowBox[{"coefflist", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873873866378639*^9, 3.8738738695807962`*^9}, 
   3.8738739465327253`*^9, {3.873873982956087*^9, 3.873873983431493*^9}, {
   3.873874294058981*^9, 3.873874312976594*^9}, 3.873874595865171*^9},
 CellLabel->
  "(Local2) In[10]:=",ExpressionUUID->"fc6a3d89-35de-4322-907a-e5afe7edaafd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeff11", " ", "=", " ", 
   RowBox[{"OptimizedFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
     " ", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"coeff1", "/.", "Reprrule"}], "]"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.873874340237546*^9, 3.873874359159753*^9}},
 CellLabel->
  "(Local2) In[20]:=",ExpressionUUID->"f078b50d-9f81-40d4-acb1-fc3dfcbf352c"],

Cell[BoxData[
 RowBox[{"coeff11", "[", 
  RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.873874165790391*^9, 3.873874165980925*^9}, {
  3.8738743681725273`*^9, 3.873874410999605*^9}},
 CellLabel->
  "(Local2) In[23]:=",ExpressionUUID->"a8c3533c-d69c-420f-b857-fb405e4de233"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solution", " ", "=", " ", "testsol"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmat", "[", 
   RowBox[{"phi1_", ",", " ", "phi2_", ",", " ", "phi3_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi1"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi1"}], "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi2"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi2"}], "]"}], ",", "1"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi3"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "*", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}], "*", 
        "phi3"}], "]"}], ",", "1"}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.8738746170759573`*^9, 3.8738746245095453`*^9}},
 CellLabel->
  "(Local2) In[28]:=",ExpressionUUID->"b6269b6b-c4f8-46f3-a78c-50d9533d0d39"],

Cell[BoxData[
 RowBox[{"\[Phi]sampling", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", " ", 
    RowBox[{"\[Pi]", "/", 
     RowBox[{"(", 
      RowBox[{"4", "*", 
       RowBox[{"solution", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], 
      ")"}]}], ",", " ", 
    FractionBox["\[Pi]", 
     RowBox[{"8", "*", 
      RowBox[{"solution", "[", 
       RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}]]}], 
   "}"}]}]], "Input",
 CellLabel->
  "(Local2) In[30]:=",ExpressionUUID->"9976aa1a-a402-48b0-ad0a-cfa4d572b259"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinearSolve", "[", 
   RowBox[{
    RowBox[{"Dmat", "[", 
     RowBox[{"Sequence", "@@", "\[Phi]sampling"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Aa", ",", "Bb", ",", "Cc"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8738746511404047`*^9, 3.87387465256693*^9}},
 CellLabel->
  "(Local2) In[32]:=",ExpressionUUID->"905d2d4a-90d8-4abb-93ab-9d1c9b68416a"],

Cell[BoxData[
 RowBox[{"tnnif", " ", "=", " ", 
  RowBox[{"Tnn", "[", 
   RowBox[{"testsol", ",", " ", 
    RowBox[{"AsInterpolatingFunction", "->", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.873874717437265*^9, 3.873874726672521*^9}},
 CellLabel->
  "(Local2) In[38]:=",ExpressionUUID->"55bccc46-50b0-4e87-b8e8-6f7da885c341"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tnnif", "[", 
    RowBox[{"4", ",", "100", ",", "2", ",", "5"}], "]"}], "/.", 
   RowBox[{"r", "->", "100"}]}], "/.", 
  RowBox[{"\[Theta]", "->", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{"tnntest", "[", 
  RowBox[{"4", ",", "100", ",", "2", ",", "5"}], "]"}]}], "Input",
 CellChangeTimes->{{3.87387518159277*^9, 3.873875231203724*^9}},
 CellLabel->
  "(Local2) In[45]:=",ExpressionUUID->"d2f8743a-bdb4-4787-984a-8545e0efb8c2"]
},
WindowSize->{720, 756},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>0.75 Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d567b409-a330-43e9-ab3b-827fed3a0f02"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 203, 4, 27, "Text",ExpressionUUID->"a846862e-f443-4df6-9152-a1bc8c14831c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[786, 28, 5944, 155, 510, "Input",ExpressionUUID->"fb5f9014-b391-42a8-8795-1d50f5c992f3",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Closed]],
Cell[6745, 186, 3845, 89, 288, "Input",ExpressionUUID->"e3f4fa89-c5eb-4786-87e8-cf168d5f5ab0"],
Cell[CellGroupData[{
Cell[10615, 279, 323, 7, 24, "Input",ExpressionUUID->"45f47052-c299-448f-b6fa-0a36695be694"],
Cell[10941, 288, 814, 16, 43, "Output",ExpressionUUID->"144606f0-59b3-488c-9c86-278244b07c3d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11792, 309, 453, 7, 24, "Input",ExpressionUUID->"a045a2fc-5bf6-4fce-9338-b34bca429077"],
Cell[12248, 318, 321, 4, 42, "Output",ExpressionUUID->"50d76e76-2464-4b24-a6e3-197a5fa78251"]
}, Open  ]],
Cell[12584, 325, 615, 10, 310, "Input",ExpressionUUID->"edc2972a-2425-4d9c-80de-ae817b141fdf"],
Cell[13202, 337, 1501, 37, 123, "Input",ExpressionUUID->"98fb52d3-e8e9-4961-b754-b4aea6d8a323"],
Cell[14706, 376, 1159, 30, 75, "Input",ExpressionUUID->"c50c3f54-5b41-4577-9b87-c2f78f175e95"],
Cell[15868, 408, 471, 8, 230, "Input",ExpressionUUID->"5fad55d9-5cbb-490d-836e-ecfaae012720"],
Cell[16342, 418, 2335, 59, 141, "Input",ExpressionUUID->"e240ba92-bfe3-4f66-9bac-62040cae2008"],
Cell[18680, 479, 826, 20, 56, "Input",ExpressionUUID->"1f9328ca-9435-4b62-af0e-ae18f0b5cd0f"],
Cell[19509, 501, 450, 8, 214, "Input",ExpressionUUID->"3b888b35-5e06-428c-8427-2cae4a052da5"],
Cell[19962, 511, 3775, 84, 361, "Input",ExpressionUUID->"f5f442bd-bf2c-43e7-b5f9-01a5e8a16321"],
Cell[23740, 597, 713, 12, 358, "Input",ExpressionUUID->"35467935-b538-433e-9150-a74442bd045b"],
Cell[24456, 611, 438, 11, 43, "Input",ExpressionUUID->"373636e9-5f09-4438-9365-c1a46dc7a82a"],
Cell[24897, 624, 1073, 21, 101, "Input",ExpressionUUID->"92a8dac7-7ad8-429b-acb4-838b12ee9444"],
Cell[25973, 647, 372, 8, 42, "Input",ExpressionUUID->"cade7c25-1b78-409d-8602-4d12bc966f2b"],
Cell[26348, 657, 655, 17, 63, "Input",ExpressionUUID->"d671892e-a188-4fb5-a554-bb5dc7be6057"],
Cell[27006, 676, 228, 5, 30, "Input",ExpressionUUID->"33448313-a395-471a-9494-7ace6fd984ff"],
Cell[27237, 683, 400, 8, 41, "Input",ExpressionUUID->"4c2b2347-5eb0-4067-93b1-1789d4696369"],
Cell[27640, 693, 448, 9, 225, "Input",ExpressionUUID->"8a932fdd-e622-434f-9ce8-34e9dc1f7c0a"],
Cell[28091, 704, 185, 3, 41, "Input",ExpressionUUID->"57d60243-d864-46e2-82e0-827f323e2901"],
Cell[28279, 709, 779, 17, 122, "Input",ExpressionUUID->"3076ae87-9f7f-4bf1-976e-08b39a5c85ee"],
Cell[29061, 728, 2643, 72, 225, "Input",ExpressionUUID->"fc6a3d89-35de-4322-907a-e5afe7edaafd"],
Cell[31707, 802, 486, 13, 43, "Input",ExpressionUUID->"f078b50d-9f81-40d4-acb1-fc3dfcbf352c"],
Cell[32196, 817, 311, 6, 41, "Input",ExpressionUUID->"a8c3533c-d69c-420f-b857-fb405e4de233"],
Cell[32510, 825, 1762, 48, 84, "Input",ExpressionUUID->"b6269b6b-c4f8-46f3-a78c-50d9533d0d39"],
Cell[34275, 875, 572, 16, 60, "Input",ExpressionUUID->"9976aa1a-a402-48b0-ad0a-cfa4d572b259"],
Cell[34850, 893, 433, 11, 43, "Input",ExpressionUUID->"905d2d4a-90d8-4abb-93ab-9d1c9b68416a"],
Cell[35286, 906, 336, 7, 43, "Input",ExpressionUUID->"55bccc46-50b0-4e87-b8e8-6f7da885c341"],
Cell[35625, 915, 476, 11, 61, "Input",ExpressionUUID->"d2f8743a-bdb4-4787-984a-8545e0efb8c2"]
}
]
*)

