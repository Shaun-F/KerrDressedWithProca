(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    138987,       3192]
NotebookOptionsPosition[    137696,       3161]
NotebookOutlinePosition[    138129,       3178]
CellTagsIndexPosition[    138086,       3175]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Chapter",
 CellChangeTimes->{{3.864772106535747*^9, 3.864772109240108*^9}, 
   3.8648659132081947`*^9},ExpressionUUID->"fc3c1c9b-4fe9-4801-8473-\
dee71b5fa03c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$FKKSRoot", " ", "=", " ", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<../\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolutionPath", " ", "=", 
   RowBox[{"$FKKSRoot", "<>", "\"\<Solutions/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$HistoryLength", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]\[Epsilon]", " ", "=", " ", 
   SuperscriptBox["10", 
    RowBox[{"-", "4"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]points", " ", "=", " ", "25"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]points", " ", "=", " ", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MinRecursion", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$MaxRecursion", " ", "=", " ", "Automatic"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$NIntegratePrecision", " ", "=", " ", "$MachinePrecision"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$NIntegrateMethod", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<GlobalAdaptive\>\"", ",", " ", 
     RowBox[{"\"\<MaxErrorIncreases\>\"", "->", "1000"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "Debug", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Import", " ", "Proca", " ", "Mode", " ", "Solver"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "KerrWithProca`"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Import", " ", "xAct", " ", "Setup"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "$FKKSRoot", ",", " ", "\"\<Packages\>\"", ",", " ", 
      "\"\<xActSetup.wl\>\""}], "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", ">", "0"}], ",", 
       RowBox[{"M", ">", "0"}], ",", 
       RowBox[{"J", ">", "0"}], ",", 
       RowBox[{"1", ">", "a", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{
       "\[Pi]", "\[GreaterEqual]", "\[Theta]", "\[GreaterEqual]", "0"}], ",", 
       " ", 
       RowBox[{"\[Lambda]", "\[Element]", "Complexes"}], ",", 
       RowBox[{"\[Omega]", "\[Element]", "Complexes"}], ",", " ", 
       RowBox[{"\[Nu]", "\[Element]", "Complexes"}]}], "}"}]}], ";"}], "*)"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AnalyticSolution", " ", "=", " ", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", "\[Epsilon]"}], ",", 
        RowBox[{"\"\<\[Mu]Nv\>\"", "\[Rule]", "\[Mu]Nv"}], ",", 
        RowBox[{"\"\<m\>\"", "\[Rule]", "m"}], ",", 
        RowBox[{"\"\<n\>\"", "\[Rule]", "n"}], ",", 
        RowBox[{"\"\<\[Chi]\>\"", "\[Rule]", "\[Chi]"}], ",", 
        RowBox[{"\"\<M\>\"", "\[Rule]", "M"}]}], "\[RightAssociation]"}]}], 
     ",", 
     RowBox[{"\"\<Solution\>\"", "\[Rule]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<\[Omega]\>\"", "\[Rule]", "\[Omega]"}], ",", 
        RowBox[{"\"\<\[Nu]\>\"", "\[Rule]", "\[Nu]"}], ",", 
        RowBox[{"\"\<R\>\"", "\[Rule]", "R"}], ",", 
        RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "\[RightAssociation]"}]}]}], 
    "\[RightAssociation]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.864777392058223*^9, 3.864777394113221*^9}, {
   3.864777812029127*^9, 3.864777842278801*^9}, {3.864802171283193*^9, 
   3.864802180304125*^9}, {3.864802240649514*^9, 3.864802240995062*^9}, {
   3.864803417399868*^9, 3.8648034176047993`*^9}, {3.864813968384432*^9, 
   3.864813982867878*^9}, {3.864865409552375*^9, 3.8648654115199537`*^9}, {
   3.864865462855579*^9, 3.864865476631353*^9}, {3.864865512839136*^9, 
   3.864865567738491*^9}, {3.8648656746214933`*^9, 3.864865737884324*^9}, {
   3.864865847039402*^9, 3.864865871078671*^9}, {3.864865967934804*^9, 
   3.864865975738267*^9}, 3.8648661678482533`*^9, {3.864879676070901*^9, 
   3.8648796950422487`*^9}, 3.8656524275642548`*^9, {3.865658288153764*^9, 
   3.865658314042589*^9}, {3.865658424168597*^9, 3.8656584244452877`*^9}, {
   3.8660445952980967`*^9, 3.866044595392845*^9}, {3.866160577638291*^9, 
   3.8661606505833673`*^9}, {3.8661616839738503`*^9, 3.8661616996916323`*^9}, 
   3.8661628258672237`*^9, 3.866171166029866*^9, {3.866279322476062*^9, 
   3.866279327081788*^9}, {3.866279571145417*^9, 3.8662795740107317`*^9}, {
   3.866530714203475*^9, 3.866530716897135*^9}, {3.8665309496266603`*^9, 
   3.866530987191333*^9}, 3.8665310234777803`*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"60c866cf-6c50-4c82-b64b-4ae293b21cf0"],

Cell[BoxData[
 TemplateBox[{
  "Throw", "nocatch", 
   "\"Uncaught \\!\\(\\*RowBox[{\\\"Throw\\\", \\\"[\\\", \\\"Null\\\", \\\"]\
\\\"}]\\) returned to top level.\"", 2, 171, 52, 23425389178598128179, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8665310245684423`*^9},
 CellLabel->
  "During evaluation of \
In[158]:=",ExpressionUUID->"a6ec44d9-0913-414f-b437-71e40b89ba6a"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"Throw", "[", "Null", "]"}], "]"}]], "Output",
 CellChangeTimes->{3.866531024579857*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"5b3b1c4d-eeee-4dd5-b989-1b33f1e68edb"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Helper Functions", "Chapter",
 CellChangeTimes->{{3.8647721731001368`*^9, 
  3.864772174705913*^9}},ExpressionUUID->"4eadd76b-ca7b-46bf-81a4-\
4d9382974e33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Kerrmetweight", "[", 
    RowBox[{"r_", ",", "\[Theta]_", ",", "\[Chi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["\[Chi]", "2"], "*", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], "*", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OvertoneModeGroup", "[", 
    RowBox[{
     RowBox[{"nvalue_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"mvalue_", "?", "NumberQ"}]}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"AllSolutions", ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<Parameters\>\"", "]"}], "[", "\"\<n\>\"", 
          "]"}], "\[Equal]", "nvalue"}], "&"}]}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "\"\<Parameters\>\"", "]"}], "[", "\"\<m\>\"", 
        "]"}], "\[Equal]", "mvalue"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HorizonCoordToRadial", "[", 
    RowBox[{"xN_", ",", " ", "\[Chi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"xN", " ", "*", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rplusN", "[", "\[Chi]", "]"}], " ", "-", " ", 
       RowBox[{"rminusN", "[", "\[Chi]", "]"}]}], ")"}]}], "  ", "+", "  ", 
    RowBox[{"rplusN", "[", "\[Chi]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RadialToHorizonCoord", "[", 
     RowBox[{"rN_", ",", "\[Chi]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"rN", " ", "-", " ", 
       RowBox[{"rplusN", "[", "\[Chi]", "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rplusN", "[", "\[Chi]", "]"}], " ", "-", " ", 
       RowBox[{"rminusN", "[", "\[Chi]", "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "59944"}], "/", "extracting"}], "-", "the", "-", 
     "function", "-", "from", "-", "interpolatingfunction", "-", 
     RowBox[{
      RowBox[{"object", "/", "59963"}], "#59963"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InterpolationToPiecewise", "[", 
    RowBox[{"if_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"main", ",", "default", ",", "grid"}], "}"}], ",", 
      RowBox[{
       RowBox[{"grid", "=", 
        RowBox[{"if", "[", "\"\<Grid\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Piecewise", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"if", "@", 
              RowBox[{"\"\<GetPolynomial\>\"", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x", "-", "#"}]}], "]"}]}], ",", 
             RowBox[{"x", "<", 
              RowBox[{"First", "@", "#"}]}]}], "}"}], "&"}], "/@", 
          RowBox[{"grid", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"if", "@", 
            RowBox[{"\"\<GetPolynomial\>\"", "[", 
             RowBox[{"#", ",", 
              RowBox[{"x", "-", "#"}]}], "]"}]}], "&"}], "@", 
          RowBox[{"grid", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}]}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"if", "[", "\"\<InterpolationMethod\>\"", "]"}], "==", 
     "\"\<Hermite\>\""}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Redundant", "?"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CompileInterpolating", "[", "interp_InterpolatingFunction", "]"}],
    ":=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", "\[Psi]", "}"}], ",", " ", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"InterpolationToPiecewise", "[", 
       RowBox[{"interp", ",", " ", "\[Psi]"}], "]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParamsToReprRule", "[", "solution_", "]"}], ":=", 
   RowBox[{
    RowBox[{"AssociationThread", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Symbol", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"solution", "[", " ", "\"\<Parameters\>\"", "]"}], "//", 
          "Keys"}], ")"}]}], ")"}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"solution", "[", " ", "\"\<Parameters\>\"", "]"}], "//", 
        "Values"}], ")"}]}], "]"}], "//", "Normal"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToRational", "[", "expr_", "]"}], ":=", 
  RowBox[{"Rationalize", "[", 
   RowBox[{"expr", ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrimedToSymbolic", "[", "expr_", "]"}], ":=", 
    RowBox[{"expr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["R", "\[Prime]\[Prime]"], "->", "ddR"}], ",", " ", 
       RowBox[{
        SuperscriptBox["R", "\[Prime]"], "->", "dR"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SolToReprRule", "[", 
     RowBox[{"solution_", ",", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{"real", "->", "False"}], "}"}], "]"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Omega]v", " ", "=", " ", 
         RowBox[{"solution", "[", 
          RowBox[{"\"\<Solution\>\"", ",", "\"\<\[Omega]\>\""}], "]"}]}], ",", 
        RowBox[{"\[Nu]v", " ", "=", " ", 
         RowBox[{"solution", "[", 
          RowBox[{"\"\<Solution\>\"", ",", "\"\<\[Nu]\>\""}], "]"}]}], ",", 
        " ", 
        RowBox[{"Rv", "=", 
         RowBox[{"solution", "[", 
          RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}]}], ",", " ", 
        RowBox[{"Sv", " ", "=", " ", 
         RowBox[{"solution", "[", 
          RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}]}], ",", " ", 
        RowBox[{"\[Chi]v", " ", "=", " ", 
         RowBox[{"solution", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", "\"\<\[Chi]\>\""}], "]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "real", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Omega]", ",", "\[Nu]", ",", "S", ",", "R", ",", "dR", ",", 
            "ddR"}], "}"}], "->", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Re", "[", "\[Omega]v", "]"}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t\t", "\[Nu]v", ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t\t", "Sv", ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t\t", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Rv", "[", 
                RowBox[{"RadialToHorizonCoord", "[", 
                 RowBox[{"#", ",", "\[Chi]v"}], "]"}], "]"}], "&"}], ")"}], 
             ",", " ", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t\t", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["Rv", "\[Prime]"], "[", 
                  RowBox[{"RadialToHorizonCoord", "[", 
                   RowBox[{"#", ",", "\[Chi]v"}], "]"}], "]"}], "*", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"rplusN", "[", "\[Chi]v", "]"}], "-", 
                   RowBox[{"rminusN", "[", "\[Chi]v", "]"}]}]]}], ")"}], 
               "&"}], ")"}], ",", "\[IndentingNewLine]", 
             "\t\t\t\t\t\t\t\t\t\t\t", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   SuperscriptBox["Rv", "\[Prime]"], "\[Prime]"], "[", 
                  RowBox[{"RadialToHorizonCoord", "[", 
                   RowBox[{"#", ",", "\[Chi]v"}], "]"}], "]"}], "*", 
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rplusN", "[", "\[Chi]v", "]"}], "-", 
                    RowBox[{"rminusN", "[", "\[Chi]v", "]"}]}], ")"}], 
                   "2"]]}], ")"}], "&"}], ")"}]}], "\[IndentingNewLine]", 
            "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Omega]", ",", "\[Nu]", ",", "S", ",", "R", ",", "dR", ",", 
            "ddR"}], "}"}], "->", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{
            "\[Omega]v", ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t\t",
              "\[Nu]v", ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t\t", 
             "Sv", ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t\t", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Rv", "[", 
                RowBox[{"RadialToHorizonCoord", "[", 
                 RowBox[{"#", ",", "\[Chi]v"}], "]"}], "]"}], "&"}], ")"}], 
             ",", " ", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t\t", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["Rv", "\[Prime]"], "[", 
                  RowBox[{"RadialToHorizonCoord", "[", 
                   RowBox[{"#", ",", "\[Chi]v"}], "]"}], "]"}], "*", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"rplusN", "[", "\[Chi]v", "]"}], "-", 
                   RowBox[{"rminusN", "[", "\[Chi]v", "]"}]}]]}], ")"}], 
               "&"}], ")"}], ",", "\[IndentingNewLine]", 
             "\t\t\t\t\t\t\t\t\t\t\t", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   SuperscriptBox["Rv", "\[Prime]"], "\[Prime]"], "[", 
                  RowBox[{"RadialToHorizonCoord", "[", 
                   RowBox[{"#", ",", "\[Chi]v"}], "]"}], "]"}], "*", 
                 FractionBox["1", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rplusN", "[", "\[Chi]v", "]"}], "-", 
                    RowBox[{"rminusN", "[", "\[Chi]v", "]"}]}], ")"}], 
                   "2"]]}], ")"}], "&"}], ")"}]}], "\[IndentingNewLine]", 
            "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
          "Dont", " ", "forgot", " ", "to", " ", "convert", " ", "radial", 
           " ", "function", " ", "from", " ", "horizon", " ", "co"}], "-", 
          RowBox[{"ordinates", " ", "to", " ", "Boyer"}], "-", 
          RowBox[{"Lindquist", " ", "radial", " ", 
           RowBox[{"coordinates", "!"}], " ", "Polarization", " ", "tensor", 
           " ", "is", " ", "in", " ", "terms", " ", "of", " ", "radial", " ", 
           "coordinates"}]}], ",", " ", 
         RowBox[{
         "so", " ", "we", " ", "must", " ", "match", " ", "the", " ", 
          "arguments", " ", "for", " ", "the", " ", "Z", " ", "fkks", " ", 
          RowBox[{"function", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToParamSymbols", ":=", 
    RowBox[{"{", 
     RowBox[{"a", "->", "\[Chi]"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ApplySolutionSet", "[", 
      RowBox[{"solution_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{"real", "->", "False"}], "}"}], "]"}]}], "]"}], "[", "expr_",
      "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"expr", "/.", "ToParamSymbols"}], "/.", 
      RowBox[{"ParamsToReprRule", "[", "solution", "]"}]}], "/.", 
     RowBox[{"SolToReprRule", "[", 
      RowBox[{"solution", ",", 
       RowBox[{"real", "->", 
        RowBox[{"OptionValue", "[", "real", "]"}]}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimizedFunction", "[", 
    RowBox[{"vars_", ",", " ", "expr_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"WithProperties", "->", "True"}], ",", 
        RowBox[{"ToCompiled", "->", "False"}], ",", 
        RowBox[{"OptimizationSymbol", "->", "aa"}], ",", " ", 
        "Experimental`OptimizeExpression", ",", " ", "Compile"}], "}"}], 
      "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "exproe", ",", " ", "res", ",", "ret"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"exproe", " ", "=", " ", 
       RowBox[{"Experimental`OptimizeExpression", "[", 
        RowBox[{"expr", ",", "\[IndentingNewLine]", 
         RowBox[{"ExcludedForms", "->", 
          RowBox[{"OptionValue", "[", "ExcludedForms", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ExternalForms", "->", 
          RowBox[{"OptionValue", "[", "ExternalForms", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"InertForms", "->", 
          RowBox[{"OptionValue", "[", "InertForms", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"OptimizationLevel", "->", 
          RowBox[{"OptionValue", "[", "OptimizationLevel", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"OptimizationSymbol", "->", 
          RowBox[{"OptionValue", "[", "OptimizationSymbol", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ScopingSymbol", "->", 
          RowBox[{"OptionValue", "[", "ScopingSymbol", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"exproe", "/.", 
        RowBox[{
         RowBox[{"Experimental`OptimizedExpression", "[", "f_", "]"}], ":>", 
         RowBox[{"Function", "@@", 
          RowBox[{"Hold", "[", 
           RowBox[{"vars", ",", " ", "f"}], "]"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "ToCompiled", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"resc", " ", "=", " ", "res"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rett", " ", "=", " ", 
             RowBox[{"Hold", "[", 
              RowBox[{"vars", ",", " ", 
               RowBox[{"resc", "@@", "vars"}], ",", " ", 
               RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
               " ", 
               RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", " ", 
               RowBox[{"Parallelization", "->", "True"}], ",", " ", 
               RowBox[{"CompilationOptions", "->", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<ExpressionOptimization\>\"", " ", "->", " ", "True"}], 
                 "}"}]}], ",", " ", 
               RowBox[{"RuntimeAttributes", "->", 
                RowBox[{"{", "Listable", "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"InterpolatingFunction", "[", "_", "]"}], "[", "_",
                    "]"}], ",", " ", "_Complex"}], "}"}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"ret", " ", "=", " ", 
             RowBox[{"Compile", "@@", "rett"}]}]}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "ret", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "WithProperties", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"some", " ", 
          RowBox[{
           RowBox[{"DownValue", "/", "OwnValue"}], "/", "ModuleNumber"}], " ",
           "fuckery", " ", "lies", " ", "below"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"**", 
          RowBox[{
          "*", "Assign", " ", "the", " ", "OwnValue", " ", "of", " ", "res", 
           " ", "into", " ", "the", " ", "DownValue", " ", "of", " ", "the", 
           " ", "unique", " ", "GLOBAL", " ", "variable", " ", "defined", " ",
            "by", " ", 
           RowBox[{
            RowBox[{"Unique", "[", "OptimizedFunction", "]"}], ".", " ", 
            "Create"}], " ", "a", " ", "further", " ", "downvalue", " ", "of",
            " ", "this", " ", "unique", " ", "variable"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"**", 
           RowBox[{"*", 
            RowBox[{"ret", "[", "Properties", "]"}], " ", "downvalue", " ", 
            "tells", " ", "us", " ", "the", " ", "variable", " ", "assigned", 
            " ", "to", " ", "the", " ", "output", " ", "of", " ", 
            "OptimizedFunction", " ", 
            RowBox[{"(", 
             RowBox[{"this", " ", "function"}], ")"}], " ", "is", " ", "an", 
            " ", "optimized", " ", 
            RowBox[{"expression", ".", " ", "Used"}], " ", "later"}]}], 
          "..."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", " ", "=", " ", 
          RowBox[{"Unique", "[", "OptimizedFunction", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rett", " ", "=", " ", "ret"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"DownValues", "[", 
              RowBox[{"Evaluate", "@", "rett"}], "]"}], "=", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"OwnValues", "[", "res", "]"}], "/.", 
                  RowBox[{
                   RowBox[{"HoldPattern", "[", "res", "]"}], "->", 
                   RowBox[{"rett", "[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Pattern", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "@", 
                    RowBox[{"vars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", "_"}], "]"}], "?", 
                    "NumericQ"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], 
                    "]"}]}]}], "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"HoldPattern", "[", 
                   RowBox[{"Function", "[", 
                    RowBox[{"\[Zeta]_", ",", "\[Xi]_"}], "]"}], "]"}], ":>", 
                  "\[Xi]"}]}], ",", " ", 
                RowBox[{
                 RowBox[{"Evaluate", "@", 
                  RowBox[{"HoldPattern", "[", 
                   RowBox[{"rett", "[", "Properties", "]"}], "]"}]}], ":>", 
                 "Optimized"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", 
             RowBox[{"Evaluate", "[", "rett", "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DetMet", "[", 
    RowBox[{"r_", ",", "\[Theta]_", ",", "\[Chi]_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["\[Chi]", "2"], "*", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], "2"]}], "*", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ErgoRadius", "[", 
     RowBox[{"\[Theta]_", ",", "\[Chi]_", ",", " ", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{"coords", "->", "BL"}], "}"}], "]"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"TrueQ", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "coords", "]"}], "==", "BL"}], "]"}], ",", 
      RowBox[{"1", "+", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["\[Chi]", "2"], "*", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "coords", "]"}], "==", "Horizon"}], 
         "]"}], ",", 
        RowBox[{"RadialToHorizonCoord", "[", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", 
             RowBox[{
              SuperscriptBox["\[Chi]", "2"], "*", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], "]"}]}], ",", 
          "\[Chi]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<Coords must be either BL (boyer-lindquist) or Horizon\>\"", 
         "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RadialMesh", "::", "usage"}], " ", "=", " ", 
   "\"\<Generate mesh which is denser in the region near rstart and sparse \
near rstop. Density function is determined by last argument, with default (\!\
\(\*SuperscriptBox[\(#\), \(2\)]\)&).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RadialMesh", "[", 
    RowBox[{"rstart_", ",", "rstop_", ",", "points_", ",", " ", 
     RowBox[{"densityfunc_", ":", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        SuperscriptBox["x", "2"]}], "]"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", " ", "=", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           RowBox[{"densityfunc", "[", "rstop", "]"}], "-", 
           RowBox[{"densityfunc", "[", "rstart", "]"}]}]}], 
         RowBox[{"rstop", "-", "rstart"}]]}], ",", " ", 
       RowBox[{"b", "=", " ", 
        FractionBox[
         RowBox[{
          RowBox[{"rstop", " ", 
           RowBox[{"densityfunc", "[", "rstart", "]"}]}], "-", 
          RowBox[{"rstart", " ", 
           RowBox[{"densityfunc", "[", "rstop", "]"}]}]}], 
         RowBox[{" ", 
          RowBox[{
           RowBox[{"densityfunc", "[", "rstart", "]"}], "-", " ", 
           RowBox[{"densityfunc", "[", "rstop", "]"}]}]}]]}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"densityfunc", "[", "i", "]"}], "c"], "+", "b"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "rstart", ",", " ", "rstop", ",", 
         FractionBox[
          RowBox[{"rstop", "-", "rstart"}], "points"]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ThetaMesh", "[", 
   RowBox[{"\[Theta]start_", ",", "\[Theta]stop_", ",", " ", "points_"}], 
   "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{"i", ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "\[Theta]start", ",", " ", "\[Theta]stop", ",", 
      RowBox[{"N", "@", 
       FractionBox[
        RowBox[{"\[Theta]stop", "-", "\[Theta]start"}], "points"]}]}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhiMesh", "[", 
   RowBox[{"\[Phi]start_", ",", " ", "\[Phi]stop_", ",", " ", "points_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{"i", ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "\[Phi]start", ",", " ", "\[Phi]stop", ",", 
      RowBox[{"N", "@", 
       FractionBox[
        RowBox[{"\[Phi]stop", "-", "\[Phi]start"}], "points"]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TwoDMesh", "[", 
   RowBox[{
   "rstart_", ",", "rstop_", ",", "\[Theta]start_", ",", "\[Theta]stop_", ",",
     " ", "rpoints_", ",", "\[Theta]points_", ",", 
    RowBox[{"densityfunc_", ":", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["#", "4"], "&"}], ")"}]}]}], "]"}], ":=", 
  RowBox[{"SparseArray", "@", 
   RowBox[{"Tuples", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RadialMesh", "[", 
       RowBox[{
       "rstart", ",", " ", "rstop", ",", " ", "rpoints", ",", " ", 
        "densityfunc"}], "]"}], ",", 
      RowBox[{"ThetaMesh", "[", 
       RowBox[{"\[Theta]start", ",", "\[Theta]stop", ",", "\[Theta]points"}], 
       "]"}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ThreeDMesh", "[", 
    RowBox[{
    "rstart_", ",", "rstop_", ",", "\[Theta]start_", ",", "\[Theta]stop_", 
     ",", "\[Phi]start_", ",", " ", "\[Phi]stop_", ",", "  ", "rpoints_", ",",
      "\[Theta]points_", ",", "\[Phi]points_", ",", " ", 
     RowBox[{"densityfunc_", ":", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["#", "4"], "&"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"SparseArray", "@", 
    RowBox[{"Tuples", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RadialMesh", "[", 
        RowBox[{
        "rstart", ",", " ", "rstop", ",", " ", "rpoints", ",", " ", 
         "densityfunc"}], "]"}], ",", 
       RowBox[{"ThetaMesh", "[", 
        RowBox[{"\[Theta]start", ",", "\[Theta]stop", ",", "\[Theta]points"}],
         "]"}], ",", " ", 
       RowBox[{"PhiMesh", "[", 
        RowBox[{
        "\[Phi]start", ",", " ", "\[Phi]stop", ",", " ", "\[Phi]points"}], 
        "]"}]}], "}"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Generate2DInterpolation", "[", 
    RowBox[{
    "func_", ",", "rstart_", ",", "rstop_", ",", "\[Theta]start_", ",", 
     "\[Theta]stop_", ",", " ", "rpoints_", ",", "\[Theta]points_", ",", 
     RowBox[{"densityfunc_", ":", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["#", "4"], "&"}], ")"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dom", ",", " ", "funcEval"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dom", " ", "=", " ", 
       RowBox[{"TwoDMesh", "[", 
        RowBox[{
        "rstart", ",", " ", "rstop", ",", " ", "\[Theta]start", ",", " ", 
         "\[Theta]stop", ",", " ", "rpoints", ",", " ", "\[Theta]points", ",",
          " ", "densityfunc"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"funcEval", " ", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"func", "[", 
           RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], ",", "dom"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"dom", ",", "funcEval"}], "}"}], "]"}], "]"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Generate3DInterpolation", "::", "usage"}], "=", 
   "\"\<Generate interpolation function for a 3D function evaluated over a \
Mesh. \n\n\
Generate3DInterpolation[func_,rstart_,rstop_,\[Theta]start_,\[Theta]stop_,\
\[Phi]start_, \[Phi]stop_, \
rpoints_,\[Theta]points_,\[Phi]points_,densityfunc_:(\!\(\*SuperscriptBox[\(#\
\), \(4\)]\)&)]\n\ndensityfunc specifies how dense the mesh should be in the \
radial direction. The reciprocal of the derivative of the density function \
determines the density of points, i.e. smaller values of \
\!\(\*SuperscriptBox[\(f\), \(\[Prime]\)]\) map to larger values of density. \
Note, the total number of points is conserved.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Generate3DInterpolation", "[", 
    RowBox[{
    "func_", ",", "rstart_", ",", "rstop_", ",", "\[Theta]start_", ",", 
     "\[Theta]stop_", ",", "\[Phi]start_", ",", " ", "\[Phi]stop_", ",", " ", 
     "rpoints_", ",", "\[Theta]points_", ",", "\[Phi]points_", ",", 
     RowBox[{"densityfunc_", ":", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["#", "4"], "&"}], ")"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "functionOnPoints", ",", "\[IndentingNewLine]", "NewRadialPoint", ",", 
       "\[IndentingNewLine]", "dom", ",", "\[IndentingNewLine]", 
       "isOptimized", ",", "\[IndentingNewLine]", "Messenger", ",", 
       "\[IndentingNewLine]", "retval", ",", "\[IndentingNewLine]", "funcOE", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"$MaxExtraPrecision", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           RowBox[{"densityfunc", "[", "rstop", "]"}], "-", 
           RowBox[{"densityfunc", "[", "rstart", "]"}]}]}], 
         RowBox[{"rstop", "-", "rstart"}]]}], ",", " ", 
       RowBox[{"b", "=", " ", 
        FractionBox[
         RowBox[{
          RowBox[{"rstop", " ", 
           RowBox[{"densityfunc", "[", "rstart", "]"}]}], "-", 
          RowBox[{"rstart", " ", 
           RowBox[{"densityfunc", "[", "rstop", "]"}]}]}], 
         RowBox[{" ", 
          RowBox[{
           RowBox[{"densityfunc", "[", "rstart", "]"}], "-", " ", 
           RowBox[{"densityfunc", "[", "rstop", "]"}]}]}]]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "This", " ", "function", " ", "increases", " ", "the", " ", "density", 
        " ", "of", " ", "points", " ", "near", " ", "rstart"}], ",", " ", 
       RowBox[{
       "accompanied", " ", "by", " ", "a", " ", "decrease", " ", "near", " ", 
        "rstop", " ", "such", " ", "that", " ", "rpoints", " ", "is", " ", 
        RowBox[{"conserved", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"NewRadialPoint", "[", "i_", "]"}], ":=", 
       RowBox[{
        FractionBox[
         RowBox[{"densityfunc", "[", "i", "]"}], "c"], "+", "b"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dom", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NewRadialPoint", "[", "r", "]"}], ",", "\[Theta]", ",", 
             "\[Phi]"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"r", ",", "rstart", ",", "rstop", ",", 
             FractionBox[
              RowBox[{"rstop", "-", "rstart"}], "rpoints"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\[Theta]", ",", "\[Theta]start", ",", "\[Theta]stop", ",", 
             FractionBox[
              RowBox[{"\[Theta]stop", "-", "\[Theta]start"}], 
              "\[Theta]points"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "\[Phi]start", ",", "\[Phi]stop", ",", 
             FractionBox[
              RowBox[{"\[Phi]stop", "-", "\[Phi]start"}], "\[Phi]points"]}], 
            "}"}]}], "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Was", " ", "func", " ", "generated", " ", "from", " ", 
         RowBox[{"OptimizeFunction", "?", " ", "Kind"}], " ", "of", " ", "a", 
         " ", "hacky", " ", "way", " ", "of", " ", "checking"}], "..."}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"isOptimized", " ", "=", "  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "==", "Function"}], "]"}], ",",
          " ", "False", ",", " ", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tmpfunc$", "=", 
             RowBox[{"Evaluate", "[", "func", "]"}]}], "}"}], ",", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DownValues", "[", "tmpfunc$", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Verbatim", "@", 
              RowBox[{"HoldPattern", "[", 
               RowBox[{"tmpfunc$", "[", "Properties", "]"}], "]"}]}]}], 
            "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Messenger", " ", "=", " ", 
       RowBox[{"Unique", "[", "Messenger", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"Dynamic", "[", "Messenger", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ParallelEvaluate", "[", 
       RowBox[{"$MaxExtraPrecision", "=", "1000"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ParallelEvaluate", "[", 
       RowBox[{"Off", "[", 
        RowBox[{"N", "::", "meprec"}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "==", "Symbol"}], ")"}], "&&", 
         "isOptimized"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Messenger", "=", "\"\<Mapping function over mesh\>\""}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"functionOnPoints", " ", "=", " ", 
          RowBox[{"ParallelMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"func", "@@", "#"}], "]"}], "&"}], ",", "dom"}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Messenger", "=", "\"\<Optimizing function\>\""}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"funcOE", " ", "=", " ", 
          RowBox[{"OptimizedFunction", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", " ", 
            RowBox[{"func", "[", 
             RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Messenger", "=", "\"\<Mapping function over mesh\>\""}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"functionOnPoints", " ", "=", " ", 
          RowBox[{"ParallelMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"funcOE", "@@", "#"}], "]"}], "&"}], ",", "dom"}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Messenger", "=", "\"\<Generating interpolation function\>\""}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"retval", " ", "=", " ", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"dom", ",", " ", "functionOnPoints"}], "}"}], "]"}], "]"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "retval", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"complexToRealReprRule", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "[", "\[Epsilon]_", "]"}], ":>", 
      RowBox[{
       RowBox[{"Rr", "[", "\[Epsilon]", "]"}], "+", 
       RowBox[{"I", "*", 
        RowBox[{"Ri", "[", "\[Epsilon]", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["R", "\[Prime]"], "[", "\[Epsilon]_", "]"}], ":>", 
      RowBox[{
       RowBox[{
        SuperscriptBox["Rr", "\[Prime]"], "[", "\[Epsilon]", "]"}], "+", 
       RowBox[{"I", "*", 
        RowBox[{
         SuperscriptBox["Ri", "\[Prime]"], "[", "\[Epsilon]", "]"}]}]}]}], 
     ",", 
     RowBox[{
      RowBox[{"S", "[", "t_", "]"}], ":>", 
      RowBox[{
       RowBox[{"Sr", "[", "t", "]"}], "+", 
       RowBox[{"I", "*", 
        RowBox[{"Si", "[", "t", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["S", "\[Prime]"], "[", "t_", "]"}], ":>", 
      RowBox[{
       RowBox[{
        SuperscriptBox["Sr", "\[Prime]"], "[", "t", "]"}], "+", 
       RowBox[{"I", "*", 
        RowBox[{
         SuperscriptBox["Si", "\[Prime]"], "[", "t", "]"}]}]}]}], ",", " ", 
     RowBox[{"\[Omega]", ":>", 
      RowBox[{"\[Omega]r", "+", 
       RowBox[{"I", "*", "\[Omega]i"}]}]}], ",", " ", 
     RowBox[{"\[Nu]", ":>", 
      RowBox[{"\[Nu]r", "+", 
       RowBox[{"I", "*", "\[Nu]i"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"killImagTerms", " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{"Rr", "[", "\[Epsilon]_", "]"}], "]"}], ":>", "0"}], ",", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{"Ri", "[", "\[Epsilon]_", "]"}], "]"}], ":>", "0"}], ",", 
      "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"Rr", "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{"Rr", "[", "\[Epsilon]", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"Ri", "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{"Ri", "[", "\[Epsilon]", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{
         SuperscriptBox["Rr", "\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       "0"}], ",", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{
         SuperscriptBox["Ri", "\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       "0"}], ",", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         SuperscriptBox["Rr", "\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{
        SuperscriptBox["Rr", "\[Prime]",
         MultilineFunction->None], "[", "\[Epsilon]", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         SuperscriptBox["Ri", "\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{
        SuperscriptBox["Ri", "\[Prime]",
         MultilineFunction->None], "[", "\[Epsilon]", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{
         SuperscriptBox["Rr", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       "0"}], ",", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{
         SuperscriptBox["Ri", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], "->", 
       "0"}], ",", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         SuperscriptBox["Rr", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{
        SuperscriptBox["Rr", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "\[Epsilon]", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         SuperscriptBox["Ri", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{
        SuperscriptBox["Ri", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "\[Epsilon]", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{"Sr", "[", "\[Epsilon]_", "]"}], "]"}], ":>", "0"}], ",", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{"Si", "[", "\[Epsilon]_", "]"}], "]"}], ":>", "0"}], ",", 
      "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"Sr", "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{"Sr", "[", "\[Epsilon]", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"Si", "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{"Si", "[", "\[Epsilon]", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{
         SuperscriptBox["Sr", "\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       "0"}], ",", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{
         SuperscriptBox["Si", "\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       "0"}], ",", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         SuperscriptBox["Sr", "\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{
        SuperscriptBox["Sr", "\[Prime]",
         MultilineFunction->None], "[", "\[Epsilon]", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         SuperscriptBox["Si", "\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{
        SuperscriptBox["Si", "\[Prime]",
         MultilineFunction->None], "[", "\[Epsilon]", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{
         SuperscriptBox["Sr", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       "0"}], ",", 
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{
         SuperscriptBox["Si", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], "->", 
       "0"}], ",", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         SuperscriptBox["Sr", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{
        SuperscriptBox["Sr", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "\[Epsilon]", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         SuperscriptBox["Si", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "\[Epsilon]_", "]"}], "]"}], ":>", 
       RowBox[{
        SuperscriptBox["Si", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "\[Epsilon]", "]"}]}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyRealSolutionSet", "[", "solution_", "]"}], "[", "expr_", 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "repr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"repr", " ", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Omega]r", ",", "\[Omega]i"}], "}"}], "->", 
           RowBox[{"ReIm", "[", 
            RowBox[{"solution", "[", 
             RowBox[{"\"\<Solution\>\"", ",", "\"\<\[Omega]\>\""}], "]"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Nu]r", ",", "\[Nu]i"}], "}"}], "->", 
           RowBox[{"ReIm", "[", 
            RowBox[{"solution", "[", 
             RowBox[{"\"\<Solution\>\"", ",", "\"\<\[Nu]\>\""}], "]"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          SuperscriptBox["Rr", "\[Prime]\[Prime]"], "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Re", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"solution", "[", 
                 RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}], 
                "\[Prime]\[Prime]"], "[", "#", "]"}], "]"}]}], "&"}], ")"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          SuperscriptBox["Ri", "\[Prime]\[Prime]"], "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Im", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"solution", "[", 
                 RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}], 
                "\[Prime]\[Prime]"], "[", "#", "]"}], "]"}]}], "&"}], ")"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          SuperscriptBox["Sr", "\[Prime]\[Prime]"], "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Re", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"solution", "[", 
                 RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}], 
                "\[Prime]\[Prime]"], "[", "#", "]"}], "]"}]}], "&"}], ")"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          SuperscriptBox["Si", "\[Prime]\[Prime]"], "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Im", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"solution", "[", 
                 RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}], 
                "\[Prime]\[Prime]"], "[", "#", "]"}], "]"}]}], "&"}], ")"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          SuperscriptBox["Rr", "\[Prime]"], "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Re", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"solution", "[", 
                 RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}], 
                "\[Prime]"], "[", "#", "]"}], "]"}]}], "&"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          SuperscriptBox["Ri", "\[Prime]"], "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Im", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"solution", "[", 
                 RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}], 
                "\[Prime]"], "[", "#", "]"}], "]"}]}], "&"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          SuperscriptBox["Sr", "\[Prime]"], "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Re", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"solution", "[", 
                 RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}], 
                "\[Prime]"], "[", "#", "]"}], "]"}]}], "&"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          SuperscriptBox["Si", "\[Prime]"], "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Im", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"solution", "[", 
                 RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}], 
                "\[Prime]"], "[", "#", "]"}], "]"}]}], "&"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Rr", "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"solution", "[", 
                RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}], "[", 
               "#", "]"}], "]"}]}], "&"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Ri", "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Im", "[", 
              RowBox[{
               RowBox[{"solution", "[", 
                RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}], "[", 
               "#", "]"}], "]"}]}], "&"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Sr", "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"solution", "[", 
                RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}], "[", 
               "#", "]"}], "]"}]}], "&"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Si", "->", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Im", "[", 
              RowBox[{
               RowBox[{"solution", "[", 
                RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}], "[", 
               "#", "]"}], "]"}]}], "&"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Chi]", "->", 
          RowBox[{"solution", "[", 
           RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"m", "->", " ", 
          RowBox[{"solution", "[", 
           RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]Nv", "->", 
          RowBox[{"solution", "[", 
           RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], 
           "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"expr", "/.", "repr"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8647722131139297`*^9, 3.8647723018369303`*^9}, {
   3.86477312642647*^9, 3.864773136013356*^9}, {3.8648657895181227`*^9, 
   3.86486579503369*^9}, {3.865554431456584*^9, 3.865554431796541*^9}, {
   3.865557144165103*^9, 3.865557177024708*^9}, {3.8655614795464907`*^9, 
   3.865561496261003*^9}, {3.8655616169964046`*^9, 3.865561636315132*^9}, {
   3.865562729506969*^9, 3.865562757225689*^9}, {3.865562809815724*^9, 
   3.8655628208599997`*^9}, {3.865563014857462*^9, 3.865563075635665*^9}, {
   3.865563198482624*^9, 3.865563226218135*^9}, {3.865568374454468*^9, 
   3.865568378551506*^9}, {3.865568421515533*^9, 3.865568517706623*^9}, {
   3.865568620233039*^9, 3.8655686912561502`*^9}, {3.865573681544426*^9, 
   3.865573711469841*^9}, {3.865576350122726*^9, 3.865576367235565*^9}, {
   3.86563826363375*^9, 3.865638314332677*^9}, {3.865638503750749*^9, 
   3.8656385560265207`*^9}, {3.865638604325055*^9, 3.8656386064058723`*^9}, {
   3.8656387472895727`*^9, 3.8656388218586206`*^9}, {3.865639176559461*^9, 
   3.8656391775711184`*^9}, {3.865647266751196*^9, 3.865647271589467*^9}, {
   3.865648501375649*^9, 3.86564851191521*^9}, {3.865648621743298*^9, 
   3.8656486288526993`*^9}, 3.865648729334749*^9, 3.865649226139333*^9, {
   3.865649271523086*^9, 3.865649297678475*^9}, {3.865650164953689*^9, 
   3.865650338480486*^9}, {3.865650514469988*^9, 3.865650557966329*^9}, {
   3.86565058811488*^9, 3.865650657091485*^9}, {3.8656508447251253`*^9, 
   3.8656508569678288`*^9}, {3.865650985132105*^9, 3.865650986142901*^9}, {
   3.865929961494289*^9, 3.8659299619083242`*^9}, 3.8659506876739187`*^9, {
   3.866042536023047*^9, 3.866042536298633*^9}, 3.86604450506501*^9, {
   3.866080027169387*^9, 3.866080064709446*^9}, {3.866080901882647*^9, 
   3.8660809512951527`*^9}, {3.866083419265841*^9, 3.866083459285153*^9}, {
   3.8661663404741287`*^9, 3.866166340785205*^9}, {3.8661744107287397`*^9, 
   3.8661745000674477`*^9}, {3.866182160327726*^9, 3.866182176640799*^9}, {
   3.86618253746529*^9, 3.8661825672300386`*^9}, {3.866182729341367*^9, 
   3.866182743441587*^9}, {3.8661828122875137`*^9, 3.866182814911824*^9}, {
   3.866183464547266*^9, 3.8661834786128798`*^9}, {3.866186092366823*^9, 
   3.8661861589970617`*^9}, {3.8661861910526047`*^9, 3.866186221937187*^9}, 
   3.866187479339046*^9, {3.866191855660068*^9, 3.866191921517276*^9}, {
   3.8662106007535954`*^9, 3.866210646459893*^9}, {3.866210750342482*^9, 
   3.866210750540698*^9}, {3.8662107817869263`*^9, 3.8662108338417253`*^9}, {
   3.866210885972282*^9, 3.8662108932368317`*^9}, 3.866210934554883*^9, {
   3.866210965126602*^9, 3.866210966804253*^9}, {3.866211055804803*^9, 
   3.866211075695615*^9}, {3.866211108260607*^9, 3.866211108891004*^9}, {
   3.866211149734099*^9, 3.866211230594441*^9}, {3.8662113364920473`*^9, 
   3.866211365556822*^9}, {3.8662116030302963`*^9, 3.866211643839428*^9}, 
   3.8662118454987307`*^9, {3.866211904335129*^9, 3.8662119081517973`*^9}, {
   3.866212088873239*^9, 3.86621209684374*^9}, {3.866212358335312*^9, 
   3.866212361678873*^9}, {3.8662126031317177`*^9, 3.8662126192708807`*^9}, 
   3.866246080136907*^9, {3.866246128691875*^9, 3.866246136346999*^9}, 
   3.866248804723798*^9, {3.866250161217876*^9, 3.866250162340838*^9}, 
   3.866251303278288*^9, 3.86625183997114*^9, {3.866253667576915*^9, 
   3.866253738075253*^9}, {3.866253782455764*^9, 3.866253855895708*^9}, {
   3.866254211784224*^9, 3.866254225125485*^9}, {3.866257403077015*^9, 
   3.866257405582178*^9}, {3.866258999362711*^9, 3.8662590040092382`*^9}, {
   3.866259052406827*^9, 3.866259073069161*^9}, {3.866259125450972*^9, 
   3.8662591527168922`*^9}, {3.866263655588554*^9, 3.866263659007859*^9}, {
   3.8662796445895033`*^9, 3.866279651412259*^9}, {3.86637177138033*^9, 
   3.8663718216158533`*^9}, {3.86650919171205*^9, 3.8665092232834177`*^9}, {
   3.866509320883972*^9, 3.866509350213337*^9}, {3.866510423821384*^9, 
   3.866510445545556*^9}, {3.866510496259816*^9, 3.866510571286858*^9}, {
   3.866511145754678*^9, 3.86651116473602*^9}, {3.8665113124071503`*^9, 
   3.8665113213854237`*^9}, {3.866511665208444*^9, 3.866511665980394*^9}, {
   3.86651509719805*^9, 3.8665150999037724`*^9}, {3.8665167192376547`*^9, 
   3.866516745229939*^9}, {3.866516938272387*^9, 3.866516973496196*^9}, {
   3.866517175615321*^9, 3.866517206349629*^9}, {3.8665178375378523`*^9, 
   3.866517880389214*^9}, {3.8665179155475082`*^9, 3.866517920788062*^9}, {
   3.866517951504459*^9, 3.866517986658389*^9}, {3.866518039199538*^9, 
   3.8665180394972*^9}, {3.866518080102643*^9, 3.866518125368287*^9}, {
   3.866518201733549*^9, 3.866518221006871*^9}, {3.866518663938962*^9, 
   3.8665187880490427`*^9}, {3.8665205905881853`*^9, 
   3.8665206011169767`*^9}, {3.866520846447908*^9, 3.866520847443898*^9}, {
   3.866521134622817*^9, 3.8665211699305573`*^9}, {3.866521205652575*^9, 
   3.866521220638792*^9}, {3.8665212622858953`*^9, 3.866521265381981*^9}, {
   3.86652193278297*^9, 3.8665219422870703`*^9}, {3.8665221736885147`*^9, 
   3.8665221741752243`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"4cb08ff2-d5f8-4ad8-b3d2-b251346f9fe5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculations", "Chapter",
 CellChangeTimes->{{3.86477246720536*^9, 
  3.864772468619419*^9}},ExpressionUUID->"3e87b444-f4f6-46d3-b15b-\
bd5440b2e4b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"analytic", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   SuperscriptBox["A", "\[Mu]"], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSProca", "[", 
    RowBox[{
     RowBox[{"solution_", ":", "analytic"}], ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SymbolicExpression", "->", "False"}], ",", " ", 
        RowBox[{"Optimized", "->", "False"}], ",", " ", 
        RowBox[{"RealPart", "->", "True"}]}], "}"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "res", ",", "tmp", ",", "gradZ", ",", "Z", ",", "A", ",", "Aupreal", 
       ",", " ", "AuprealComponents", ",", "Ar", ",", " ", "Filename", ",", 
       "Filenamecomps"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Filename", " ", "=", " ", "\"\<FKKSProcaRealCTensor.mx\>\""}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Filenamecomps", " ", "=", " ", "\"\<AuprealComponents.mx\>\""}], 
         ";"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Filename", " ", "=", " ", "\"\<FKKSProcaCTensor.mx\>\""}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Take", " ", "real", " ", "part"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ProcaFilePath", " ", "=", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", " ", 
                RowBox[{
                "$FKKSRoot", ",", "\"\<Expressions\>\"", ",", "Filename"}], 
                "}"}], "]"}]}], ",", 
             RowBox[{"ProcaComponentsFilePath", " ", "=", " ", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", " ", 
                RowBox[{
                "$FKKSRoot", ",", "\"\<Expressions\>\"", ",", 
                 "Filenamecomps"}], "}"}], "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", "procafile", " ", "exists"}], ",", " ", 
             RowBox[{"import", " ", "it"}], ",", " ", 
             RowBox[{"else", " ", "build", " ", "it"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileExistsQ", "[", "ProcaFilePath", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"res", " ", "=", " ", 
               RowBox[{"Import", "[", "ProcaFilePath", "]"}]}], ";"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "If", " ", "components", " ", "were", " ", "already", " ", 
                "calculated"}], ",", " ", 
               RowBox[{"import", " ", "it"}], ",", " ", 
               RowBox[{"else", " ", "calculate", " ", "them", " ", 
                RowBox[{"(", 
                 RowBox[{"WARNING", ":", " ", 
                  RowBox[{
                  "will", " ", "take", " ", "probably", " ", "20", " ", 
                   "mins"}]}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"FileExistsQ", "[", "ProcaComponentsFilePath", "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"AuprealComponents", " ", "=", " ", 
                  RowBox[{"Import", "[", "ProcaComponentsFilePath", "]"}]}], 
                 ";"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Z", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"R", "[", 
                    RowBox[{"r", "[", "]"}], "]"}], "*", 
                   RowBox[{"S", "[", 
                    RowBox[{"\[Theta]", "[", "]"}], "]"}], "*", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "I"}], "*", "\[Omega]", "*", 
                    RowBox[{"t", "[", "]"}]}], "]"}], "*", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"I", "*", "m", "*", 
                    RowBox[{"\[Phi]", "[", "]"}]}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"A", " ", "=", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Polarization", "[", 
                    RowBox[{"\[Xi]", ",", "\[Zeta]"}], "]"}], 
                    RowBox[{
                    RowBox[{"Cd", "[", 
                    RowBox[{"-", "\[Zeta]"}], "]"}], "@", "Z"}]}], ")"}], "//",
                     "ToBasisExpand"}], "//", "FromBasisExpand"}], "//", 
                   "Head"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"CloseKernels", "[", "]"}], ";", 
                 RowBox[{"LaunchKernels", "[", "4", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PrintTemporary", "@", 
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"ProcaMessenger", "//", "MatrixForm"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"ProcaMessenger", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"\"\<\>\"", ",", " ", "$KernelCount"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"ParallelEvaluate", "[", 
                  RowBox[{"Off", "[", 
                   RowBox[{"PrintAsCharacter", "::", "argx"}], "]"}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"KeyRule", " ", "=", " ", 
                  RowBox[{"ParallelTable", "[", 
                   RowBox[{
                    RowBox[{"$KernelID", "->", "i"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AuprealComponents", " ", "=", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"SetSharedVariable", "[", 
                  RowBox[{"ProcaMessenger", ",", "  ", "AuprealComponents"}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"DistributeDefinitions", "[", 
                  RowBox[{
                  "KeyRule", ",", "complexToRealReprRule", ",", " ", 
                   "killImagTerms", ",", "A", ",", 
                   "ProcaComponentsFilePath"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"ProcaMessenger", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", 
                    RowBox[{"(", 
                    RowBox[{"$KernelID", "/.", "KeyRule"}], ")"}]}], "]"}], 
                    "]"}], "=", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<Kernel \>\"", "<>", 
                    RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", 
                    "\"\< working on iteration \>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], ",", " ", 
                    RowBox[{"Spacer", "[", "20", "]"}], ",", " ", 
                    RowBox[{"ProgressIndicator", "[", 
                    RowBox[{"Appearance", "->", "\"\<Percolate\>\""}], 
                    "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AuprealComponents", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"A", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "//.", 
                    "complexToRealReprRule"}], "//", "Re"}], "//", 
                    "ComplexExpand"}], ")"}], "/.", "killImagTerms"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"TimeConstraint", "\[Rule]", "Infinity"}]}], 
                    "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ProcaMessenger", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", 
                    RowBox[{"(", 
                    RowBox[{"$KernelID", "/.", "KeyRule"}], ")"}]}], "]"}], 
                    "]"}], "=", 
                    RowBox[{"\"\<Kernel \>\"", "<>", 
                    RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", 
                    "\"\< done.\>\""}]}], ";"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                  "ProcaComponentsFilePath", ",", "AuprealComponents"}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ProcaMessenger", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", "+", 
                    RowBox[{"(", 
                    RowBox[{"$KernelID", "/.", "KeyRule"}], ")"}]}], "]"}], 
                   "]"}], "=", 
                  RowBox[{"\"\<Kernel \>\"", "<>", 
                   RowBox[{"ToString", "[", "$KernelID", "]"}], "<>", 
                   "\"\< Done.\>\""}]}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"DefTensor", "[", 
               RowBox[{
                RowBox[{"Ar", "[", "\[Zeta]", "]"}], ",", 
                "\[ScriptCapitalM]"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", "Print", "}"}], ",", 
                RowBox[{"ComponentValue", "[", 
                 RowBox[{
                  RowBox[{"ComponentArray", "[", 
                   RowBox[{"Ar", "[", 
                    RowBox[{"{", 
                    RowBox[{"\[Zeta]", ",", "sphericalchart"}], "}"}], "]"}], 
                   "]"}], ",", " ", "AuprealComponents"}], "]"}]}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"res", " ", "=", " ", 
               RowBox[{
                RowBox[{"ToCTensor", "[", 
                 RowBox[{"Ar", ",", " ", 
                  RowBox[{"{", "sphericalchart", "}"}]}], "]"}], "/.", 
                RowBox[{"TensorValues", "[", "Ar", "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{"ProcaFilePath", ",", "res"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Not", " ", "real", " ", "part"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ProcaFilePath", " ", "=", " ", 
             RowBox[{
             "$FKKSRoot", "<>", "\"\<Expressions/FKKSProcaCTensor.mx\>\""}]}],
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileExistsQ", "[", "ProcaFilePath", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"res", " ", "=", " ", 
               RowBox[{"Import", "[", "ProcaFilePath", "]"}]}], ";"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Z", " ", "=", " ", 
               RowBox[{
                RowBox[{"R", "[", 
                 RowBox[{"r", "[", "]"}], "]"}], "*", 
                RowBox[{"S", "[", 
                 RowBox[{"\[Theta]", "[", "]"}], "]"}], "*", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "I"}], "*", "\[Omega]", "*", 
                  RowBox[{"t", "[", "]"}]}], "]"}], "*", 
                RowBox[{"Exp", "[", 
                 RowBox[{"I", "*", "m", "*", 
                  RowBox[{"\[Phi]", "[", "]"}]}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"res", " ", "=", " ", 
               RowBox[{"Head", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Polarization", "[", 
                    RowBox[{"\[Zeta]", ",", "\[Xi]"}], "]"}], 
                   RowBox[{
                    RowBox[{"Cd", "[", 
                    RowBox[{"-", "\[Xi]"}], "]"}], "@", "Z"}]}], "//", 
                  "FromBasisExpand"}], "//", "Simplify"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{"ProcaFilePath", ",", "res"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"solution", "==", "analytic"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"res", "/.", "ToParamSymbols"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"res", "/.", "ToParamSymbols"}], "//", 
            "FromxActVariables"}], "//", 
           RowBox[{"ApplyRealSolutionSet", "[", "solution", "]"}]}]}], ";"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"res", "/.", "ToParamSymbols"}], "//", 
             "FromxActVariables"}], "//", "PrimedToSymbolic"}], "//", 
           RowBox[{"ApplySolutionSet", "[", "solution", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "SymbolicExpression", "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "tmp", "]"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "Optimized", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"OptimizedFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
           ",", " ", 
           RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "|->", 
        RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SuperscriptBox["A", "\[Mu]"], 
    SubscriptBox["A", "\[Mu]"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSProcaNorm", "[", 
    RowBox[{
     RowBox[{"solution_", ":", "analytic"}], ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SymbolicExpression", "->", "False"}], ",", " ", 
        RowBox[{"Optimized", "->", "False"}], ",", " ", 
        RowBox[{"RealPart", "->", "True"}]}], "}"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp", ",", "res", ",", "A", ",", " ", "Filename"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Filename", " ", "=", " ", "\"\<FKKSProcaNormReal.mx\>\""}], 
         ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Filename", " ", "=", " ", "\"\<FKKSProcaNorm.mx\>\""}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"FSFilePath", " ", "=", " ", 
          RowBox[{
          "$FKKSRoot", "<>", "\"\<Expressions/\>\"", "<>", "Filename"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FileExistsQ", "[", "FSFilePath", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"Import", "[", "FSFilePath", "]"}]}], ";"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"A", "=", 
            RowBox[{"FKKSProca", "[", 
             RowBox[{"analytic", ",", " ", 
              RowBox[{"RealPart", "->", 
               RowBox[{"OptionValue", "[", "RealPart", "]"}]}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"res", " ", "=", " ", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"-", "\[Zeta]"}], "]"}], 
             RowBox[{"A", "[", "\[Zeta]", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{"FSFilePath", ",", " ", "res"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Format", " ", "output", " ", "based", " ", "on", " ", "input", " ", 
        "arguments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"solution", "==", "analytic"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"res", "/.", "ToParamSymbols"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"res", "/.", "ToParamSymbols"}], "//", 
            "FromxActVariables"}], "//", 
           RowBox[{"ApplyRealSolutionSet", "[", "solution", "]"}]}]}], ";"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"res", "/.", "ToParamSymbols"}], "//", 
             "FromxActVariables"}], "//", "PrimedToSymbolic"}], "//", 
           RowBox[{"ApplySolutionSet", "[", "solution", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "SymbolicExpression", "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "tmp", "]"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "Optimized", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"OptimizedFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
           ",", " ", 
           RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "|->", 
        RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["F", "\[Mu]\[Nu]"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", "\[Mu]"], 
      SubscriptBox["A", "\[Nu]"]}], "-", 
     RowBox[{
      SubscriptBox["\[Del]", "\[Nu]"], 
      SubscriptBox["A", "\[Mu]"]}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSFieldStrength", "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SymbolicExpression", "->", "False"}], ",", " ", 
        RowBox[{"Optimized", "->", "False"}], ",", " ", 
        RowBox[{"RealPart", "->", "True"}]}], "}"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", "tmp", ",", "A", ",", "Filename"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Filename", " ", "=", " ", 
          "\"\<FKKSFieldStrengthRealCTensor.mx\>\""}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Filename", " ", "=", " ", "\"\<FKKSFieldStrengthCTensor.mx\>\""}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"FSFilePath", " ", "=", " ", 
          RowBox[{
          "$FKKSRoot", "<>", "\"\<Expressions/\>\"", "<>", "Filename"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FileExistsQ", "[", "FSFilePath", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"Import", "[", "FSFilePath", "]"}]}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"A", "=", 
            RowBox[{"FKKSProca", "[", 
             RowBox[{"analytic", ",", " ", 
              RowBox[{"RealPart", "->", 
               RowBox[{"OptionValue", "[", "RealPart", "]"}]}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"Head", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Cd", "[", 
                RowBox[{"-", "\[Zeta]"}], "]"}], "@", 
               RowBox[{"A", "[", 
                RowBox[{"-", "\[Xi]"}], "]"}]}], " ", "-", " ", 
              RowBox[{
               RowBox[{"Cd", "[", 
                RowBox[{"-", "\[Xi]"}], "]"}], "@", 
               RowBox[{"A", "[", 
                RowBox[{"-", "\[Zeta]"}], "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{"FSFilePath", ",", " ", "res"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Format", " ", "output", " ", "based", " ", "on", " ", "input", " ", 
        "arguments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"solution", "==", "analytic"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"res", "/.", "ToParamSymbols"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"res", "/.", "ToParamSymbols"}], "//", 
            "FromxActVariables"}], "//", 
           RowBox[{"ApplyRealSolutionSet", "[", "solution", "]"}]}]}], ";"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"res", "/.", "ToParamSymbols"}], "//", 
             "FromxActVariables"}], "//", "PrimedToSymbolic"}], "//", 
           RowBox[{"ApplySolutionSet", "[", "solution", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "SymbolicExpression", "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "tmp", "]"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "Optimized", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"OptimizedFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
           ",", " ", 
           RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "|->", 
        RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   SubscriptBox["\[ScriptCapitalT]", "\[Mu]\[Nu]"], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSEnergyMomentum", "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SymbolicExpression", "->", "False"}], ",", " ", 
        RowBox[{"Debug", "->", "False"}], ",", " ", 
        RowBox[{"Optimized", "->", "False"}], ",", " ", 
        RowBox[{"RealPart", "->", "True"}]}], "}"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", "tmp", ",", "tmp$", ",", " ", 
       RowBox[{"mass", " ", "=", " ", "\[Mu]Nv"}], ",", " ", "tmpOE", ",", 
       "F", ",", "A", ",", " ", "Filename"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Filename", " ", "=", " ", 
          "\"\<FKKSEnergyMomentumRealCTensor.mx\>\""}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Filename", " ", "=", " ", "\"\<FKKSEnergyMomentumCTensor.mx\>\""}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"EMFilePath", " ", "=", " ", 
          RowBox[{
          "$FKKSRoot", "<>", "\"\<Expressions/\>\"", "<>", "Filename"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FileExistsQ", "[", "EMFilePath", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"Import", "[", "EMFilePath", "]"}]}], ";"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"F", " ", "=", " ", 
            RowBox[{"FKKSFieldStrength", "[", 
             RowBox[{"analytic", ",", " ", 
              RowBox[{"RealPart", "->", 
               RowBox[{"OptionValue", "[", "RealPart", "]"}]}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"A", "=", 
            RowBox[{"FKKSProca", "[", 
             RowBox[{"analytic", ",", " ", 
              RowBox[{"RealPart", "->", 
               RowBox[{"OptionValue", "[", "RealPart", "]"}]}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"tmp$", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"F", "[", 
               RowBox[{
                RowBox[{"-", "\[Zeta]"}], ",", 
                RowBox[{"-", "\[Gamma]"}]}], "]"}], 
              RowBox[{"F", "[", 
               RowBox[{
                RowBox[{"-", "\[Xi]"}], ",", "\[Gamma]"}], "]"}]}], " ", "+", 
             " ", 
             RowBox[{
              SuperscriptBox["mass", "2"], "*", 
              RowBox[{"A", "[", 
               RowBox[{"-", "\[Zeta]"}], "]"}], 
              RowBox[{"A", "[", 
               RowBox[{"-", "\[Xi]"}], "]"}]}], " ", "-", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"met", "[", 
               RowBox[{
                RowBox[{"-", "\[Zeta]"}], ",", 
                RowBox[{"-", "\[Xi]"}]}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"F", "[", 
                  RowBox[{
                   RowBox[{"-", "\[Iota]"}], ",", 
                   RowBox[{"-", "\[Gamma]"}]}], "]"}], 
                 RowBox[{"F", "[", 
                  RowBox[{"\[Iota]", ",", "\[Gamma]"}], "]"}]}], " ", "+", 
                " ", 
                RowBox[{"2", "*", 
                 SuperscriptBox["mass", "2"], "*", 
                 RowBox[{"A", "[", 
                  RowBox[{"-", "\[Gamma]"}], "]"}], 
                 RowBox[{"A", "[", "\[Gamma]", "]"}]}]}], ")"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"res", "=", 
            RowBox[{"Evaluate", "@", 
             RowBox[{"Head", "[", "tmp$", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"TrueQ", "[", 
              RowBox[{
               RowBox[{"Head", "[", "res", "]"}], "!=", "CTensor"}], "]"}], 
             ",", 
             RowBox[{
             "Print", "[", "\"\<ERROR: Form of EM tensor incorrect\>\"", 
              "]"}], ",", 
             RowBox[{"Export", "[", 
              RowBox[{"EMFilePath", ",", "res"}], "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Format", " ", "output", " ", "based", " ", "on", " ", "input", " ", 
        "arguments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"solution", "==", "analytic"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"res", "/.", "ToParamSymbols"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"res", "/.", "ToParamSymbols"}], "/.", 
             RowBox[{"\[Omega]i", "->", "0"}]}], "//", "FromxActVariables"}], 
           "//", 
           RowBox[{"ApplyRealSolutionSet", "[", "solution", "]"}]}]}], ";"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"res", "/.", "ToParamSymbols"}], "//", 
             "FromxActVariables"}], "//", "PrimedToSymbolic"}], "//", 
           RowBox[{"ApplySolutionSet", "[", "solution", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "SymbolicExpression", "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "tmp", "]"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "Optimized", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"OptimizedFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
           ",", " ", 
           RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "|->", 
        RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"\[Rho]", " ", "==", " ", 
    SubscriptBox[
     SuperscriptBox["\[ScriptCapitalT]", "t"], "t"]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSEnergyDensity", "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SymbolicExpression", "->", "False"}], ",", 
        RowBox[{"Optimized", "->", "True"}], ",", 
        RowBox[{"ToCompiled", "->", "False"}], ",", " ", 
        RowBox[{"RealPart", "->", "True"}], " ", ",", " ", 
        RowBox[{"WithProperties", "->", "True"}], ",", 
        "Experimental`OptimizeExpression"}], "}"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "res", ",", " ", "resOE", ",", "T", ",", "OptimizedResult", ",", " ", 
       "tmp", ",", "UnOptimizedResult", ",", " ", "Filename"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Filename", " ", "=", " ", "\"\<FKKSEnergyDensityReal.mx\>\""}], 
         ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Filename", " ", "=", " ", "\"\<FKKSEnergyDensity.mx\>\""}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ENFilePath", " ", "=", 
          RowBox[{
          "$FKKSRoot", "<>", "\"\<Expressions/\>\"", "<>", "Filename"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "[", "ENFilePath", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"res", " ", "=", " ", 
             RowBox[{"Import", "[", "ENFilePath", "]"}]}], ";"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"T", " ", "=", " ", 
             RowBox[{"FKKSEnergyMomentum", "[", 
              RowBox[{"analytic", ",", " ", 
               RowBox[{"RealPart", "->", 
                RowBox[{"OptionValue", "[", "RealPart", "]"}]}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"res", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "*", 
               RowBox[{"T", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "sphericalchart"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "sphericalchart"}]}], "}"}]}], "]"}]}], "//", 
              "FromxActVariables"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Export", "[", 
             RowBox[{"ENFilePath", ",", " ", "res"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Format", " ", "output", " ", "based", " ", "on", " ", "input", " ", 
        "arguments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"solution", "==", "analytic"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"res", "/.", "ToParamSymbols"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"res", "/.", "ToParamSymbols"}], "/.", 
             RowBox[{"\[Omega]i", "->", "0"}]}], "//", "FromxActVariables"}], 
           "//", 
           RowBox[{"ApplyRealSolutionSet", "[", "solution", "]"}]}]}], ";"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"res", "/.", "ToParamSymbols"}], "//", 
             "FromxActVariables"}], "//", "PrimedToSymbolic"}], "//", 
           RowBox[{"ApplySolutionSet", "[", "solution", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "SymbolicExpression", "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "tmp", "]"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "Optimized", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "\[IndentingNewLine]", 
         RowBox[{"Evaluate", "@", 
          RowBox[{"OptimizedFunction", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
            ",", " ", 
            RowBox[{"Evaluate", "[", "tmp", "]"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"ToCompiled", "->", 
             RowBox[{"OptionValue", "[", "ToCompiled", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"WithProperties", "->", 
             RowBox[{"OptionValue", "[", "WithProperties", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ExcludedForms", "->", 
             RowBox[{"OptionValue", "[", "ExcludedForms", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ExternalForms", "->", 
             RowBox[{"OptionValue", "[", "ExternalForms", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InertForms", "->", 
             RowBox[{"OptionValue", "[", "InertForms", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"OptimizationLevel", "->", 
             RowBox[{"OptionValue", "[", "OptimizationLevel", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"OptimizationSymbol", "->", 
             RowBox[{"OptionValue", "[", "OptimizationSymbol", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ScopingSymbol", "->", 
             RowBox[{"OptionValue", "[", "ScopingSymbol", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "|->", 
        RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"E", " ", "=", " ", 
    RowBox[{"\[Integral]", 
     RowBox[{"\[Rho]", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{"-", "g"}], ")"}]}], "dV"}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSTotalEnergy", "[", "solution_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "TotalEnergyMessenger", ",", "energydensity", ",", "res", ",", " ", 
       "weight", ",", "integrationdomain", ",", " ", "integrand", ",", 
       "result", ",", "IntegrationErrors", ",", " ", 
       "energydensityInterpolation", ",", "tointerp", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Chi]", " ", "=", " ", 
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Radialdomain", " ", "=", " ", 
        RowBox[{"HorizonCoordToRadial", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"solution", "[", 
             RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}], "[", 
            "\"\<Domain\>\"", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"solution", "[", 
           RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], 
           "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PrintTemporary", "@", 
       RowBox[{"Dynamic", "[", "TotalEnergyMessenger", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TotalEnergyMessenger", " ", "=", " ", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<Computing energy density\>\"", ",", " ", 
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{"Appearance", "->", "\"\<Percolate\>\""}], "]"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"energydensity", " ", "=", " ", 
       RowBox[{"FKKSEnergyDensity", "[", "solution", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TotalEnergyMessenger", " ", "=", " ", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Generating interpolating function for energy density\>\"", ",", 
          " ", 
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{"Appearance", "->", "\"\<Percolate\>\""}], "]"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tointerp", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "|->", 
        RowBox[{"energydensity", "[", 
         RowBox[{"0", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"energydensityInterpolation", "=", 
       RowBox[{"Generate3DInterpolation", "[", 
        RowBox[{"tointerp", ",", 
         RowBox[{"Radialdomain", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         FractionBox[
          RowBox[{"Radialdomain", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "2"], ",", " ", 
         "\[Theta]\[Epsilon]", ",", " ", 
         RowBox[{"\[Pi]", "-", "\[Theta]\[Epsilon]"}], ",", "0", ",", 
         RowBox[{"2", "*", "\[Pi]"}], ",", " ", 
         RowBox[{"Radialdomain", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "\[Theta]points", ",", 
         " ", "\[Phi]points"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"weight", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "\[Theta]"}], "}"}], "|->", 
        RowBox[{"Kerrmetweight", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "\[Chi]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TotalEnergyMessenger", " ", "=", " ", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<Integrating energy density\>\"", ",", " ", 
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{"Appearance", "->", "\"\<Percolate\>\""}], "]"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"integrationdomain", " ", "=", " ", "Radialdomain"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"integrand", "[", 
        RowBox[{
         RowBox[{"r_", "?", "NumericQ"}], ",", " ", 
         RowBox[{"\[Theta]_", "?", "NumericQ"}], ",", " ", 
         RowBox[{"\[Phi]_", "?", "NumericQ"}]}], "]"}], ":=", 
       RowBox[{
        RowBox[{"energydensityInterpolation", "[", 
         RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "*", 
        RowBox[{"weight", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"integrand", "[", 
          RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"integrationdomain", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"integrationdomain", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"integrationdomain", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Exclude", " ", "r"}], "=", 
           SubscriptBox["r", "initial"]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\[Theta]", ",", "\[Theta]\[Epsilon]", ",", "\[Theta]\[Epsilon]", 
           ",", " ", 
           RowBox[{"\[Pi]", "-", "\[Theta]\[Epsilon]"}], ",", " ", 
           RowBox[{"\[Pi]", "-", "\[Theta]\[Epsilon]"}]}], "}"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"Exclude", " ", "\[Theta]"}], "=", "0"}], ",", "\[Pi]"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"MaxRecursion", "\[Rule]", "$MaxRecursion"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Method", "\[Rule]", "$NIntegrateMethod"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MinRecursion", "->", "$MinRecursion"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PrecisionGoal", "\[Rule]", "$NIntegratePrecision"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"IntegrationMonitor", ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"IntegrationErrors", "=", 
              RowBox[{"Through", "[", 
               RowBox[{"#1", "@", "\"\<Error\>\""}], "]"}]}], ")"}], "&"}], 
           ")"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "@", "Errors"}], ">", "0.01"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<ERROR: integration errors greater than 1%\>\"", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Total\>\"", "->", "res"}], ",", " ", 
         RowBox[{"\"\<Errors\>\"", "->", 
          RowBox[{"Total", "@", "IntegrationErrors"}]}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   SubscriptBox[
    SuperscriptBox["\[ScriptCapitalT]", "\[Sigma]"], "\[Sigma]"], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSEnergyMomentumTrace", "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SymbolicExpression", "->", "False"}], ",", 
        RowBox[{"Optimized", "->", "True"}], ",", " ", 
        RowBox[{"RealPart", "->", "True"}]}], "}"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "res", ",", " ", "resOE", ",", "fkksEM", ",", "OptimizedResult", ",", 
       " ", "tmp", ",", " ", "Filename"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Filename", " ", "=", " ", 
          "\"\<FKKSEnergyMomentumTraceReal.mx\>\""}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Filename", " ", "=", " ", "\"\<FKKSEnergyMomentumTrace.mx\>\""}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ENFilePath", " ", "=", 
          RowBox[{
          "$FKKSRoot", "<>", "\"\<Expressions/\>\"", "<>", "Filename"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "[", "ENFilePath", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"res", " ", "=", " ", 
             RowBox[{"Import", "[", "ENFilePath", "]"}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fkksEM", " ", "=", " ", 
             RowBox[{"FKKSEnergyMomentum", "[", 
              RowBox[{"analytic", ",", " ", 
               RowBox[{"RealPart", "->", 
                RowBox[{"OptionValue", "[", "RealPart", "]"}]}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"res", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"fkksEM", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\[Zeta]", ",", "sphericalchart"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Xi]", ",", "sphericalchart"}], "}"}]}], "]"}], 
               RowBox[{"met", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "\[Zeta]"}], ",", 
                   RowBox[{"-", "sphericalchart"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "\[Xi]"}], ",", 
                   RowBox[{"-", "sphericalchart"}]}], "}"}]}], "]"}]}], "//", 
              "TraceBasisDummy"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Export", "[", 
             RowBox[{"ENFilePath", ",", " ", "res"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Format", " ", "output", " ", "based", " ", "on", " ", "input", " ", 
        "arguments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"solution", "==", "analytic"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"res", "/.", "ToParamSymbols"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "RealPart", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"res", "/.", "ToParamSymbols"}], "/.", 
             RowBox[{"\[Omega]i", "->", "0"}]}], "//", "FromxActVariables"}], 
           "//", 
           RowBox[{"ApplyRealSolutionSet", "[", "solution", "]"}]}]}], ";"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"res", "/.", "ToParamSymbols"}], "//", 
             "FromxActVariables"}], "//", "PrimedToSymbolic"}], "//", 
           RowBox[{"ApplySolutionSet", "[", "solution", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "SymbolicExpression", "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "tmp", "]"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "Optimized", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"OptimizedFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
           ",", " ", 
           RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "|->", 
        RowBox[{"Evaluate", "[", "tmp", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FinalDimlessSpin", "::", "usage"}], "=", 
   "\"\<\nFinal dimensionless spin of the black hole in terms of the initial \
mass (Relative to an energy scale \!\(\*SubscriptBox[\(M\), \(0\)]\)!), the \
real part of the proca frequency, the mode number, the initial dimensionless \
frequency, and the ratio between the final mass and initial mass.\n\n\
FinalDimlessSpin[InitialDimlessSpin_,freq_,mode_,MInitial_,MRatio_]\n\n\
InitialDimlessSpin: Initial dimensionless spin of kerr black hole.\nfreq: \
Real part of the proca frequency (relative to energy scale \
\!\(\*SubscriptBox[\(M\), \(0\)]\))\nmode: mode number of proca cloud.\n\
MInitial: Initial mass of kerr black hole (relative to energy scale \
\!\(\*SubscriptBox[\(M\), \(0\)]\)).\nMRatio: Ratio between final mass \
\!\(\*SubscriptBox[\(M\), \(f\)]\) and inital mass \!\(\*SubscriptBox[\(M\), \
\(i\)]\) of kerr black hole, \!\(\*FractionBox[SubscriptBox[\(M\), \(f\)], \
SubscriptBox[\(M\), \(i\)]]\).\n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FinalDimlessSpin", "[", 
     RowBox[{
     "InitialDimlessSpin_", ",", "freq_", ",", "mode_", ",", "MInitial_", ",",
       "MRatio_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      FractionBox["mode", "freq"], "*", 
      FractionBox["1", "MInitial"], "*", 
      FractionBox["1", "MRatio"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox["1", "MRatio"]}], ")"}]}], "+", 
     FractionBox["InitialDimlessSpin", 
      SuperscriptBox["MRatio", "2"]]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SaturationCondition", "::", "usage"}], "=", 
   "\"\<\nCondition that must be satisfied for superradiant amplification to \
cease. Condition is satisfied when this function equals 0.\n\
\!\(\*FractionBox[\(\[Omega]\), \(m\)]\)-\!\(\*FractionBox[SubscriptBox[\(\
\[Chi]\), \(f\)], \(2 \*SubscriptBox[\(M\), \(f\)] \((1 - \[Sqrt]\((1 - \
\*SuperscriptBox[SubscriptBox[\(\[Chi]\), \(f\)], \(2\)])\))\)\)]\)=0\n\n\
SaturationCondition[freq_,mode_,InitialDimlessSpin_,MInitial_,MRatio_]\n\n\
freq: real part of proca frequency (relative to energy scale \
\!\(\*SubscriptBox[\(M\), \(0\)]\))\nmode: mode number of proca cloud\n\
InitialDimlessSpin: Initial dimensionless spin of kerr black hole\nMInitial: \
Initial mass of kerr black hole (relative to energy scale \!\(\*SubscriptBox[\
\(M\), \(0\)]\))\nMRatio: Ratio between final and initial mass of kerr black \
hole, \!\(\*FractionBox[SubscriptBox[\(M\), \(f\)], SubscriptBox[\(M\), \
\(i\)]]\)\n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SaturationCondition", "[", 
    RowBox[{
    "freq_", ",", "mode_", ",", "InitialDimlessSpin_", ",", "MInitial_", ",", 
     "MRatio_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"chiFinal", " ", "=", " ", 
       RowBox[{"FinalDimlessSpin", "[", 
        RowBox[{
        "InitialDimlessSpin", ",", "freq", ",", "mode", ",", "MInitial", ",", 
         "MRatio"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["freq", "mode"], "-", 
      FractionBox["chiFinal", 
       RowBox[{"2", "*", "MRatio", "*", "MInitial", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "-", 
            SuperscriptBox["chiFinal", "2"]}], "]"}]}], ")"}]}]]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSFinalMass", "::", "usage"}], "=", 
   "\"\<\ncompute final mass of Kerr black hole.\n\n\
FinalMass[freq_,mode_,InitialDimlessSpin_,MInitial_]\n\nfreq: real part of \
proca frequency (relative to energy scale \!\(\*SubscriptBox[\(M\), \(0\)]\))\
\nmode: mode number of proca cloud\nInitialDimlessSpin: Initial dimensionless \
spin of kerr black hole\nMInitial: Initial mass of kerr black hole (relative \
to energy scale \!\(\*SubscriptBox[\(M\), \(0\)]\))\n\nReturns final mass of \
kerr black hole (relative to energy scale \!\(\*SubscriptBox[\(M\), \(0\)]\))\
\n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FKKSFinalMass", "[", 
    RowBox[{
    "freq_", ",", "mode_", ",", "InitialDimlessSpin_", ",", "MInitial_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mm", ",", " ", "MRatio"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MRatio", "=", 
       RowBox[{"First", "[", 
        RowBox[{"mm", "/.", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{"SaturationCondition", "[", 
            RowBox[{
            "freq", ",", "mode", ",", "InitialDimlessSpin", ",", "MInitial", 
             ",", "mm"}], "]"}], ",", "mm", ",", "Reals"}], "]"}]}], " ", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MRatio", "*", "MInitial"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FKKSNormalization", "[", 
   RowBox[{"solution_", ",", " ", "InitialMass_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "totalenergy", ",", " ", "finalmass", ",", " ", "normalization", ",", 
      RowBox[{"wv", " ", "=", " ", 
       RowBox[{
        RowBox[{"solution", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}], "//",
         "Re"}]}], ",", " ", 
      RowBox[{"mv", " ", "=", " ", 
       RowBox[{"solution", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], ",", 
      " ", 
      RowBox[{"\[Chi]v", " ", "=", " ", 
       RowBox[{"solution", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}]}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"totalenergy", " ", "=", " ", 
      RowBox[{
       RowBox[{"FKKSTotalEnergy", "[", "solution", "]"}], "[", 
       "\"\<Total\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalmass", " ", "=", " ", 
      RowBox[{"FKKSFinalMass", "[", 
       RowBox[{
       "wv", ",", " ", "mv", ",", " ", "\[Chi]v", ",", " ", "InitialMass"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normalization", " ", "=", " ", 
      RowBox[{"Sqrt", "[", 
       FractionBox[
        RowBox[{"InitialMass", "-", "finalmass"}], "totalenergy"], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Normalization\>\"", "->", "normalization"}], ",", " ", 
       RowBox[{"\"\<TotalEnergy\>\"", "->", "totalenergy"}], ",", 
       RowBox[{"\"\<FinalMass\>\"", "->", "finalmass"}]}], "|>"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.86296478405648*^9, 3.862964797928751*^9}, {
   3.862964840111762*^9, 3.86296484217303*^9}, {3.862964908813917*^9, 
   3.862965009651157*^9}, {3.862965230282201*^9, 3.8629652312933197`*^9}, {
   3.862982580320877*^9, 3.862982580674638*^9}, {3.862982612367734*^9, 
   3.862982684798275*^9}, {3.862985770571732*^9, 3.8629857710576897`*^9}, 
   3.862986393099662*^9, {3.862987297807922*^9, 3.862987298614695*^9}, {
   3.8629998794574614`*^9, 3.862999955613813*^9}, {3.86300013671996*^9, 
   3.8630002598486156`*^9}, {3.8630003429524*^9, 3.863000356166847*^9}, {
   3.863000537168293*^9, 3.863000537854085*^9}, {3.863000836901215*^9, 
   3.863000849734869*^9}, {3.863000946118361*^9, 3.863000957287278*^9}, {
   3.863001060051186*^9, 3.863001093500208*^9}, {3.86300117353445*^9, 
   3.863001174004702*^9}, {3.863001214606779*^9, 3.863001228030488*^9}, {
   3.8630013724091377`*^9, 3.8630013733736067`*^9}, {3.863001482606349*^9, 
   3.8630014827433443`*^9}, {3.863001546764303*^9, 3.863001552983993*^9}, {
   3.863001618394167*^9, 3.8630016422593822`*^9}, {3.863055654185041*^9, 
   3.863055751910643*^9}, 3.8631457963368073`*^9, {3.8631458394781637`*^9, 
   3.863145842214869*^9}, {3.863511239810791*^9, 3.863511278393475*^9}, {
   3.863511320933571*^9, 3.863511327252615*^9}, {3.8635115277365026`*^9, 
   3.863511565013465*^9}, {3.863511886919592*^9, 3.863511888146443*^9}, {
   3.863515215303681*^9, 3.863515219307349*^9}, {3.863568772466608*^9, 
   3.863568772793222*^9}, {3.863569067503461*^9, 3.863569067866576*^9}, {
   3.863584130137822*^9, 3.863584162574316*^9}, {3.863584384767589*^9, 
   3.863584385511188*^9}, 3.8635852480519037`*^9, {3.863587837291803*^9, 
   3.863587849387588*^9}, {3.863588561766613*^9, 3.863588570688809*^9}, 
   3.8635890565352163`*^9, {3.863589099528594*^9, 3.863589101192083*^9}, 
   3.8635891326703444`*^9, 3.863589189064715*^9, 3.8635893661742563`*^9, 
   3.863589592161407*^9, {3.86365359842999*^9, 3.863653621119597*^9}, {
   3.863669052591894*^9, 3.863669159958745*^9}, {3.8636692224936657`*^9, 
   3.863669345464683*^9}, {3.863669425804551*^9, 3.86366952756924*^9}, {
   3.863673393878797*^9, 3.863673529046822*^9}, 3.863673564377694*^9, {
   3.863677078940943*^9, 3.863677182450512*^9}, {3.8636772255896387`*^9, 
   3.863677324354272*^9}, {3.863677437581396*^9, 3.863677438005031*^9}, {
   3.863677487680975*^9, 3.863677513204133*^9}, {3.863678868009391*^9, 
   3.863678938033601*^9}, {3.8636791698004827`*^9, 3.863679170081979*^9}, 
   3.8636793815563917`*^9, {3.863680683089189*^9, 3.863680689727603*^9}, {
   3.863681434418895*^9, 3.8636814379244204`*^9}, {3.863681561268018*^9, 
   3.8636815897717113`*^9}, {3.863681711146172*^9, 3.863681712532827*^9}, {
   3.863682024042235*^9, 3.863682099037199*^9}, {3.8637441945801287`*^9, 
   3.863744198640541*^9}, {3.863744599275713*^9, 3.8637446499998083`*^9}, {
   3.863744680528454*^9, 3.8637447274483128`*^9}, {3.863744767015079*^9, 
   3.8637448215524893`*^9}, {3.8637491391595783`*^9, 
   3.8637491510398693`*^9}, {3.863749488654451*^9, 3.8637494953357763`*^9}, {
   3.863749539579193*^9, 3.8637495503904543`*^9}, {3.863749695422399*^9, 
   3.863749733971833*^9}, {3.863749799862486*^9, 3.863749802019219*^9}, {
   3.8637498407174263`*^9, 3.863749890526331*^9}, {3.863749972067936*^9, 
   3.863749986369752*^9}, {3.863750038491314*^9, 3.8637500410629*^9}, {
   3.8637500925878363`*^9, 3.8637501619839897`*^9}, {3.8637502115410767`*^9, 
   3.8637502304309893`*^9}, {3.863751140276918*^9, 3.863751243800275*^9}, {
   3.863751316901599*^9, 3.863751322106007*^9}, {3.863751618142516*^9, 
   3.863751744503286*^9}, {3.863751841164825*^9, 3.863751891543674*^9}, {
   3.86375200791372*^9, 3.8637525650962677`*^9}, {3.863753858610589*^9, 
   3.8637539996473217`*^9}, {3.863754061056967*^9, 3.863754076221389*^9}, {
   3.8638523613869877`*^9, 3.863852365594386*^9}, {3.863853289166148*^9, 
   3.863853289341065*^9}, {3.864089815544677*^9, 3.864089973412528*^9}, {
   3.864090016347048*^9, 3.8640900221050587`*^9}, {3.864101234269256*^9, 
   3.8641012520768957`*^9}, {3.8641026389910717`*^9, 3.864102669797254*^9}, {
   3.864106893737994*^9, 3.864106901760868*^9}, {3.864106958800797*^9, 
   3.8641070027230873`*^9}, {3.864107417034274*^9, 3.864107417997458*^9}, {
   3.864115775564822*^9, 3.864115780393888*^9}, 3.8641160484733458`*^9, {
   3.864116480590489*^9, 3.864116482712187*^9}, {3.864116960953964*^9, 
   3.864116968336052*^9}, 3.864117327680854*^9, {3.864117360685666*^9, 
   3.864117368602954*^9}, {3.864194550233235*^9, 3.86419455054154*^9}, {
   3.864195634567072*^9, 3.864195636202647*^9}, {3.864280829563128*^9, 
   3.864280833954232*^9}, {3.864718960114452*^9, 3.864718990868341*^9}, {
   3.864719055734871*^9, 3.864719058686265*^9}, 3.864721913903487*^9, {
   3.864722640788136*^9, 3.8647226771991158`*^9}, 3.8647228349461393`*^9, {
   3.8647230103566732`*^9, 3.8647230127169733`*^9}, {3.8647721632948437`*^9, 
   3.864772231699917*^9}, {3.864772498829484*^9, 3.8647725310222588`*^9}, {
   3.864773141279325*^9, 3.864773144224077*^9}, {3.864773196118227*^9, 
   3.864773204334045*^9}, {3.864773237081135*^9, 3.864773407736741*^9}, {
   3.86477344164357*^9, 3.864773637991295*^9}, {3.864773690508423*^9, 
   3.864773887325809*^9}, {3.864777018893202*^9, 3.864777024469503*^9}, {
   3.8647772705492287`*^9, 3.864777317887088*^9}, 3.8647773776066303`*^9, 
   3.864777419872129*^9, {3.8647776843399*^9, 3.864777687917639*^9}, {
   3.864777729304166*^9, 3.864777739567134*^9}, {3.8648019444059*^9, 
   3.86480199903356*^9}, {3.8648024318972*^9, 3.864802466680575*^9}, {
   3.864802507166725*^9, 3.864802542036512*^9}, {3.864802733953561*^9, 
   3.864802761995042*^9}, {3.8648028102800903`*^9, 3.8648028319150543`*^9}, {
   3.864802874881913*^9, 3.8648028777407303`*^9}, {3.864802910145636*^9, 
   3.8648029721619463`*^9}, 3.864803191778049*^9, {3.864814178675117*^9, 
   3.864814178786273*^9}, {3.864814220374556*^9, 3.864814222603866*^9}, {
   3.864814820873489*^9, 3.8648148529697*^9}, {3.8648155636890087`*^9, 
   3.864815570908861*^9}, 3.8648589012982903`*^9, {3.864865806377165*^9, 
   3.864865831830111*^9}, {3.8648658780965853`*^9, 3.864865902675726*^9}, 
   3.864866320195932*^9, {3.864879816963307*^9, 3.86487995923358*^9}, {
   3.864879991094556*^9, 3.8648801109321327`*^9}, {3.8648805886304293`*^9, 
   3.864880621045471*^9}, {3.864880750913156*^9, 3.864880754023427*^9}, {
   3.864881944194277*^9, 3.864881945734412*^9}, {3.864881987145297*^9, 
   3.8648819891962852`*^9}, {3.864882056584037*^9, 3.864882056699204*^9}, {
   3.8648821319663363`*^9, 3.864882133729145*^9}, {3.864882553728962*^9, 
   3.86488255417809*^9}, {3.865496152808316*^9, 3.865496349642111*^9}, {
   3.865496381777467*^9, 3.8654964580209827`*^9}, {3.86555315337387*^9, 
   3.865553192016645*^9}, {3.865563257429193*^9, 3.865563301799418*^9}, {
   3.865563693492281*^9, 3.8655637067981453`*^9}, {3.8655697242026787`*^9, 
   3.865569749114747*^9}, {3.865569995196291*^9, 3.865570001664866*^9}, {
   3.8655729882429647`*^9, 3.865572992518527*^9}, {3.8655731617574263`*^9, 
   3.8655731646321383`*^9}, {3.865573261948122*^9, 3.86557330216533*^9}, {
   3.865573551561198*^9, 3.8655736082295017`*^9}, {3.865573661820924*^9, 
   3.865573663312294*^9}, {3.865576929861184*^9, 3.865576934235923*^9}, {
   3.865577215978322*^9, 3.86557725616183*^9}, {3.8655773573268957`*^9, 
   3.8655773859416027`*^9}, {3.865577441785668*^9, 3.865577478885221*^9}, {
   3.865583250546401*^9, 3.8655832513163548`*^9}, {3.865584144114064*^9, 
   3.8655841447794237`*^9}, {3.8655842458850946`*^9, 3.865584247025907*^9}, 
   3.865584309449839*^9, {3.865584413008018*^9, 3.8655845734222507`*^9}, {
   3.865584634630728*^9, 3.865584637832868*^9}, {3.865584702606276*^9, 
   3.8655847890139627`*^9}, {3.865584829888712*^9, 3.865584834651594*^9}, 
   3.8655853964526033`*^9, {3.865586067215598*^9, 3.865586072212201*^9}, {
   3.86558616005917*^9, 3.865586231063016*^9}, {3.865586331758473*^9, 
   3.865586350779963*^9}, {3.865586418049691*^9, 3.865586458908144*^9}, 
   3.865587099298119*^9, {3.865595620564467*^9, 3.865595675133954*^9}, {
   3.8655957183575487`*^9, 3.865595733737322*^9}, {3.865642892487686*^9, 
   3.865642893425403*^9}, 3.8656496152989197`*^9, {3.865651146526134*^9, 
   3.865651166633526*^9}, {3.865651314276266*^9, 3.8656513486948547`*^9}, {
   3.8656516323203897`*^9, 3.865651696673946*^9}, {3.8656518009469433`*^9, 
   3.865651817541519*^9}, {3.8656519832395477`*^9, 3.865652039893106*^9}, {
   3.865652251879609*^9, 3.8656522830918913`*^9}, {3.865652970119156*^9, 
   3.865653049113913*^9}, {3.865653080067375*^9, 3.865653082182626*^9}, {
   3.865653121309347*^9, 3.8656531333017073`*^9}, {3.8656531867210817`*^9, 
   3.865653189321293*^9}, {3.865653252134818*^9, 3.865653310041663*^9}, 
   3.865653341141777*^9, {3.865653472696377*^9, 3.8656534983961477`*^9}, {
   3.865653541190399*^9, 3.865653566462242*^9}, {3.86565365020905*^9, 
   3.8656536846314573`*^9}, {3.865653927913493*^9, 3.865654135203499*^9}, {
   3.865659257174913*^9, 3.86565926074116*^9}, {3.8659299204881144`*^9, 
   3.865929942836565*^9}, {3.865929979545353*^9, 3.865930023953907*^9}, {
   3.865930602042377*^9, 3.86593062540915*^9}, {3.86595069762915*^9, 
   3.865950711348297*^9}, {3.866018797853401*^9, 3.866019054161292*^9}, {
   3.8660193163661613`*^9, 3.866019391892662*^9}, {3.866019747146886*^9, 
   3.866019808978965*^9}, {3.866019870791078*^9, 3.866019875006443*^9}, {
   3.86601991284158*^9, 3.866019913265442*^9}, {3.8660427962834682`*^9, 
   3.8660428927609863`*^9}, {3.866042981771455*^9, 3.866043126571301*^9}, {
   3.866043161099369*^9, 3.866043318704373*^9}, {3.866044292675253*^9, 
   3.8660443593017397`*^9}, {3.866044861223386*^9, 3.866044957454958*^9}, {
   3.866045181885222*^9, 3.866045183567554*^9}, {3.86604521957337*^9, 
   3.866045298049509*^9}, {3.866045331686734*^9, 3.866045370203579*^9}, {
   3.8660454012522*^9, 3.8660454031366463`*^9}, {3.8660457255296392`*^9, 
   3.866045753498897*^9}, {3.866045787737743*^9, 3.866045845486692*^9}, 
   3.866073614925218*^9, {3.866074018512533*^9, 3.8660740191871243`*^9}, 
   3.866075005747903*^9, {3.8660768093187847`*^9, 3.866076830296549*^9}, {
   3.866076912123036*^9, 3.866076928666918*^9}, {3.866078157769813*^9, 
   3.866078235799889*^9}, {3.866078284926671*^9, 3.866078299930112*^9}, {
   3.866079487300272*^9, 3.866079489122134*^9}, 3.86607955262499*^9, {
   3.8660797329598293`*^9, 3.866079735074239*^9}, 3.866079777948987*^9, {
   3.866082183406596*^9, 3.866082183726403*^9}, {3.866082876365004*^9, 
   3.866082910521879*^9}, {3.8660914162956*^9, 3.866091427678988*^9}, 
   3.8660929820445623`*^9, {3.866096293019045*^9, 3.866096323912139*^9}, {
   3.866261161092793*^9, 3.8662612840777197`*^9}, {3.86627579095431*^9, 
   3.8662757983231077`*^9}, {3.866275968021162*^9, 3.8662762965718184`*^9}, {
   3.866276365702366*^9, 3.866276406853593*^9}, {3.866277311415011*^9, 
   3.866277327912112*^9}, {3.866277587453844*^9, 3.866277663589612*^9}, {
   3.8662784530948*^9, 3.866278482870344*^9}, {3.866279180797628*^9, 
   3.866279315529263*^9}, 3.866279349861209*^9, {3.8662807634408293`*^9, 
   3.866280829576357*^9}, {3.866280893676155*^9, 3.8662808976895447`*^9}, {
   3.866280950467327*^9, 3.86628104947686*^9}, {3.866281185633994*^9, 
   3.866281277413559*^9}, {3.8665080645141573`*^9, 3.866508086146328*^9}, {
   3.866508555166429*^9, 3.866508556177289*^9}, {3.8665087090644283`*^9, 
   3.8665087104648314`*^9}, {3.866508983632942*^9, 3.866508984328986*^9}, {
   3.866509074208709*^9, 3.866509144662509*^9}, {3.866509300744082*^9, 
   3.8665093030319443`*^9}, {3.8665093591944*^9, 3.866509359966671*^9}, {
   3.86651682799758*^9, 3.866516846930008*^9}, {3.8665306762003736`*^9, 
   3.866530697612409*^9}, {3.866530820847535*^9, 3.8665308390716476`*^9}, {
   3.86653087894695*^9, 3.86653088641753*^9}, 3.8665309266891747`*^9, {
   3.866531043602869*^9, 3.866531067347329*^9}, {3.86653321864922*^9, 
   3.866533233836835*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"06240c12-8473-4005-a8a6-aecbad962829"]
}, Closed]],

Cell["", "Title",ExpressionUUID->"19cb6689-e93e-4908-bf19-a3e0551f9790"]
},
WindowSize->{720, 756},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"422e4b80-3b30-4473-81df-e2b209a10e34"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 175, 3, 69, "Chapter",ExpressionUUID->"fc3c1c9b-4fe9-4801-8473-dee71b5fa03c"],
Cell[CellGroupData[{
Cell[780, 29, 4966, 113, 362, "Input",ExpressionUUID->"60c866cf-6c50-4c82-b64b-4ae293b21cf0"],
Cell[5749, 144, 406, 10, 22, "Message",ExpressionUUID->"a6ec44d9-0913-414f-b437-71e40b89ba6a"],
Cell[6158, 156, 218, 5, 25, "Output",ExpressionUUID->"5b3b1c4d-eeee-4dd5-b989-1b33f1e68edb"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[6425, 167, 163, 3, 58, "Chapter",ExpressionUUID->"4eadd76b-ca7b-46bf-81a4-4d9382974e33"],
Cell[6591, 172, 56441, 1356, 4106, "Input",ExpressionUUID->"4cb08ff2-d5f8-4ad8-b3d2-b251346f9fe5"]
}, Closed]],
Cell[CellGroupData[{
Cell[63069, 1533, 156, 3, 58, "Chapter",ExpressionUUID->"3e87b444-f4f6-46d3-b15b-bd5440b2e4b7"],
Cell[63228, 1538, 74377, 1618, 6690, "Input",ExpressionUUID->"06240c12-8473-4005-a8a6-aecbad962829"]
}, Closed]],
Cell[137620, 3159, 72, 0, 72, "Title",ExpressionUUID->"19cb6689-e93e-4908-bf19-a3e0551f9790"]
}
]
*)

