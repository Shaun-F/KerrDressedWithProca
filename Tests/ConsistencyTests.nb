(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67653,       1808]
NotebookOptionsPosition[     64760,       1752]
NotebookOutlinePosition[     65155,       1768]
CellTagsIndexPosition[     65112,       1765]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization", "Chapter",
 CellChangeTimes->{{3.8673677641749287`*^9, 
  3.867367766222218*^9}},ExpressionUUID->"a0c18c35-1175-4a3f-8d91-\
21c3a0e5c84a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$FKKSRoot", " ", "=", " ", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<../\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SolutionPath", " ", "=", " ", 
   RowBox[{"$FKKSRoot", "<>", "\"\<Solutions/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotPath", " ", "=", " ", 
   RowBox[{"$FKKSRoot", "<>", "\"\<Plots/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogFile", " ", "=", " ", 
   RowBox[{"$FKKSRoot", "<>", "\"\<Logs/LogFile\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotFileExtension", " ", "=", " ", "\"\<.png\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumberofSlaveKernels", " ", "=", " ", "Automatic"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Default", " ", "should", " ", "be", " ", "Automatic"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Import", " ", "some", " ", "helper", " ", "functions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "$FKKSRoot", ",", " ", "\"\<Packages\>\"", ",", " ", 
      "\"\<HelperFunctions.wl\>\""}], "}"}], "]"}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Setup", " ", "xAct", " ", "definitions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "$FKKSRoot", ",", " ", "\"\<Packages\>\"", ",", " ", 
      "\"\<xActSetup.wl\>\""}], "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Setup", " ", "Proca", " ", "Solver"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "$FKKSRoot", ",", " ", "\"\<Packages\>\"", ",", " ", 
      "\"\<KerrWithProca.wl\>\""}], "}"}], "]"}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Setup", " ", "Energy", " ", "Momentum", " ", "Definitions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "$FKKSRoot", ",", " ", "\"\<Packages\>\"", ",", " ", 
      "\"\<EnergyMomentum.wl\>\""}], "}"}], "]"}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Setup", " ", "MST", " ", "Solver"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "$FKKSRoot", ",", " ", "\"\<Packages\>\"", ",", " ", 
      "\"\<MSTSolver.wl\>\""}], "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Setup", " ", "Inhomogeneous", " ", "Teukolsky", " ", "Solver"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "$FKKSRoot", ",", " ", "\"\<Packages\>\"", ",", " ", 
     "\"\<TeukolskySolver.wl\>\""}], "}"}], "]"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.867367772674797*^9, 3.867367824697199*^9}, {
   3.867367868484721*^9, 3.867367988547168*^9}, {3.8673758747552023`*^9, 
   3.867375895844741*^9}, {3.867381152880926*^9, 3.8673811670077333`*^9}, {
   3.867478790401656*^9, 3.867478801977219*^9}, {3.86748066826404*^9, 
   3.867480673468967*^9}, 3.86754897620187*^9, {3.8678415238267813`*^9, 
   3.867841549337219*^9}, {3.867988137044244*^9, 3.867988172007448*^9}, 
   3.8680029784103413`*^9, {3.8680035822901983`*^9, 3.868003582399714*^9}, {
   3.868004287023408*^9, 3.868004287287722*^9}, {3.868005117299487*^9, 
   3.8680051173899508`*^9}, {3.868060893686482*^9, 3.86806089864186*^9}, {
   3.8680770063188343`*^9, 3.8680770074134483`*^9}, {3.868334142036818*^9, 
   3.868334143808476*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d6da2366-e1a5-4617-b531-ad11bf4ab4cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Teukolsky Kinnersly projection consistency tests", "Chapter",
 CellChangeTimes->{
  3.869135381499498*^9},ExpressionUUID->"d02840a9-74c9-4da8-8d98-\
fb9471ac1e06"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["T", "nn"], TraditionalForm]],
 FormatType->
  TraditionalForm,ExpressionUUID->"35282e82-7f26-477e-817c-6f6311e8061f"]], \
"Section",
 CellChangeTimes->{{3.8691367667810907`*^9, 
  3.869136768000708*^9}},ExpressionUUID->"a53fc4fb-2dba-4216-9934-\
a45f0a8ef424"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SampleData", " ", "=", " ", 
   RowBox[{"Import", "@", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<../Debugging/*.mx\>\"", ",", " ", 
       RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rdom", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SampleData", "[", 
       RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}], "[", 
      "\"\<Domain\>\"", "]"}], "//", "First"}], "//", 
    RowBox[{
     RowBox[{"HorizonCoordToRadial", "[", 
      RowBox[{"#", ",", 
       RowBox[{"data", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintTemporary", "@", 
   RowBox[{"Dynamic", "[", "$Messenger", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnnSymbolic", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "|->", 
    RowBox[{"Evaluate", "@", 
     RowBox[{"Tnn", "[", 
      RowBox[{"SampleData", ",", " ", 
       RowBox[{"AsSymbolic", "->", "True"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnnOptimized", " ", "=", " ", 
   RowBox[{"Tnn", "[", 
    RowBox[{"SampleData", ",", " ", 
     RowBox[{"AsOptimized", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tnnInterpolating", " ", "=", " ", 
   RowBox[{"Tnn", "[", 
    RowBox[{"SampleData", ",", " ", 
     RowBox[{"AsInterpolatingFunction", "->", "True"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.869135387335328*^9, 3.869135472486245*^9}, {
  3.869136078054281*^9, 3.869136080760263*^9}, {3.869136163324048*^9, 
  3.8691361658779907`*^9}, {3.869136544251934*^9, 
  3.869136550127644*^9}},ExpressionUUID->"595d5f41-788d-4f7c-a8e1-\
a6fb88b1afe6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Symbolic", " ", "form", " ", "of", " ", "Tnn", " ", "takes", " ", "a", 
     " ", "very", " ", "long", " ", "time", " ", "to", " ", "calculate", " ", 
     "a", " ", "single", " ", "point"}], ",", " ", 
    RowBox[{"let", " ", "alone", " ", "plot"}], ",", " ", 
    RowBox[{
    "so", " ", "we", " ", "just", " ", "verify", " ", "the", " ", "symbolic", 
     " ", "form", " ", "agrees", " ", "well", " ", "with", " ", "the", " ", 
     "Optimized", " ", "form"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]point", " ", "=", " ", 
       FractionBox["\[Pi]", "2"]}], ",", " ", 
      RowBox[{"radialpoint", " ", "=", " ", "50"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Fractional difference between Optimized form of Tnn and Symbolic \
form at (r,\[Theta])=(50,\!\(\*FractionBox[\(\[Pi]\), \(2\)]\)):\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tnnOptimized", "[", 
          RowBox[{"0", ",", "radialpoint", ",", "\[Theta]point", ",", "0"}], 
          "]"}], "-", 
         RowBox[{"tnnSymbolic", "[", 
          RowBox[{"0", ",", "radialpoint", ",", "\[Theta]point", ",", "0"}], 
          "]"}]}], ")"}], "/", 
       RowBox[{"tnnSymbolic", "[", 
        RowBox[{"0", ",", "radialpoint", ",", "\[Theta]point", ",", "0"}], 
        "]"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.869136198053851*^9, 3.8691362434828453`*^9}, {
  3.869136361535144*^9, 3.869136374229107*^9}, {3.8691366097134943`*^9, 
  3.8691366338767*^9}},ExpressionUUID->"070d9bb7-98c7-4795-b2f4-1f663c090dc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Plot", " ", "the", " ", "fractional", " ", "difference", " ", "between", 
    " ", "the", " ", "Optimized", " ", "form", " ", "of", " ", "Tnn", " ", 
    "and", " ", "the", " ", "function", " ", "that", " ", "Interpolates", " ",
     "Tnn"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Theta]point", " ", "=", " ", 
      FractionBox["\[Pi]", "2"]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Fractional difference between Optimized form of Tnn and the \
InterpolationFunction form at \[Theta]=\!\(\*FractionBox[\(\[Pi]\), \(2\)]\):\
\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"tnnInterpolating", "[", 
          RowBox[{"0", ",", "r", ",", "\[Theta]point", ",", "0"}], "]"}], "-", 
         RowBox[{
          StyleBox["tnnOptimized",
           FontSize->14], "[", 
          RowBox[{"0", ",", "r", ",", "\[Theta]point", ",", "0"}], "]"}]}], 
        RowBox[{"tnnOptimized", "[", 
         RowBox[{"0", ",", "r", ",", "\[Theta]point", ",", "0"}], "]"}]], ",",
        " ", 
       RowBox[{"{", 
        RowBox[{"r", ",", "1.44", ",", 
         FractionBox[
          RowBox[{"rdom", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "1.5"]}], "}"}], ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.869136019850161*^9, 3.869136142682763*^9}, {
  3.869136249104907*^9, 3.86913625592517*^9}, {3.8691366715305967`*^9, 
  3.86913674254128*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"747043d1-2e49-4081-b473-8e0913c96882"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["T", 
   RowBox[{
    OverscriptBox["m", "_"], 
    OverscriptBox["m", "_"]}]], TraditionalForm]],
 InitializationCell->True,
 FormatType->
  TraditionalForm,ExpressionUUID->"36f3d08b-3377-4bb4-86c3-154c22ca2ae4"]], \
"Section",
 CellChangeTimes->{{3.8691367667810907`*^9, 
  3.869136780543597*^9}},ExpressionUUID->"896da3bc-1637-4ab4-ac13-\
717e86ee7259"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SampleData", " ", "=", " ", 
   RowBox[{"Import", "@", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<../Debugging/*.mx\>\"", ",", " ", 
       RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rdom", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SampleData", "[", 
       RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}], "[", 
      "\"\<Domain\>\"", "]"}], "//", "First"}], "//", 
    RowBox[{
     RowBox[{"HorizonCoordToRadial", "[", 
      RowBox[{"#", ",", 
       RowBox[{"data", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintTemporary", "@", 
   RowBox[{"Dynamic", "[", "$Messenger", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmbmbSymbolic", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "|->", 
    RowBox[{"Evaluate", "@", 
     RowBox[{"Tmbmb", "[", 
      RowBox[{"SampleData", ",", " ", 
       RowBox[{"AsSymbolic", "->", "True"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmbmbOptimized", " ", "=", " ", 
   RowBox[{"Tmbmb", "[", 
    RowBox[{"SampleData", ",", " ", 
     RowBox[{"AsOptimized", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmbmbInterpolating", " ", "=", " ", 
   RowBox[{"Tmbmb", "[", 
    RowBox[{"SampleData", ",", " ", 
     RowBox[{"AsInterpolatingFunction", "->", "True"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.869135387335328*^9, 3.869135472486245*^9}, {
  3.869136078054281*^9, 3.869136080760263*^9}, {3.869136163324048*^9, 
  3.8691361658779907`*^9}, {3.869136544251934*^9, 3.869136550127644*^9}, {
  3.869136794658008*^9, 3.869136810400083*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"075c529e-eaba-41e0-a7c9-f1603e884898"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Symbolic", " ", "form", " ", "of", " ", "Tmbmb", " ", "takes", " ", "a", 
     " ", "very", " ", "long", " ", "time", " ", "to", " ", "calculate", " ", 
     "a", " ", "single", " ", "point"}], ",", " ", 
    RowBox[{"let", " ", "alone", " ", "plot"}], ",", " ", 
    RowBox[{
    "so", " ", "we", " ", "just", " ", "verify", " ", "the", " ", "symbolic", 
     " ", "form", " ", "agrees", " ", "well", " ", "with", " ", "the", " ", 
     "Optimized", " ", "form"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]point", " ", "=", " ", 
       FractionBox["\[Pi]", "2"]}], ",", " ", 
      RowBox[{"radialpoint", " ", "=", " ", "50"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Fractional difference between Optimized form of Tmbmb and Symbolic \
form at (r,\[Theta])=(50,\!\(\*FractionBox[\(\[Pi]\), \(2\)]\)):\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tmbmbOptimized", "[", 
          RowBox[{"0", ",", "radialpoint", ",", "\[Theta]point", ",", "0"}], 
          "]"}], "-", 
         RowBox[{"tmbmbSymbolic", "[", 
          RowBox[{"0", ",", "radialpoint", ",", "\[Theta]point", ",", "0"}], 
          "]"}]}], ")"}], "/", 
       RowBox[{"tmbmbSymbolic", "[", 
        RowBox[{"0", ",", "radialpoint", ",", "\[Theta]point", ",", "0"}], 
        "]"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.869136198053851*^9, 3.8691362434828453`*^9}, {
  3.869136361535144*^9, 3.869136374229107*^9}, {3.8691366097134943`*^9, 
  3.8691366338767*^9}, {3.8691368150322323`*^9, 3.869136842878124*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"951f4a39-1997-48fc-ae08-124079a8b9fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Plot", " ", "the", " ", "fractional", " ", "difference", " ", "between", 
    " ", "the", " ", "Optimized", " ", "form", " ", "of", " ", "Tmbmb", " ", 
    "and", " ", "the", " ", "function", " ", "that", " ", "Interpolates", " ",
     "Tnn"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Theta]point", " ", "=", " ", 
      FractionBox["\[Pi]", "2"]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Fractional difference between Optimized form of Tmbmb and the \
InterpolationFunction form at \[Theta]=\!\(\*FractionBox[\(\[Pi]\), \(2\)]\):\
\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Abs", "@", 
        FractionBox[
         RowBox[{
          RowBox[{"tmbmbInterpolating", "[", 
           RowBox[{"0", ",", "r", ",", "\[Theta]point", ",", "0"}], "]"}], 
          "-", 
          RowBox[{
           StyleBox["tmbmbOptimized",
            FontSize->14], "[", 
           RowBox[{"0", ",", "r", ",", "\[Theta]point", ",", "0"}], "]"}]}], 
         RowBox[{"tmbmbOptimized", "[", 
          RowBox[{"0", ",", "r", ",", "\[Theta]point", ",", "0"}], "]"}]]}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"r", ",", "1.44", ",", 
         FractionBox[
          RowBox[{"rdom", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "1.5"]}], "}"}], ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.869136019850161*^9, 3.869136142682763*^9}, {
  3.869136249104907*^9, 3.86913625592517*^9}, {3.8691366715305967`*^9, 
  3.86913674254128*^9}, {3.8691368264561872`*^9, 3.869136848386743*^9}, {
  3.869137499464682*^9, 3.86913750264139*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"f9061da8-facd-44ab-b8ec-4fa64b4d0513"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubscriptBox["T", 
   RowBox[{
    OverscriptBox["m", "_"], "n"}]], TraditionalForm]],
 InitializationCell->True,
 FormatType->
  TraditionalForm,ExpressionUUID->"2d37a25f-8be5-42a6-9919-7ef6411279bd"]], \
"Section",
 CellChangeTimes->{{3.8691367667810907`*^9, 3.869136780543597*^9}, {
  3.8691368569170427`*^9, 
  3.869136859759172*^9}},ExpressionUUID->"21d7ab97-27a8-4f9d-8c58-\
00d6d24bbbe8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SampleData", " ", "=", " ", 
   RowBox[{"Import", "@", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<../Debugging/*.mx\>\"", ",", " ", 
       RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rdom", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SampleData", "[", 
       RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}], "[", 
      "\"\<Domain\>\"", "]"}], "//", "First"}], "//", 
    RowBox[{
     RowBox[{"HorizonCoordToRadial", "[", 
      RowBox[{"#", ",", 
       RowBox[{"data", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintTemporary", "@", 
   RowBox[{"Dynamic", "[", "$Messenger", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmbnSymbolic", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "|->", 
    RowBox[{"Evaluate", "@", 
     RowBox[{"Tmbn", "[", 
      RowBox[{"SampleData", ",", " ", 
       RowBox[{"AsSymbolic", "->", "True"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmbnOptimized", " ", "=", " ", 
   RowBox[{"Tmbn", "[", 
    RowBox[{"SampleData", ",", " ", 
     RowBox[{"AsOptimized", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmbnInterpolating", " ", "=", " ", 
   RowBox[{"Tmbn", "[", 
    RowBox[{"SampleData", ",", " ", 
     RowBox[{"AsInterpolatingFunction", "->", "True"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.869135387335328*^9, 3.869135472486245*^9}, {
  3.869136078054281*^9, 3.869136080760263*^9}, {3.869136163324048*^9, 
  3.8691361658779907`*^9}, {3.869136544251934*^9, 3.869136550127644*^9}, {
  3.869136794658008*^9, 3.869136810400083*^9}, {3.869136863452775*^9, 
  3.869136874190262*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"efe8cf46-d575-4729-8cc5-176c288aff6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Symbolic", " ", "form", " ", "of", " ", "Tmbn", " ", "takes", " ", "a", 
     " ", "very", " ", "long", " ", "time", " ", "to", " ", "calculate", " ", 
     "a", " ", "single", " ", "point"}], ",", " ", 
    RowBox[{"let", " ", "alone", " ", "plot"}], ",", " ", 
    RowBox[{
    "so", " ", "we", " ", "just", " ", "verify", " ", "the", " ", "symbolic", 
     " ", "form", " ", "agrees", " ", "well", " ", "with", " ", "the", " ", 
     "Optimized", " ", "form"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]point", " ", "=", " ", 
       FractionBox["\[Pi]", "2"]}], ",", " ", 
      RowBox[{"radialpoint", " ", "=", " ", "50"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Fractional difference between Optimized form of Tmbn and Symbolic \
form at (r,\[Theta])=(50,\!\(\*FractionBox[\(\[Pi]\), \(2\)]\)):\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tmbnOptimized", "[", 
          RowBox[{"0", ",", "radialpoint", ",", "\[Theta]point", ",", "0"}], 
          "]"}], "-", 
         RowBox[{"tmbnSymbolic", "[", 
          RowBox[{"0", ",", "radialpoint", ",", "\[Theta]point", ",", "0"}], 
          "]"}]}], ")"}], "/", 
       RowBox[{"tmbnSymbolic", "[", 
        RowBox[{"0", ",", "radialpoint", ",", "\[Theta]point", ",", "0"}], 
        "]"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.869136198053851*^9, 3.8691362434828453`*^9}, {
  3.869136361535144*^9, 3.869136374229107*^9}, {3.8691366097134943`*^9, 
  3.8691366338767*^9}, {3.8691368150322323`*^9, 3.869136842878124*^9}, {
  3.869136878569721*^9, 3.869136889320977*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"19b0f665-c3d1-41c9-b735-fb4d73e65e7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Plot", " ", "the", " ", "fractional", " ", "difference", " ", "between", 
    " ", "the", " ", "Optimized", " ", "form", " ", "of", " ", "Tmbn", " ", 
    "and", " ", "the", " ", "function", " ", "that", " ", "Interpolates", " ",
     "Tnn"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Theta]point", " ", "=", " ", 
      FractionBox["\[Pi]", "2"]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Fractional difference between Optimized form of Tmbn and the \
InterpolationFunction form at \[Theta]=\!\(\*FractionBox[\(\[Pi]\), \(2\)]\):\
\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Abs", "@", 
        FractionBox[
         RowBox[{
          RowBox[{"tmbnInterpolating", "[", 
           RowBox[{"0", ",", "r", ",", "\[Theta]point", ",", "0"}], "]"}], 
          "-", 
          RowBox[{
           StyleBox["tmbnOptimized",
            FontSize->14], "[", 
           RowBox[{"0", ",", "r", ",", "\[Theta]point", ",", "0"}], "]"}]}], 
         RowBox[{"tmbnOptimized", "[", 
          RowBox[{"0", ",", "r", ",", "\[Theta]point", ",", "0"}], "]"}]]}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"r", ",", "1.44", ",", 
         FractionBox[
          RowBox[{"rdom", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "1.5"]}], "}"}], ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.869136019850161*^9, 3.869136142682763*^9}, {
  3.869136249104907*^9, 3.86913625592517*^9}, {3.8691366715305967`*^9, 
  3.86913674254128*^9}, {3.8691368264561872`*^9, 3.869136848386743*^9}, {
  3.869136892930883*^9, 3.869136902780851*^9}, {3.869137174823945*^9, 
  3.869137175453579*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"70ba1bbc-d787-4033-b1d9-98ef75031309"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparison to Nils Code", "Chapter",
 CellChangeTimes->{
  3.869135381499498*^9, {3.8723187070645437`*^9, 
   3.872318709531288*^9}},ExpressionUUID->"0f1498e9-e948-475d-bdb2-\
c69ca7c1784c"],

Cell[CellGroupData[{

Cell["Vector Field", "Section",
 CellChangeTimes->{{3.8723202674351397`*^9, 
  3.872320269198668*^9}},ExpressionUUID->"0dc18a22-2634-4f73-bfd0-\
57a24149eaa9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testsol", " ", "=", " ", 
   RowBox[{
    RowBox[{"getResults", "[", 
     RowBox[{"$SolutionPath", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<\[Chi]\>\"", ",", "\"\<9_10\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<m\>\"", ",", "\"\<1\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<n\>\"", ",", "\"\<0\>\""}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Mu]Nv\>\"", ",", "\"\<1_5\>\""}], "}"}]}], "}"}]}], 
     "]"}], "//", "First"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radialSolution", " ", "=", " ", 
   RowBox[{"testsol", "[", 
    RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angularSolution", " ", "=", " ", 
    RowBox[{"testsol", "[", 
     RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<S\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReprRule", " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{
      RowBox[{"i\[Nu]", "->", 
       RowBox[{"Im", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}]}]}], 
      ",", " ", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"r\[Nu]", "->", 
       RowBox[{"Re", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}]}]}], 
      ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"\[Omega]i", "->", 
       RowBox[{"Im", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], 
         "]"}]}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"\[Omega]r", "->", 
       RowBox[{"Re", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], 
         "]"}]}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"m", "->", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"\[Chi]", "->", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "a_", "]"}], "[", "Ri", "]"}], "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Im", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "a", "]"}], "[", "radialSolution", 
            "]"}], "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", 
      "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "a_", "]"}], "[", "Rr", "]"}], "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "a", "]"}], "[", "radialSolution", 
            "]"}], "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", 
      "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "a_", "]"}], "[", "Si", "]"}], "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Im", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "a", "]"}], "[", "angularSolution", 
            "]"}], "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", 
      "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "a_", "]"}], "[", "Sr", "]"}], "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "a", "]"}], "[", "angularSolution", 
            "]"}], "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", 
      "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"Ri", " ", "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Im", "[", 
          RowBox[{"radialSolution", "[", "#", "]"}], "]"}], "&"}], ")"}]}], 
      ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"Rr", " ", "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"radialSolution", "[", "#", "]"}], "]"}], "&"}], ")"}]}], 
      ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"Sr", " ", "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"angularSolution", "[", "#", "]"}], "]"}], "&"}], ")"}]}], 
      ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"Si", " ", "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Im", "[", 
          RowBox[{"angularSolution", "[", "#", "]"}], "]"}], "&"}], ")"}]}]}],
      "\[IndentingNewLine]", "\t\t", "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\t\t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AupNilsSymbolic", " ", "=", " ", 
   RowBox[{
   "Import", "[", 
    "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/NilsSiemonsenCode/AupSimp.mx\>\"", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AupNilsSolution", " ", "=", " ", 
   RowBox[{"AupNilsSymbolic", "/.", "ReprRule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AupNils", " ", "=", " ", 
    RowBox[{"OptimizedFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
      "AupNilsSolution"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AupMe", " ", "=", " ", 
    RowBox[{"FKKSProca", "[", 
     RowBox[{"testsol", ",", " ", 
      RowBox[{"Optimized", "->", "True"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Column", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<My \!\(\*SuperscriptBox[\(A\), \(\[Mu]\)]\): \>\"", ",", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AupMe", "[", 
            RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "]"}], "[", 
           RowBox[{"{", 
            RowBox[{"i", ",", "sphericalchart"}], "}"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], "//", 
        "Column"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Nils \!\(\*SuperscriptBox[\(A\), \(\[Mu]\)]\): \>\"", ",", " ", 
       RowBox[{
        RowBox[{"AupNils", "[", 
         RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "]"}], "//", 
        "Column"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<Difference: \>\"", " ", 
       RowBox[{"Column", "[", 
        RowBox[{
         RowBox[{"AupNils", "[", 
          RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "]"}], "-", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"AupMe", "[", 
             RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "]"}], "[", 
            RowBox[{"{", 
             RowBox[{"i", ",", "sphericalchart"}], "}"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.872320272974568*^9, 3.8723202822588177`*^9}, {
  3.872320320029745*^9, 3.8723205359314957`*^9}, {3.872320590655542*^9, 
  3.87232061577494*^9}, {3.8723207627980347`*^9, 3.8723207877232323`*^9}, {
  3.8723220955228987`*^9, 3.872322115361703*^9}, {3.872322294340003*^9, 
  3.872322333897562*^9}, {3.872322454920925*^9, 3.87232245850708*^9}, {
  3.8723227871268063`*^9, 3.872322874444695*^9}, {3.872323110006048*^9, 
  3.8723231306106777`*^9}, {3.872323162825829*^9, 3.872323229066329*^9}, {
  3.8723233426564493`*^9, 3.872323408601081*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"0cd0e79a-2add-43f5-bc3e-2ff8dd637733"]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy Momentum Tensor", "Section",
 CellChangeTimes->{{3.872323505551113*^9, 
  3.872323508584153*^9}},ExpressionUUID->"fcee013c-fd08-48e4-ab54-\
fe7cebe3c960"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testsol", " ", "=", " ", 
   RowBox[{
    RowBox[{"getResults", "[", 
     RowBox[{"$SolutionPath", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<\[Chi]\>\"", ",", "\"\<9_10\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<m\>\"", ",", "\"\<1\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<n\>\"", ",", "\"\<0\>\""}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Mu]Nv\>\"", ",", "\"\<1_5\>\""}], "}"}]}], "}"}]}], 
     "]"}], "//", "First"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radialSolution", " ", "=", " ", 
   RowBox[{"testsol", "[", 
    RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angularSolution", " ", "=", " ", 
   RowBox[{"testsol", "[", 
    RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<S\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcaFieldUp", " ", "=", " ", 
   RowBox[{"FKKSProca", "[", 
    RowBox[{"testsol", ",", " ", 
     RowBox[{"Optimized", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcaFieldDown", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ProcaFieldUp", "[", 
        RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "sphericalchart"}]}], "}"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParamReprRule", " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{
      RowBox[{"i\[Nu]", "->", 
       RowBox[{"Im", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}]}]}], 
      ",", " ", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"r\[Nu]", "->", 
       RowBox[{"Re", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}]}]}], 
      ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"\[Omega]i", "->", 
       RowBox[{"Im", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], 
         "]"}]}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"\[Omega]r", "->", 
       RowBox[{"Re", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], 
         "]"}]}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"m", "->", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"\[Chi]", "->", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{"\[Mu]", "->", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], 
        "]"}]}]}], "\[IndentingNewLine]", "\t\t", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcaReprRule", " ", "=", " ", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<A\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
         RowBox[{"ProcaFieldDown", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<D\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<A\>\"", "<>", 
           RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "->", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"ProcaFieldDown", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReprRule", " ", "=", " ", 
   RowBox[{"Union", "[", 
    RowBox[{"ParamReprRule", ",", " ", "ProcaReprRule"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordinates", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"t", "[", "]"}], "->", "t"}], ",", 
      RowBox[{
       RowBox[{"r", "[", "]"}], "->", "r"}], ",", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "]"}], "->", "\[Theta]"}], ",", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "]"}], "->", "\[Phi]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TddNilsSymbolic", " ", "=", " ", 
    RowBox[{
    "Import", "[", 
     "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/NilsSiemonsenCode/Tdd.mx\>\"", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TddNils", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"TddNilsSymbolic", "/.", 
      RowBox[{"\[Omega]i", "->", "0"}]}], "/.", "ReprRule"}], "/.", 
    "coordinates"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8723235340142317`*^9, 3.87232355229535*^9}, {
   3.872331101865716*^9, 3.872331111819127*^9}, {3.872331171484049*^9, 
   3.872331325665104*^9}, {3.872331428809841*^9, 3.872331446843046*^9}, {
   3.872331526985504*^9, 3.872331542738904*^9}, 3.872331582603921*^9, {
   3.872331632150572*^9, 3.8723317632513742`*^9}, {3.872331824315818*^9, 
   3.87233182438981*^9}, {3.8723318572283573`*^9, 3.872331871671307*^9}, {
   3.8723319023807783`*^9, 3.87233192233934*^9}, {3.8723319837482452`*^9, 
   3.872331995087813*^9}, {3.872332148551733*^9, 3.8723321539720716`*^9}},
 CellLabel->
  "In[416]:=",ExpressionUUID->"96fb3856-29ca-4109-82d2-fafcb336fa20"],

Cell[BoxData[
 RowBox[{"ProcaReprRule", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.872331927209037*^9, 3.872331937327971*^9}, {
  3.872332001990844*^9, 3.872332014552745*^9}, {3.872332404297346*^9, 
  3.8723324150920362`*^9}},
 CellLabel->
  "In[430]:=",ExpressionUUID->"c088f7d8-bd4b-4e6a-b86c-7e3416b11e72"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy Density", "Section",
 CellChangeTimes->{{3.872318721272914*^9, 
  3.872318722616754*^9}},ExpressionUUID->"5bce4a27-3590-4e03-8cf5-\
e2270ab988f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testsol", " ", "=", " ", 
   RowBox[{
    RowBox[{"getResults", "[", 
     RowBox[{"$SolutionPath", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<\[Chi]\>\"", ",", "\"\<9_10\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<m\>\"", ",", "\"\<1\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<n\>\"", ",", "\"\<0\>\""}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Mu]Nv\>\"", ",", "\"\<1_5\>\""}], "}"}]}], "}"}]}], 
     "]"}], "//", "First"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmpsol", "=", "testsol"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmpsol", "[", 
    RowBox[{"\"\<Solution\>\"", ",", "\"\<\[Omega]\>\""}], "]"}], "=", 
   RowBox[{"Re", "[", 
    RowBox[{"testsol", "[", 
     RowBox[{"\"\<Solution\>\"", ",", "\"\<\[Omega]\>\""}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rdom", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"tmpsol", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}], "]"}], 
        "[", "\"\<Domain\>\"", "]"}], "//", "First"}], "//", "Last"}], "//", 
     RowBox[{
      RowBox[{"HorizonCoordToRadial", "[", 
       RowBox[{"#", ",", 
        RowBox[{"tmpsol", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<Parameters\>\"", ",", "\"\<\[Chi]\>\""}], "]"}], 
         "]"}]}], "]"}], "&"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proca", " ", "=", " ", 
   RowBox[{
    RowBox[{"FKKSProca", "[", "testsol", "]"}], "[", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Arepr", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<A\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
      RowBox[{"proca", "[", 
       RowBox[{"{", 
        RowBox[{"i", ",", "sphericalchart"}], "}"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DArepr", " ", "=", " ", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<D\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<A\>\"", "<>", 
          RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "->", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"proca", "[", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"-", "sphericalchart"}]}], "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
           "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coordinates", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"t", "[", "]"}], "->", "t"}], ",", 
     RowBox[{
      RowBox[{"r", "[", "]"}], "->", "r"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "]"}], "->", "\[Theta]"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "]"}], "->", "\[Phi]"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"coordconv", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Global`t", "->", "t"}], ",", 
     RowBox[{"Global`r", "->", "r"}], ",", 
     RowBox[{"Global`\[Theta]", "->", "\[Theta]"}], ",", 
     RowBox[{"Global`\[Phi]", "->", "\[Phi]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"coordrev", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "->", "Private`t"}], ",", 
     RowBox[{"r", "->", "Private`r"}], ",", 
     RowBox[{"\[Theta]", "->", "Private`\[Theta]"}], ",", 
     RowBox[{"\[Phi]", "->", "Private`\[Phi]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AupSimp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Import", "[", 
      "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/NilsSiemonsenCode/AupSimp.mx\>\"", "]"}], "//.",
      "coordinates"}], "//.", "coordconv"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AdownSimp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Import", "[", 
      "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/NilsSiemonsenCode/AdownSimp.mx\>\"", "]"}],
      "//.", "coordinates"}], "//.", "coordconv"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TudNils", " ", "=", " ", 
   RowBox[{
   "Import", "[", 
    "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/NilsSiemonsenCode/Tud.mx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TddNils", " ", "=", " ", 
    RowBox[{
    "Import", "[", 
     "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_Field_\
Dynamical_Friction/ProcaAroundKerr/NilsSiemonsenCode/Tdd.mx\>\"", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"endenMe", " ", "=", " ", 
    RowBox[{"FKKSEnergyDensity", "[", "testsol", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rad", " ", "=", " ", 
   RowBox[{"testsol", "[", 
    RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dRad", " ", "=", " ", 
   SuperscriptBox[
    RowBox[{"testsol", "[", 
     RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}], "\[Prime]"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddRad", " ", "=", " ", 
   SuperscriptBox[
    RowBox[{"testsol", "[", 
     RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}], 
    "\[Prime]\[Prime]"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sangl", " ", "=", " ", 
   RowBox[{"testsol", "[", 
    RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dSangl", " ", "=", " ", 
   SuperscriptBox[
    RowBox[{"testsol", "[", 
     RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}], "\[Prime]"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddSangl", " ", "=", " ", 
   SuperscriptBox[
    RowBox[{"testsol", "[", 
     RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}], 
    "\[Prime]\[Prime]"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solidentify", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Ri", "[", "r_", "]"}], ":>", 
      RowBox[{"Im", "[", 
       RowBox[{"Rad", "[", "r", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Rr", "[", "r_", "]"}], ":>", 
      RowBox[{"Re", "[", 
       RowBox[{"Rad", "[", "r", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Ri", "'"}], "[", "r_", "]"}], ":>", 
      RowBox[{"Im", "[", 
       RowBox[{"dRad", "[", "r", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Rr", "'"}], "[", "r_", "]"}], ":>", 
      RowBox[{"Re", "[", 
       RowBox[{"dRad", "[", "r", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Rr", "''"}], "[", "r_", "]"}], ":>", 
      RowBox[{"Re", "[", 
       RowBox[{"ddRad", "[", "r", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Ri", "''"}], "[", "r_", "]"}], ":>", 
      RowBox[{"Im", "[", 
       RowBox[{"ddRad", "[", "r", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Si", "[", "\[Theta]_", "]"}], ":>", 
      RowBox[{"Im", "[", 
       RowBox[{"Sangl", "[", "\[Theta]", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sr", "[", "\[Theta]_", "]"}], ":>", 
      RowBox[{"Re", "[", 
       RowBox[{"Sangl", "[", "\[Theta]", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Si", "'"}], "[", "\[Theta]_", "]"}], ":>", 
      RowBox[{"Im", "[", 
       RowBox[{"dSangl", "[", "\[Theta]", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Sr", "'"}], "[", "\[Theta]_", "]"}], ":>", 
      RowBox[{"Re", "[", 
       RowBox[{"dSangl", "[", "\[Theta]", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Sr", "''"}], "[", "\[Theta]_", "]"}], ":>", 
      RowBox[{"Re", "[", 
       RowBox[{"ddSangl", "[", "\[Theta]", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Si", "''"}], "[", "\[Theta]_", "]"}], ":>", 
      RowBox[{"Im", "[", 
       RowBox[{"ddSangl", "[", "\[Theta]", "]"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", " ", "=", " ", 
   RowBox[{
    RowBox[{"SetPrecision", "[", 
     RowBox[{"#", ",", "$MachinePrecision"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parameters", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]", "->", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      ",", 
      RowBox[{"m", "->", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], ",", 
      RowBox[{"r\[Nu]", "->", 
       RowBox[{"Re", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", "\"\<\[Nu]\>\""}], "]"}]}]}], ",", 
      RowBox[{"i\[Nu]", "->", 
       RowBox[{"Im", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", "\"\<\[Nu]\>\""}], "]"}]}]}], ",", 
      RowBox[{"\[Omega]i", "->", "0"}], ",", 
      RowBox[{"\[Omega]r", "->", 
       RowBox[{"Re", "@", 
        RowBox[{"testsol", "[", 
         RowBox[{"\"\<Solution\>\"", ",", "\"\<\[Omega]\>\""}], "]"}]}]}], 
      ",", 
      RowBox[{"\[Mu]", "->", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", "\"\<\[Mu]Nv\>\""}], "]"}]}], ",", 
      
      RowBox[{"nh", "->", 
       RowBox[{"testsol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", "\"\<n\>\""}], "]"}]}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edenrule", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<Global`D\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", 
           RowBox[{"ToString", "[", "\"\<A\>\"", "]"}], "<>", 
           RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "->", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<D\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", 
           RowBox[{"ToString", "[", "\"\<A\>\"", "]"}], "<>", 
           RowBox[{"ToString", "[", "k", "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<Global`A\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<A\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "}"}], "//", 
    "Flatten"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"edenrule1", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Private`D\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}], "<>", 
            RowBox[{"ToString", "[", "\"\<A\>\"", "]"}], "<>", 
            RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "->", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<D\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}], "<>", 
            RowBox[{"ToString", "[", "\"\<A\>\"", "]"}], "<>", 
            RowBox[{"ToString", "[", "k", "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Private`A\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<A\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "}"}], "//", 
     "Flatten"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tud", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "Import", "[", 
       "\"\</home/shaunf/Documents/Computer/Code/projects/Massive_Vector_\
Field_Dynamical_Friction/ProcaAroundKerr/NilsSiemonsenCode/Tud.mx\>\"", "]"}],
       "//.", "coordinates"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Global`m", "->", "m"}], ",", 
       RowBox[{"Global`\[Omega]r", "->", "\[Omega]r"}], ",", 
       RowBox[{"Global`\[Omega]i", "->", "\[Omega]i"}], ",", 
       RowBox[{"Global`\[Chi]", "->", "\[Chi]"}], ",", 
       RowBox[{"Global`r\[Nu]", "->", "r\[Nu]"}], ",", 
       RowBox[{"Global`i\[Nu]", "->", "i\[Nu]"}], ",", 
       RowBox[{"Global`Si", "->", "Si"}], ",", 
       RowBox[{"Global`Ri", "->", "Ri"}], ",", 
       RowBox[{"Global`Sr", "->", "Sr"}], ",", 
       RowBox[{"Global`Rr", "->", "Rr"}], ",", " ", 
       RowBox[{"Private`\[Chi]", "->", "\[Chi]"}]}], "}"}]}], "//.", 
    "coordconv"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Tudtemp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Tud", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "//.", "edenrule"}], "/.", 
     "edenrule1"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rad", " ", "=", " ", 
   RowBox[{"testsol", "[", 
    RowBox[{"\"\<Solution\>\"", ",", "\"\<R\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sag", " ", "=", " ", 
   RowBox[{"testsol", "[", 
    RowBox[{"\"\<Solution\>\"", ",", "\"\<S\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Radr", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"rad", "[", "#", "]"}], "]"}], "&"}], ")"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Radi", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Im", "[", 
       RowBox[{"rad", "[", "#", "]"}], "]"}], "&"}], ")"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sagr", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"sag", "[", "#", "]"}], "]"}], "&"}], ")"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sagi", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Im", "[", 
       RowBox[{"sag", "[", "#", "]"}], "]"}], "&"}], ")"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dRr", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{
        SuperscriptBox["rad", "\[Prime]"], "[", "#", "]"}], "]"}], "&"}], 
     ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dRi", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Im", "[", 
       RowBox[{
        SuperscriptBox["rad", "\[Prime]"], "[", "#", "]"}], "]"}], "&"}], 
     ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dSr", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{
        SuperscriptBox["sag", "\[Prime]"], "[", "#", "]"}], "]"}], "&"}], 
     ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dSi", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Im", "[", 
       RowBox[{
        SuperscriptBox["sag", "\[Prime]"], "[", "#", "]"}], "]"}], "&"}], 
     ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddRr", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{
        SuperscriptBox["rad", "\[Prime]\[Prime]"], "[", "#", "]"}], "]"}], 
      "&"}], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddRi", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Im", "[", 
       RowBox[{
        SuperscriptBox["rad", "\[Prime]\[Prime]"], "[", "#", "]"}], "]"}], 
      "&"}], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddSr", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{
        SuperscriptBox["sag", "\[Prime]\[Prime]"], "[", "#", "]"}], "]"}], 
      "&"}], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddSi", " ", "=", " ", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Im", "[", 
       RowBox[{
        SuperscriptBox["sag", "\[Prime]\[Prime]"], "[", "#", "]"}], "]"}], 
      "&"}], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddsolrepr", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Ri", "\[Prime]\[Prime]"], "->", "ddRi"}], ",", 
     RowBox[{
      SuperscriptBox["Rr", "\[Prime]\[Prime]"], "->", "ddRr"}], ",", 
     RowBox[{
      SuperscriptBox["Si", "\[Prime]\[Prime]"], "->", "ddSi"}], ",", 
     RowBox[{
      SuperscriptBox["Sr", "\[Prime]\[Prime]"], "->", "ddSr"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dsolrepr", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Ri", "\[Prime]"], "->", "dRi"}], ",", 
     RowBox[{
      SuperscriptBox["Rr", "\[Prime]"], "->", "dRr"}], ",", 
     RowBox[{
      SuperscriptBox["Si", "\[Prime]"], "->", "dSi"}], ",", 
     RowBox[{
      SuperscriptBox["Sr", "\[Prime]"], "->", "dSr"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solrepr", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rr", "->", "Radr"}], ",", " ", 
      RowBox[{"Ri", "->", "Radi"}], ",", " ", 
      RowBox[{"Si", "->", "Sagi"}], ",", 
      RowBox[{"Sr", "->", "Sagr"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aexpl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<A\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
              RowBox[{"AdownSimp", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{
            SuperscriptBox["Im", "\[Prime]"], "[", "x_", "]"}], "->", "1"}]}],
          "/.", 
         RowBox[{
          RowBox[{
           SuperscriptBox["Re", "\[Prime]"], "[", "x_", "]"}], "->", "1"}]}], 
        "/.", "ddsolrepr"}], "/.", "dsolrepr"}], "/.", "solrepr"}], "/.", 
     "parameters"}], "//", "Flatten"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dAexpl", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ToExpression", "[", 
                RowBox[{"\"\<D\>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}], "<>", 
                 RowBox[{"ToString", "[", "\"\<A\>\"", "]"}], "<>", 
                 RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "->", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"AdownSimp", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", "+", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], 
                   "}"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{
             SuperscriptBox["Im", "\[Prime]"], "[", "x_", "]"}], "->", 
            "1"}]}], "/.", 
          RowBox[{
           RowBox[{
            SuperscriptBox["Re", "\[Prime]"], "[", "x_", "]"}], "->", "1"}]}],
          "/.", "ddsolrepr"}], "/.", "dsolrepr"}], "/.", "solrepr"}], "/.", 
      "parameters"}], "//", "Flatten"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TuptdowntTEMP", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Tudtemp", "/.", 
          RowBox[{"{", 
           RowBox[{"\[Omega]i", "->", "0"}], "}"}]}], "/.", "parameters"}], 
        ")"}], "/.", "Aexpl"}], "/.", "dAexpl"}], "/.", "coordinates"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endenNils", "=", 
   RowBox[{"OptimizedFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
     RowBox[{"-", "TuptdowntTEMP"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.864802895865734*^9, 3.864802898453435*^9}, {
   3.864803262433765*^9, 3.86480330466617*^9}, {3.864803339471691*^9, 
   3.864803373049481*^9}, {3.8648034564020023`*^9, 3.864803484433001*^9}, {
   3.864814105904887*^9, 3.864814169726376*^9}, {3.864814252837462*^9, 
   3.864814254140025*^9}, {3.864814345427671*^9, 3.864814350902706*^9}, {
   3.864814747513239*^9, 3.8648148023153563`*^9}, {3.864814862259412*^9, 
   3.8648148633688707`*^9}, 3.864815156861825*^9, {3.864815230573707*^9, 
   3.8648152314800453`*^9}, {3.8648153532525063`*^9, 
   3.8648153804740133`*^9}, {3.864858710634406*^9, 3.86485871891553*^9}, {
   3.864858993739099*^9, 3.864858996955269*^9}, 3.864880473785081*^9, {
   3.865553332161275*^9, 3.865553351279621*^9}, {3.865642993510363*^9, 
   3.865642997423851*^9}, {3.865646462075306*^9, 3.8656464686719522`*^9}, {
   3.865658947763719*^9, 3.865658968404313*^9}, 3.865665000738119*^9, {
   3.865665063022715*^9, 3.86566511212986*^9}, {3.865666175429131*^9, 
   3.865666204552485*^9}, {3.87231701255445*^9, 3.8723170315257683`*^9}, {
   3.872317100639997*^9, 3.8723171074148197`*^9}, {3.872317222230556*^9, 
   3.872317238904893*^9}, {3.8723187534696693`*^9, 3.8723189435973577`*^9}, 
   3.8723189739072123`*^9, {3.872319051032421*^9, 3.872319051589827*^9}, {
   3.8723190921457663`*^9, 3.8723191164500227`*^9}, {3.872319446258408*^9, 
   3.8723194470878353`*^9}, 
   3.8723198153532743`*^9},ExpressionUUID->"5ea5b111-9ebc-427c-96e9-\
474cc0b41cdc"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"endenNils", "[", 
     RowBox[{"0", ",", "Rrr", ",", "\[Theta]th", ",", "0"}], "]"}], "-", 
    RowBox[{"endenMe", "[", 
     RowBox[{"0", ",", "Rrr", ",", "\[Theta]th", ",", "0"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"Rrr", ",", "1.44", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]th", ",", "0.001", ",", 
     RowBox[{"\[Pi]", "-", "0.001"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.872319761828981*^9, 3.872319764187933*^9}, {
  3.8723198011713457`*^9, 3.8723199153899918`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"a62537db-4769-4ef2-81d0-0b47071ee776"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{807.75, 756.},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"885eabad-ea95-4ecb-944a-98df7fbe29b4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 161, 3, 69, "Chapter",ExpressionUUID->"a0c18c35-1175-4a3f-8d91-21c3a0e5c84a"],
Cell[744, 27, 4060, 103, 520, "Input",ExpressionUUID->"d6da2366-e1a5-4617-b531-ad11bf4ab4cf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[4841, 135, 169, 3, 58, "Chapter",ExpressionUUID->"d02840a9-74c9-4da8-8d98-fb9471ac1e06"],
Cell[CellGroupData[{
Cell[5035, 142, 314, 8, 67, "Section",ExpressionUUID->"a53fc4fb-2dba-4216-9934-a45f0a8ef424"],
Cell[5352, 152, 1967, 53, 154, "Input",ExpressionUUID->"595d5f41-788d-4f7c-a8e1-a6fb88b1afe6"],
Cell[7322, 207, 1826, 42, 280, "Input",ExpressionUUID->"070d9bb7-98c7-4795-b2f4-1f663c090dc2"],
Cell[9151, 251, 1869, 45, 274, "Input",ExpressionUUID->"747043d1-2e49-4081-b473-8e0913c96882"]
}, Closed]],
Cell[CellGroupData[{
Cell[11057, 301, 409, 12, 53, "Section",ExpressionUUID->"896da3bc-1637-4ab4-ac13-717e86ee7259"],
Cell[11469, 315, 2051, 54, 174, "Input",ExpressionUUID->"075c529e-eaba-41e0-a7c9-f1603e884898"],
Cell[13523, 371, 1912, 44, 280, "Input",ExpressionUUID->"951f4a39-1997-48fc-ae08-124079a8b9fb"],
Cell[15438, 417, 2026, 48, 301, "Input",ExpressionUUID->"f9061da8-facd-44ab-b8ec-4fa64b4d0513"]
}, Closed]],
Cell[CellGroupData[{
Cell[17501, 470, 435, 12, 53, "Section",ExpressionUUID->"21d7ab97-27a8-4f9d-8c58-00d6d24bbbe8"],
Cell[17939, 484, 2094, 55, 154, "Input",ExpressionUUID->"efe8cf46-d575-4729-8cc5-176c288aff6d"],
Cell[20036, 541, 1956, 45, 280, "Input",ExpressionUUID->"19b0f665-c3d1-41c9-b735-fb4d73e65e7c"],
Cell[21995, 588, 2071, 49, 274, "Input",ExpressionUUID->"70ba1bbc-d787-4033-b1d9-98ef75031309"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[24115, 643, 196, 4, 58, "Chapter",ExpressionUUID->"0f1498e9-e948-475d-bdb2-c69ca7c1784c"],
Cell[CellGroupData[{
Cell[24336, 651, 159, 3, 68, "Section",ExpressionUUID->"0dc18a22-2634-4f73-bfd0-57a24149eaa9"],
Cell[24498, 656, 8154, 209, 834, "Input",ExpressionUUID->"0cd0e79a-2add-43f5-bc3e-2ff8dd637733"]
}, Closed]],
Cell[CellGroupData[{
Cell[32689, 870, 167, 3, 54, "Section",ExpressionUUID->"fcee013c-fd08-48e4-ab54-fe7cebe3c960"],
Cell[32859, 875, 6632, 168, 669, "Input",ExpressionUUID->"96fb3856-29ca-4109-82d2-fafcb336fa20"],
Cell[39494, 1045, 338, 7, 29, "Input",ExpressionUUID->"c088f7d8-bd4b-4e6a-b86c-7e3416b11e72"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39869, 1057, 159, 3, 68, "Section",ExpressionUUID->"5bce4a27-3590-4e03-8cf5-e2270ab988f3"],
Cell[40031, 1062, 24021, 668, 2237, "Input",ExpressionUUID->"5ea5b111-9ebc-427c-96e9-474cc0b41cdc"],
Cell[64055, 1732, 677, 16, 51, "Input",ExpressionUUID->"a62537db-4769-4ef2-81d0-0b47071ee776"]
}, Open  ]]
}, Open  ]]
}
]
*)

