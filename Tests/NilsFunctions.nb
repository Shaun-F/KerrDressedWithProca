(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    101059,       2549]
NotebookOptionsPosition[     99553,       2514]
NotebookOutlinePosition[     99944,       2530]
CellTagsIndexPosition[     99901,       2527]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Vector Field", "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8739497072680387`*^9, 
  3.873949715073493*^9}},ExpressionUUID->"33f4db0c-afa0-49e4-b83f-\
3a32b4ed3b41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Interpolation", " ", "code"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"AdownSimp", " ", "=", " ", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<AdownSimp.mx\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AupSimp", " ", "=", " ", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<AupSimp.mx\>\""}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GenerateNilsVectorField", "[", "sol_Association", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Rsol", "=", 
         RowBox[{"sol", "[", 
          RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<R\>\""}], "]"}]}], ",", 
        RowBox[{"Anglsol", "=", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<S\>\""}], "]"}], "[", 
          "\[Theta]", "]"}]}], ",", 
        RowBox[{"\[Chi]1", "=", 
         RowBox[{"sol", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}],
         ",", 
        RowBox[{"m1", "=", 
         RowBox[{"sol", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], ",", 
        RowBox[{"r\[Nu]1", "=", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}], "//",
           "Re"}]}], ",", 
        RowBox[{"i\[Nu]1", "=", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}], "//",
           "Im"}]}], ",", 
        RowBox[{"\[Omega]r1", "=", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}], 
          "//", "Re"}]}], ",", 
        RowBox[{"\[Mu]1", "=", 
         RowBox[{"sol", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], 
          "]"}]}], ",", 
        RowBox[{"nh1", "=", 
         RowBox[{"sol", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<n\>\""}], "]"}]}], ",", 
        RowBox[{"MBH", "=", "1"}], ",", 
        RowBox[{"m0", "=", 
         RowBox[{"sol", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], ",", 
        RowBox[{"\[Mu]0", "=", 
         RowBox[{"sol", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], 
          "]"}]}], ",", 
        RowBox[{"nh0", "=", 
         RowBox[{"sol", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<n\>\""}], "]"}]}], ",", 
        RowBox[{"\[Chi]0", "=", 
         RowBox[{"sol", "[", 
          RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}],
         ",", 
        RowBox[{"r\[Nu]0", "=", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}], "//",
           "Re"}]}], ",", 
        RowBox[{"i\[Nu]0", "=", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Nu]\>\""}], "]"}], "//",
           "Im"}]}], ",", 
        RowBox[{"\[Omega]r0", "=", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}], 
          "//", "Re"}]}]}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"prec", "=", 
        RowBox[{
         RowBox[{"SetPrecision", "[", 
          RowBox[{"#", ",", "20"}], "]"}], "&"}]}], ";", "\n", 
       RowBox[{"parameters", "=", 
        RowBox[{"prec", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Chi]", "->", "\[Chi]0"}], ",", 
           RowBox[{"m", "->", "m0"}], ",", 
           RowBox[{"r\[Nu]", "->", "r\[Nu]0"}], ",", 
           RowBox[{"i\[Nu]", "->", "i\[Nu]0"}], ",", 
           RowBox[{"\[Omega]i", "->", "0"}], ",", 
           RowBox[{"\[Omega]r", "->", "\[Omega]r0"}], ",", 
           RowBox[{"\[Mu]", "->", "\[Mu]0"}], ",", 
           RowBox[{"nh", "->", "nh0"}]}], "}"}]}]}], ";", "\n", 
       RowBox[{"coordinates", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"t", "[", "]"}], "->", "t"}], ",", 
          RowBox[{
           RowBox[{"r", "[", "]"}], "->", "r"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "]"}], "->", "\[Theta]"}], ",", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "]"}], "->", "\[Phi]"}]}], "}"}]}], ";", 
       "\n", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "radial", " ", "range", " ", "depending", " ", "on", " ", 
         "the", " ", "input", " ", "parameters", " ", "of", " ", "the", " ", 
         "system"}], "*)"}], "\n", 
       RowBox[{"Mtilde", "=", "1"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"MBH1", "+", "1"}], ")"}]}], ";"}], "*)"}], " ", 
       RowBox[{"(*", 
        RowBox[{
        "we", " ", "introduce", " ", "Mtilde", " ", "here", " ", "ONLY", " ", 
         "to", " ", "fix", " ", "rstop", " ", "to", " ", "be", " ", "same", 
         " ", 
         RowBox[{"(", 
          RowBox[{"or", " ", "roughly", " ", "the", " ", "same"}], ")"}], " ",
          "as", " ", "in", " ", "the", " ", 
         RowBox[{"ModesCode", "!"}], " ", "nothing", " ", 
         RowBox[{"more", "!!"}]}], "*)"}], "\n", 
       RowBox[{"rstop", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "/", "2"}], ")"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"m0", "<", "3"}], ",", 
           RowBox[{"prec", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"10", 
                  RowBox[{"(", 
                   RowBox[{"m0", "+", "nh0"}], ")"}], "Mtilde"}], ")"}], "/", 
                
                RowBox[{"(", 
                 RowBox[{"\[Mu]0", "^", "2"}], ")"}]}]}], "-", "2"}], ")"}]}],
            ",", 
           RowBox[{"prec", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"400", 
                 RowBox[{"(", 
                  RowBox[{"m0", "+", "nh0"}], ")"}], "Mtilde"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"7", 
                 RowBox[{"\[Mu]0", "^", "2"}]}], ")"}]}], "-", "1"}], 
             ")"}]}]}], "]"}]}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"The", " ", "-", 
         RowBox[{
         "1", " ", "makes", " ", "sure", " ", "that", " ", "the", " ", 
          "range", " ", "of", " ", "the", " ", "Rsol", " ", "and", " ", 
          "Sangl", " ", "is", " ", "larger", " ", "than", " ", "the", " ", 
          "interpolation", " ", "of", " ", "the", " ", "field", " ", 
          "modes"}]}], "*)"}], "\n", 
       RowBox[{"rplus", "=", 
        RowBox[{"1", "+", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"\[Chi]0", "^", "2"}]}], "]"}]}]}], ";", "\n", 
       RowBox[{"\[Epsilon]r", "=", 
        RowBox[{"10", "^", 
         RowBox[{"-", "2"}]}]}], ";", "\n", 
       RowBox[{"rtst", "=", 
        RowBox[{"prec", "@", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]r", "+", "rplus"}], ")"}]}]}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{
       "PrintTemporary", "[", 
        "\"\<~~~~~~~~~~~~~~~~~~~~~~~Nils Interpolation \
code~~~~~~~~~~~~~~~~~~~~~~~\>\"", "]"}], ";", "\n", 
       RowBox[{"PrintTemporary", "[", "\"\<Interpolation: Start.\>\"", "]"}], 
       ";", "\n", 
       RowBox[{"\[Theta]mesh", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"m0", "==", "1"}], ",", "49", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"m0", "==", "2"}], ",", "59", ",", "59"}], "]"}]}], 
         "]"}]}], ";", "\n", 
       RowBox[{"rmesh", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"m0", "==", "1"}], ",", "199", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"m0", "==", "2"}], ",", "699", ",", "699"}], "]"}]}], 
         "]"}]}], ";", "\n", 
       RowBox[{"p", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rstop", "<", "500"}], ",", "4", ",", "5"}], "]"}]}], ";", 
       "\n", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<rmesh = \>\"", "<>", 
         RowBox[{"ToString", "[", "rmesh", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Thetamesh = \>\"", "<>", 
         RowBox[{"ToString", "[", "\[Theta]mesh", "]"}]}], "]"}], ";", "\n", 
       RowBox[{
        RowBox[{"rdatapoint", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rstop", "-", "rtst"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rmesh", "+", "1"}], ")"}], "^", "p"}], "-", "1"}], 
            ")"}]}], " ", 
          RowBox[{"x", "^", "p"}]}], "+", "rtst", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rstop", "-", "rtst"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rmesh", "+", "1"}], ")"}], "^", "p"}], "-", "1"}], 
           ")"}]}]}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"rrange", "=", 
          RowBox[{"Range", "[", 
           RowBox[{"rtst", ",", "rstop", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rstop", "-", "rtst"}], ")"}], "/", "rmesh"}]}], 
           "]"}]}], ";"}], "*)"}], "\n", 
       RowBox[{"rrange", "=", 
        RowBox[{"rdatapoint", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"2", ",", 
           RowBox[{"rmesh", "+", "2"}]}], "]"}], "]"}]}], ";", "\n", "\n", 
       RowBox[{"slp", "=", "0.25"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "slope", " ", "of", " ", "the", " ", "step", " ", "function"}], 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{"step", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{"\[Pi]", "/", 
          RowBox[{"(", 
           RowBox[{"\[Theta]mesh", "+", "1"}], ")"}]}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]mesh", "+", "1"}], ")"}], "^", "2"}], "/", 
             "2"}], " ", 
            RowBox[{"Exp", "[", 
             RowBox[{"slp", 
              RowBox[{"(", 
               RowBox[{"x", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Theta]mesh", "+", "1"}], ")"}], "/", "2"}]}], 
               ")"}]}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Theta]mesh", "+", "1"}], ")"}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Theta]mesh", "+", "1"}], ")"}], "/", "2"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"slp", 
                 RowBox[{"(", 
                  RowBox[{"x", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Theta]mesh", "+", "1"}], ")"}], "/", "2"}]}], 
                  ")"}]}], "]"}], "-", "1"}], ")"}]}]}], ")"}]}]}]}], ";", 
       "\n", 
       RowBox[{"\[Theta]range", "=", 
        RowBox[{"prec", "@", 
         RowBox[{"step", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Theta]mesh", "+", "1"}]}], "]"}], "]"}]}]}], ";", "\n", 
       RowBox[{"\[Theta]start", "=", 
        RowBox[{"prec", "@", 
         RowBox[{"(", 
          RowBox[{"\[Theta]range", "//", "First"}], ")"}]}]}], ";", "\n", 
       RowBox[{"\[Theta]stop", "=", 
        RowBox[{"prec", "@", 
         RowBox[{"(", 
          RowBox[{"\[Theta]range", "//", "Last"}], ")"}]}]}], ";", "\n", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<ThetaStart = \>\"", "<>", 
         RowBox[{"ToString", "[", "\[Theta]start", "]"}]}], "]"}], ";", "\n", 
       
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<ThetaStop = \>\"", "<>", 
         RowBox[{"ToString", "[", "\[Theta]stop", "]"}]}], "]"}], ";", "\n", 
       "\n", 
       RowBox[{"R\[Theta]ranges", "=", 
        RowBox[{"prec", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rtst", ",", "rstop"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]start", ",", "\[Theta]stop"}], "}"}]}], 
          "}"}]}]}], ";", "\n", "\n", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Angular", " ", "solution"}], "*)"}], "\n", 
       RowBox[{
        RowBox[{"Sangl", "[", "\[Theta]\[Theta]_", "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"Anglsol", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Global`\[Theta]", "->", "\[Theta]"}], ",", 
             RowBox[{"TeuInterEnv`\[Theta]", "->", "\[Theta]"}]}], "}"}]}], "//.",
           "coordinates"}], "//.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dSangltemp", "=", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Sangl", "[", "\[Theta]", "]"}], ",", "\[Theta]"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dSangl", "[", "\[Theta]\[Theta]1_", "]"}], ":=", 
        RowBox[{"dSangltemp", "//.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]1"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ddSangltemp", "=", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"dSangl", "[", "\[Theta]", "]"}], ",", "\[Theta]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ddSangl", "[", "\[Theta]\[Theta]2_", "]"}], ":=", 
        RowBox[{"ddSangltemp", "//.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Rad", " ", "=", " ", "Rsol"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dRad", " ", "=", " ", 
        RowBox[{
         RowBox[{"Derivative", "[", "1", "]"}], "[", "Rsol", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ddRad", " ", "=", " ", 
        RowBox[{
         RowBox[{"Derivative", "[", "2", "]"}], "[", "Rsol", "]"}]}], ";", 
       "\n", "\[IndentingNewLine]", 
       RowBox[{"solidentify", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Ri", "[", "r_", "]"}], ":>", 
           RowBox[{"Im", "[", 
            RowBox[{"Rad", "[", "r", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Rr", "[", "r_", "]"}], ":>", 
           RowBox[{"Re", "[", 
            RowBox[{"Rad", "[", "r", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Ri", "'"}], "[", "r_", "]"}], ":>", 
           RowBox[{"Im", "[", 
            RowBox[{"dRad", "[", "r", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Rr", "'"}], "[", "r_", "]"}], ":>", 
           RowBox[{"Re", "[", 
            RowBox[{"dRad", "[", "r", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Rr", "''"}], "[", "r_", "]"}], ":>", 
           RowBox[{"Re", "[", 
            RowBox[{"ddRad", "[", "r", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Ri", "''"}], "[", "r_", "]"}], ":>", 
           RowBox[{"Im", "[", 
            RowBox[{"ddRad", "[", "r", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Si", "[", "\[Theta]_", "]"}], ":>", 
           RowBox[{"Im", "[", 
            RowBox[{"Sangl", "[", "\[Theta]", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Sr", "[", "\[Theta]_", "]"}], ":>", 
           RowBox[{"Re", "[", 
            RowBox[{"Sangl", "[", "\[Theta]", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Si", "'"}], "[", "\[Theta]_", "]"}], ":>", 
           RowBox[{"Im", "[", 
            RowBox[{"dSangl", "[", "\[Theta]", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Sr", "'"}], "[", "\[Theta]_", "]"}], ":>", 
           RowBox[{"Re", "[", 
            RowBox[{"dSangl", "[", "\[Theta]", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Sr", "''"}], "[", "\[Theta]_", "]"}], ":>", 
           RowBox[{"Re", "[", 
            RowBox[{"ddSangl", "[", "\[Theta]", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Si", "''"}], "[", "\[Theta]_", "]"}], ":>", 
           RowBox[{"Im", "[", 
            RowBox[{"ddSangl", "[", "\[Theta]", "]"}], "]"}]}]}], "}"}]}], 
       ";", "\n", 
       RowBox[{
       "PrintTemporary", "[", "\"\<Solution at horizon: Test:\>\"", "]"}], 
       ";", "\n", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Rad[rtst] = \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Rad", "[", "rtst", "]"}], "]"}]}], "]"}], ";", "\n", "\n", 
       "\n", 
       RowBox[{"AdownSimpExpl", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", "\n", 
       RowBox[{"AupSimpExpl", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", "\n", 
       RowBox[{"dataout", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", "\n", 
       "\n", 
       RowBox[{"sin", "=", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"m", " ", "\[Phi]"}], "-", 
          RowBox[{"t", " ", "\[Omega]r"}]}], "]"}]}], ";", "\n", 
       RowBox[{"cos", "=", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"m", " ", "\[Phi]"}], "-", 
          RowBox[{"t", " ", "\[Omega]r"}]}], "]"}]}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", "\n", 
        RowBox[{
         RowBox[{"Do", "[", "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"Clear", "[", 
             RowBox[{
             "coefflistdown", ",", "coefflistup", ",", "coefflistInterdown", 
              ",", "coefflistInterup"}], "]"}], ";", "\n", 
            RowBox[{"coefflistdownExpl", "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"rmesh", "+", "1"}], ",", 
                 RowBox[{"\[Theta]mesh", "+", "1"}], ",", "2"}], "}"}]}], 
              "]"}]}], ";", "\n", 
            RowBox[{"coefflistupExpl", "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"rmesh", "+", "1"}], ",", 
                 RowBox[{"\[Theta]mesh", "+", "1"}], ",", "2"}], "}"}]}], 
              "]"}]}], ";", "\n", 
            RowBox[{"coefflistdown", "=", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"CoefficientList", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"AdownSimp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[Omega]i", "->", "0"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"sin", ",", "cos"}], "}"}]}], "]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Nu]i", "->", "i\[Nu]"}], ",", 
                    RowBox[{"\[Nu]r", "->", "r\[Nu]"}]}], "}"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Chi]", "->", "\[Chi]0"}], ",", 
                   RowBox[{"m", "->", "m0"}], ",", 
                   RowBox[{"r\[Nu]", "->", "r\[Nu]0"}], ",", 
                   RowBox[{"i\[Nu]", "->", "i\[Nu]0"}], ",", 
                   RowBox[{"\[Omega]r", "->", "\[Omega]r0"}], ",", 
                   RowBox[{"\[Mu]", "->", "\[Mu]0"}], ",", 
                   RowBox[{"nh", "->", "nh0"}]}], "}"}]}], ",", "0", ",", 
                "2"}], "]"}], "//", "Flatten"}]}], ";", "\n", 
            RowBox[{"coefflistup", "=", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"CoefficientList", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"AupSimp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[Omega]i", "->", "0"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"sin", ",", "cos"}], "}"}]}], "]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Nu]i", "->", "i\[Nu]"}], ",", 
                    RowBox[{"\[Nu]r", "->", "r\[Nu]"}]}], "}"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Chi]", "->", "\[Chi]0"}], ",", 
                   RowBox[{"m", "->", "m0"}], ",", 
                   RowBox[{"r\[Nu]", "->", "r\[Nu]0"}], ",", 
                   RowBox[{"i\[Nu]", "->", "i\[Nu]0"}], ",", 
                   RowBox[{"\[Omega]r", "->", "\[Omega]r0"}], ",", 
                   RowBox[{"\[Mu]", "->", "\[Mu]0"}], ",", 
                   RowBox[{"nh", "->", "nh0"}]}], "}"}]}], ",", "0", ",", 
                "2"}], "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"coefflistdown1OE", " ", "=", " ", 
             RowBox[{"OptimizedFunction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r", ",", "\[Theta]"}], "}"}], ",", " ", 
               RowBox[{
                RowBox[{"coefflistdown", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "//.", "solidentify"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"coefflistup1OE", " ", "=", " ", 
             RowBox[{"OptimizedFunction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r", ",", "\[Theta]"}], "}"}], ",", " ", 
               RowBox[{
                RowBox[{"coefflistup", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "//.", "solidentify"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"coefflistdown2OE", " ", "=", " ", 
             RowBox[{"OptimizedFunction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r", ",", "\[Theta]"}], "}"}], ",", " ", 
               RowBox[{
                RowBox[{"coefflistdown", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "//.", "solidentify"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"coefflistup2OE", " ", "=", " ", 
             RowBox[{"OptimizedFunction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r", ",", "\[Theta]"}], "}"}], ",", " ", 
               RowBox[{
                RowBox[{"coefflistup", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "//.", "solidentify"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"DistributeDefinitions", "[", 
             RowBox[{
             "coefflistdown1OE", ",", "coefflistup1OE", ",", " ", 
              "solidentify", ",", " ", "rrange", ",", " ", "\[Theta]range", 
              ",", " ", "coefflistdown2OE", ",", "coefflistup2OE"}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"SetSharedVariable", "[", 
             RowBox[{
             "coefflistdownExpl", ",", "coefflistupExpl", ",", 
              "coefflistdownExpl", ",", "coefflistupExpl"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ParallelEvaluate", "[", 
             RowBox[{"Off", "[", 
              StyleBox[
               RowBox[{"InterpolatingFunction", "::", "dmval"}], 
               "MessageName"], 
              StyleBox["]", "MessageName"]}], 
             StyleBox["]", "MessageName"]}], 
            StyleBox[";", "MessageName"], "\n", "\t", 
            RowBox[{"ParallelDo", "[", "\n", "\t", 
             RowBox[{
              RowBox[{
               RowBox[{"Clear", "[", 
                RowBox[{"rinput", ",", "\[Theta]input"}], "]"}], ";", "\n", 
               "\t", 
               RowBox[{"rinput", "=", 
                RowBox[{"prec", "@", 
                 RowBox[{"rrange", "[", 
                  RowBox[{"[", "ir", "]"}], "]"}]}]}], ";", "\n", "\t", 
               RowBox[{"\[Theta]input", "=", 
                RowBox[{"prec", "@", 
                 RowBox[{"\[Theta]range", "[", 
                  RowBox[{"[", "i\[Theta]", "]"}], "]"}]}]}], ";", "\n", "\t", 
               RowBox[{
                RowBox[{"coefflistdownExpl", "[", 
                 RowBox[{"[", 
                  RowBox[{"ir", ",", "i\[Theta]", ",", "1"}], "]"}], "]"}], 
                "=", 
                RowBox[{"prec", "@", 
                 RowBox[{"(", 
                  RowBox[{"coefflistdown1OE", "[", 
                   RowBox[{"rinput", ",", "\[Theta]input"}], "]"}], ")"}]}]}],
                ";", " ", 
               RowBox[{"(*", 
                RowBox[{"cos", " ", "part"}], "*)"}], "\n", "\t", 
               RowBox[{
                RowBox[{"coefflistupExpl", "[", 
                 RowBox[{"[", 
                  RowBox[{"ir", ",", "i\[Theta]", ",", "1"}], "]"}], "]"}], 
                "=", 
                RowBox[{"prec", "@", 
                 RowBox[{"(", 
                  RowBox[{"coefflistup1OE", "[", 
                   RowBox[{"rinput", ",", "\[Theta]input"}], "]"}], ")"}]}]}],
                ";", " ", 
               RowBox[{"(*", 
                RowBox[{"cos", " ", "part"}], "*)"}], "\n", "\t", 
               RowBox[{
                RowBox[{"coefflistdownExpl", "[", 
                 RowBox[{"[", 
                  RowBox[{"ir", ",", "i\[Theta]", ",", "2"}], "]"}], "]"}], 
                "=", 
                RowBox[{"prec", "@", 
                 RowBox[{"(", 
                  RowBox[{"coefflistdown2OE", "[", 
                   RowBox[{"rinput", ",", "\[Theta]input"}], "]"}], ")"}]}]}],
                ";", " ", 
               RowBox[{"(*", 
                RowBox[{"sin", " ", "part"}], "*)"}], "\n", "\t", 
               RowBox[{
                RowBox[{"coefflistupExpl", "[", 
                 RowBox[{"[", 
                  RowBox[{"ir", ",", "i\[Theta]", ",", "2"}], "]"}], "]"}], 
                "=", 
                RowBox[{"prec", "@", 
                 RowBox[{"(", 
                  RowBox[{"coefflistup2OE", "[", 
                   RowBox[{"rinput", ",", "\[Theta]input"}], "]"}], ")"}]}]}],
                ";"}], " ", 
              RowBox[{"(*", 
               RowBox[{"sin", " ", "part"}], "*)"}], "\n", "\t", ",", 
              RowBox[{"{", 
               RowBox[{"ir", ",", "1", ",", 
                RowBox[{"rmesh", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i\[Theta]", ",", "1", ",", 
                RowBox[{"\[Theta]mesh", "+", "1"}]}], "}"}]}], "]"}], ";", 
            "\n", 
            RowBox[{"PrintTemporary", "[", 
             RowBox[{"\"\<Data produced for: \>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ";", "\n", 
            RowBox[{
             RowBox[{"dataout", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"rrange", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                   RowBox[{"\[Theta]range", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"coefflistdownExpl", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "j", ",", "1"}], "]"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"rmesh", "+", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"\[Theta]mesh", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
            " ", 
            RowBox[{"(*", 
             RowBox[{"only", " ", "the", " ", "cosine", " ", "part"}], "*)"}],
             "\n", 
            RowBox[{"coefflistInterdown", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rrange", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"\[Theta]range", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"coefflistdownExpl", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "l"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"rmesh", "+", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"\[Theta]mesh", "+", "1"}]}], "}"}]}], "]"}], ",",
                    "1"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "->", "3"}], ",", 
                 RowBox[{"Method", "->", "\"\<Spline\>\""}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
            "\n", 
            RowBox[{"coefflistInterup", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rrange", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"\[Theta]range", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"coefflistupExpl", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "l"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"rmesh", "+", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"\[Theta]mesh", "+", "1"}]}], "}"}]}], "]"}], ",",
                    "1"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "->", "3"}], ",", 
                 RowBox[{"Method", "->", "\"\<Spline\>\""}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
            "\n", 
            RowBox[{
             RowBox[{"AdownSimpExpl", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"cos", "  ", 
                RowBox[{
                 RowBox[{"coefflistInterdown", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "+", 
               RowBox[{"sin", " ", 
                RowBox[{
                 RowBox[{"coefflistInterdown", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ")"}]}], ";", 
            "\n", 
            RowBox[{
             RowBox[{"AupSimpExpl", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"cos", "  ", 
                RowBox[{
                 RowBox[{"coefflistInterup", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "+", 
               RowBox[{"sin", " ", 
                RowBox[{
                 RowBox[{"coefflistInterup", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ")"}]}]}], "\n", 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "i"}], 
        "]"}], ";", "\n", 
       RowBox[{"PrintTemporary", "[", "\"\<Interpolation: Done.\>\"", "]"}], 
       ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Final", " ", "output", " ", "of", " ", "the", " ", "the", " ", 
         "interpolating", " ", "of", " ", "the", " ", "fields"}], "*)"}], 
       "\n", 
       RowBox[{
        RowBox[{"Adownvector", "[", 
         RowBox[{
         "tt1_", ",", "rr1_", ",", "\[Theta]\[Theta]1_", ",", 
          "\[Phi]\[Phi]1_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"AdownSimpExpl", "//.", "parameters"}], "//.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"t", "->", "tt1"}], ",", 
           RowBox[{"r", "->", "rr1"}], ",", 
           RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]1"}], ",", 
           RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]1"}]}], "}"}]}]}], ";", "\n", 
       
       RowBox[{
        RowBox[{"Aupvector", "[", 
         RowBox[{
         "tt2_", ",", "rr2_", ",", "\[Theta]\[Theta]2_", ",", 
          "\[Phi]\[Phi]2_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"AupSimpExpl", "//.", "parameters"}], "//.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"t", "->", "tt2"}], ",", 
           RowBox[{"r", "->", "rr2"}], ",", 
           RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]2"}], ",", 
           RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]2"}]}], "}"}]}]}], ";"}]}], 
     "\n", "]"}]}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.873949647105569*^9, 3.873949715074217*^9}, {
   3.873949948852537*^9, 3.87395001871616*^9}, {3.8739506646902657`*^9, 
   3.873950730050663*^9}, {3.874035245091236*^9, 3.874035250543807*^9}, {
   3.8740389785601273`*^9, 3.874038984649213*^9}, 3.874132063731225*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"2ae8d234-4a54-4bae-82ae-f316ff8a8589"]
}, Closed]],

Cell[CellGroupData[{

Cell["Black Hole Evolution", "Subtitle",
 CellChangeTimes->{{3.874118100966675*^9, 3.874118102513212*^9}, {
  3.874121880341195*^9, 
  3.874121885997279*^9}},ExpressionUUID->"76fe24b4-6041-419b-9298-\
b1506ddc8d98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateNilsBHEvolution", "[", "sol_Association", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"min", " ", "=", " ", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"nin", " ", "=", " ", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<n\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"spinin", " ", "=", " ", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"procamass", " ", "=", " ", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Mini", " ", "=", " ", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"mode1", " ", "=", " ", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<m\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"overtone1", " ", "=", " ", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<n\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"spin1", " ", "=", " ", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Procamass1", " ", "=", " ", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], 
        "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prec", "=", 
      RowBox[{
       RowBox[{"SetPrecision", "[", 
        RowBox[{"#", ",", "20"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"wRinM0units", "=", 
      RowBox[{
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Solution\>\"", ",", " ", "\"\<\[Omega]\>\""}], "]"}], "//",
        "Re"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"wr", "=", 
      RowBox[{"prec", "@", "wRinM0units"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dimlesspin", "[", "Mbar_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"min", "/", 
         RowBox[{"(", 
          RowBox[{"wr", " ", "Mini", " ", "Mbar"}], ")"}]}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"1", "/", "Mbar"}]}], ")"}]}], "+", 
       RowBox[{"spinin", "/", 
        RowBox[{"Mbar", "^", "2"}]}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"omegahorizon", "[", "Mbar_", "]"}], ":=", 
      RowBox[{
       RowBox[{"dimlesspin", "[", "Mbar", "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "Mbar", " ", "Mini", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", 
             RowBox[{
              RowBox[{"dimlesspin", "[", "Mbar", "]"}], "^", "2"}]}], "]"}]}],
           ")"}]}], ")"}]}]}], ";", "\n", 
     RowBox[{"massoutputinM0units", "=", 
      RowBox[{
       RowBox[{"prec", "@", 
        RowBox[{"(", 
         RowBox[{"Mbar", "/.", 
          RowBox[{
           RowBox[{"NSolve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"omegahorizon", "[", "Mbar", "]"}], "==", 
              RowBox[{"wr", "/", "min"}]}], ",", "Mbar"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "Mini"}]}], ";", "\n", 
     RowBox[{"dimlessspinoutput", "=", 
      RowBox[{"prec", "@", 
       RowBox[{"dimlesspin", "[", 
        RowBox[{"massoutputinM0units", "/", "Mini"}], "]"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "We", " ", "need", " ", "to", " ", "divide", " ", "by", " ", "Mini", 
        " ", "here"}], ",", " ", 
       RowBox[{"because", " ", "the", " ", "chi", " ", "takes", " ", 
        RowBox[{"in", " ", "\\", "bar"}], 
        RowBox[{"{", "M", "}"}]}], ",", " ", 
       RowBox[{"rather", " ", "than", " ", "stuff", " ", "in", " ", "M0", " ", 
        RowBox[{"units", "!"}], " ", "But", " ", "massoutput", " ", "is", " ",
         "written", " ", "in", " ", "M0", " ", 
        RowBox[{"units", "!"}]}]}], "*)"}], "\n", "\n", 
     RowBox[{"Mfspinf", "=", 
      RowBox[{"prec", "@", 
       RowBox[{"{", 
        RowBox[{"massoutputinM0units", ",", "dimlessspinoutput"}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Black hole evolution done. Data stored in Mfspinf.\>\"", "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.874121897752616*^9, 3.874121974114376*^9}, {
  3.874122065671693*^9, 3.8741220929590387`*^9}, {3.874122145223378*^9, 
  3.87412214543281*^9}, {3.874122343892414*^9, 3.874122355068412*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"2e48f45c-dfc4-44c0-8ddd-49d5af7400e9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy Density and Normalization", "Subtitle",
 CellChangeTimes->{{3.874118100966675*^9, 3.874118102513212*^9}, {
  3.874132483961244*^9, 
  3.874132485742786*^9}},ExpressionUUID->"b60b53f5-0017-4ce4-8034-\
f62891a97f1f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["Options",
     FontSize->14], 
    StyleBox["[",
     FontSize->14], "GenerateNilsEnergyDensityNormalization", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"BlackHoleMass", "->", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{"GenerateNilsEnergyDensityNormalization", "[", 
    RowBox[{"sol_Association", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}],
   FontSize->14], 
  StyleBox[":=",
   FontSize->14], 
  StyleBox["\[IndentingNewLine]",
   FontSize->14], 
  RowBox[{
   StyleBox["Block",
    FontSize->14], 
   StyleBox["[",
    FontSize->14], 
   RowBox[{
    RowBox[{
     StyleBox["{",
      FontSize->14], 
     RowBox[{
      StyleBox["TudNils",
       FontSize->14], 
      StyleBox[",",
       FontSize->14], 
      StyleBox[" ",
       FontSize->14], "EnDenNilsSymb", ",", "Aexpl", ",", "dAexpl", ","}], 
     "}"}], ",", 
    StyleBox["\[IndentingNewLine]",
     FontSize->14], 
    RowBox[{
     RowBox[{
      StyleBox["TudNils",
       FontSize->14], 
      StyleBox[" ",
       FontSize->14], 
      StyleBox["=",
       FontSize->14], 
      StyleBox[" ",
       FontSize->14], 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<../Debugging/TudNilsOwnGeneration.mx\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EnDenNilsSymb", " ", "=", " ", 
      RowBox[{"TudNils", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"GenerateNilsVectorField", "[", "sol", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Integrating", " ", "over", " ", "the", " ", "spatial", " ", "3"}], 
       "-", 
       RowBox[{
       "slice", " ", "outside", " ", "of", " ", "the", " ", "horizon", " ", 
        "for", " ", "the", " ", "complete", " ", "mass"}]}], "*)"}], ";", 
     "\n", 
     RowBox[{"Aexpl", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<A\>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
           RowBox[{
            RowBox[{"Adownvector", "[", 
             RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], "//", 
       "Flatten"}]}], ";", "\n", 
     RowBox[{"dAexpl", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<D\>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}], "<>", 
             RowBox[{"ToString", "[", "\"\<A\>\"", "]"}], "<>", 
             RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "->", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Adownvector", "[", 
               RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}],
               "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}],
               "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}], "//", 
       "Flatten"}]}], ";", "\n", 
     RowBox[{
     "PrintTemporary", "[", "\"\<Massnormalization: Start.\>\"", "]"}], ";", 
     "\n", 
     RowBox[{"(*", 
      RowBox[{"Mass", " ", "integral"}], "*)"}], ";", "\n", 
     RowBox[{"prec", "=", 
      RowBox[{
       RowBox[{"SetPrecision", "[", 
        RowBox[{"#", ",", "30"}], "]"}], "&"}]}], ";", "\n", 
     RowBox[{"TuptdowntTEMP", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"prec", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"EnDenNilsSymb", "/.", 
             RowBox[{"{", 
              RowBox[{"\[Omega]i", "->", "0"}], "}"}]}], "//.", 
            "parameters"}], ")"}]}], "//.", "Aexpl"}], "//.", "dAexpl"}], "//.",
        "coordinates"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"Tuptdownt", "[", 
       RowBox[{
       "tt_", ",", "rr_", ",", "\[Theta]\[Theta]_", ",", "\[Phi]\[Phi]_"}], 
       "]"}], ":=", 
      RowBox[{"TuptdowntTEMP", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "->", "tt"}], ",", 
         RowBox[{"r", "->", "rr"}], ",", 
         RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}], ",", 
         RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]"}]}], "}"}]}]}], ";", "\n", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<Tuptdownt test = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"prec", "@", 
         RowBox[{"Tuptdownt", "[", 
          RowBox[{"0", ",", "2", ",", "2", ",", "2"}], "]"}]}], "]"}]}], 
      "]"}], ";", "\n", 
     RowBox[{
      RowBox[{"sqrtmg", "[", 
       RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ":=", 
      RowBox[{"prec", "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "^", "2"}], "+", 
            RowBox[{
             RowBox[{"\[Chi]", "^", "2"}], " ", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}]}]}], ")"}]}], 
         "//.", "parameters"}], ")"}]}]}], ";", "\n", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<sqrtmg test = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"sqrtmg", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<rplus = \>\"", "<>", 
       RowBox[{"ToString", "[", "rplus", "]"}]}], "]"}], ";", "\n", 
     RowBox[{"rintstart", "=", 
      RowBox[{"prec", "@", 
       RowBox[{"(", 
        RowBox[{"rplus", "+", 
         RowBox[{"10", "^", 
          RowBox[{"-", "1.9"}]}]}], ")"}]}]}], ";", "\n", 
     RowBox[{"rintstop", "=", 
      RowBox[{"prec", "@", 
       RowBox[{"Last", "[", "rrange", "]"}]}]}], ";", "\n", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<rintstart = \>\"", "<>", 
       RowBox[{"ToString", "[", "rintstart", "]"}]}], "]"}], ";", "\n", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<epsilonrint = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rintstart", "-", "rplus"}], ")"}], "/", "rplus"}], "]"}]}],
       "]"}], ";", "\n", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<rintstop = \>\"", "<>", 
       RowBox[{"ToString", "[", "rintstop", "]"}]}], "]"}], ";", "\n", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<thetastart = \>\"", "<>", 
       RowBox[{"ToString", "[", "\[Theta]start", "]"}]}], "]"}], ";", "\n", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<thetastop = \>\"", "<>", 
       RowBox[{"ToString", "[", "\[Theta]stop", "]"}]}], "]"}], ";", "\n", 
     RowBox[{"massNorm", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Tuptdownt", "[", 
           RowBox[{"0", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], 
         RowBox[{"sqrtmg", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "rintstart", ",", "rintstop"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "\[Theta]start", ",", "\[Theta]stop"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"MaxRecursion", "->", "200"}], ",", 
        RowBox[{"MinRecursion", "->", "10"}], ",", 
        RowBox[{"WorkingPrecision", "->", "15"}]}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"massNormint", "[", 
       RowBox[{"rr_", ",", "\[Theta]\[Theta]_", ",", "\[Phi]\[Phi]_"}], "]"}],
       ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Tuptdownt", "[", 
          RowBox[{"0", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], 
        RowBox[{"sqrtmg", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "->", "rr"}], ",", 
         RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}], ",", 
         RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]"}]}], "}"}]}]}], ";", "\n", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<massNorm obtained: \>\"", "<>", 
       RowBox[{"ToString", "[", "massNorm", "]"}]}], "]"}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Normalization", " ", "to", " ", "the", " ", "mass", " ", "in", " ", 
       "terms", " ", "of", " ", "the", " ", "inital", " ", "BH", " ", 
       "mass"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Anorm", "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "BlackHoleMass", "]"}], "/", 
          "massNorm"}], "]"}], ",", "20"}], "]"}]}], ";", "\n", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<Anorm obtained: \>\"", "<>", 
       RowBox[{"ToString", "[", "Anorm", "]"}]}], "]"}], ";", "\n", 
     RowBox[{"Print", "[", "\"\<Massnormalization: Done.\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "Final", " ", "output", " ", "of", " ", "the", " ", "the", " ", 
       "interpolating", " ", "of", " ", "the", " ", "fields", " ", "and", " ",
        "the", " ", "final", " ", "output", " ", "of", " ", "the", " ", 
       "package"}], "*)"}], "\n", 
     RowBox[{"g00Nils", " ", "=", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         InterpretationBox[
          StyleBox["r",
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`r[],
          Editable->False]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           InterpretationBox[
            StyleBox["\[Chi]",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`\[Chi],
            Editable->False], "2"], " ", 
          SuperscriptBox[
           RowBox[{
            InterpretationBox[
             StyleBox["Cos",
              ShowAutoStyles->False,
              AutoSpacing->False],
             Cos,
             Editable->False], "[", 
            InterpretationBox[
             StyleBox["\[Theta]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[Theta][],
             Editable->False], "]"}], "2"]}], "+", 
         SuperscriptBox[
          InterpretationBox[
           StyleBox["r",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`r[],
           Editable->False], "2"]}]]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"edensityNorm", "[", 
       RowBox[{
       "tt_", ",", "rr_", ",", "\[Theta]\[Theta]_", ",", "\[Phi]\[Phi]_"}], 
       "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Anorm", "^", "2"}]}], " ", 
        RowBox[{"Tuptdownt", "[", 
         RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], " ", 
        
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "g00Nils"}], ")"}], "/.", "parameters"}], "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"t", "[", "]"}], "->", "t"}], ",", 
            RowBox[{
             RowBox[{"r", "[", "]"}], "->", "r"}], ",", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "]"}], "->", "\[Theta]"}], ",", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "]"}], "->", "\[Phi]"}]}], "}"}]}], 
         "]"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "->", "tt"}], ",", 
         RowBox[{"r", "->", "rr"}], ",", 
         RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}], ",", 
         RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]"}]}], "}"}]}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Note", " ", "the", " ", "sign", " ", "and", " ", "the", " ", 
         "additional", " ", "lapse", " ", "factor", " ", "in", " ", "front", 
         " ", "of", " ", "the", " ", "meassure", " ", "of", " ", "the", " ", 
         "intergral", " ", "for", " ", "the", " ", "nergy", " ", 
         RowBox[{"density", ".", " ", "Compare"}], " ", "with", " ", 
         "1705.01544", "v2", " ", 
         RowBox[{"eq", ".", " ", 
          RowBox[{"(", "10", ")"}]}]}], ":", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"-", "g"}], "]"}]}], "=", 
       RowBox[{"NSqrt", "[", "\[Gamma]", "]"}]}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"AdownNorm", "[", 
       RowBox[{
       "tt_", ",", "rr_", ",", "\[Theta]\[Theta]_", ",", "\[Phi]\[Phi]_"}], 
       "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Anorm", " ", "AdownSimpExpl"}], "//.", "coordinates"}], "/.",
         "parameters"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "->", "tt"}], ",", 
         RowBox[{"r", "->", "rr"}], ",", 
         RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}], ",", 
         RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]"}]}], "}"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"AupNorm", "[", 
       RowBox[{
       "tt_", ",", "rr_", ",", "\[Theta]\[Theta]_", ",", "\[Phi]\[Phi]_"}], 
       "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Anorm", " ", "AupSimpExpl"}], "//.", "coordinates"}], "/.", 
        "parameters"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "->", "tt"}], ",", 
         RowBox[{"r", "->", "rr"}], ",", 
         RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}], ",", 
         RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]"}]}], "}"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.874118132387353*^9, 3.874118147285862*^9}, {
   3.874118192493517*^9, 3.874118198019841*^9}, {3.8741182309014597`*^9, 
   3.874118251635357*^9}, {3.874119545277213*^9, 3.874119556526278*^9}, {
   3.874119634256351*^9, 3.8741197185522823`*^9}, {3.8741198106945972`*^9, 
   3.8741198223295183`*^9}, {3.874119887056872*^9, 3.874119929133191*^9}, 
   3.874120446807171*^9, {3.874120778931325*^9, 3.874120813744733*^9}, {
   3.874120918010907*^9, 3.8741209738759747`*^9}, 3.874121041040062*^9, 
   3.874121153550846*^9, {3.874121439327621*^9, 3.874121470577971*^9}, {
   3.874122542118763*^9, 3.874122569993939*^9}, {3.87413203910602*^9, 
   3.874132040015217*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"c832eae2-34a6-4c80-a493-1c5234b9beee"]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy Momentum Tensor", "Subtitle",
 CellChangeTimes->{{3.874122654143559*^9, 
  3.8741226565104713`*^9}},ExpressionUUID->"acf19909-5ed7-4a7e-87cf-\
263cfc01be73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateNilsEMTensor", "[", 
   RowBox[{"NormedAdown_", ",", "sol_Association"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Procamass", "=", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}]}], 
      ",", " ", 
      RowBox[{"spin", "=", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
      ",", " ", 
      RowBox[{"Adown", " ", "=", " ", "NormedAdown"}], ",", " ", 
      RowBox[{"\[Mu]n", "=", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}]}], 
      ",", " ", 
      RowBox[{"\[Chi]m", "=", 
       RowBox[{"sol", "[", 
        RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}]}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Tdd", " ", "=", " ", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<../Debugging/TudNilsOwnGeneration.mx\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prec", "=", 
      RowBox[{
       RowBox[{"SetPrecision", "[", 
        RowBox[{"#", ",", "20"}], "]"}], "&"}]}], ";", "\n", 
     RowBox[{"Aexpl", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<A\>\"", "<>", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "->", 
          RowBox[{
           RowBox[{"Adown", "[", 
            RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
           "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}], "//", 
       "Flatten"}]}], ";", "\n", 
     RowBox[{"dAexpl", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<D\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", 
              RowBox[{"ToString", "[", "\"\<A\>\"", "]"}], "<>", 
              RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "->", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Adown", "[", 
                RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"k", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], 
                "}"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}], "//", 
        "Flatten"}], "//", "Simplify"}]}], ";", "\n", 
     RowBox[{"Tddtemp", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tdd", "//.", "coordinates"}], "/.", "Aexpl"}], "/.", 
         "dAexpl"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Chi]", "->", "spin"}], ",", 
          RowBox[{"\[Mu]", "->", "Procamass"}]}], "}"}]}], ")"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"Tdowndown", "[", 
       RowBox[{
       "tt_", ",", "rr_", ",", "\[Theta]\[Theta]_", ",", "\[Phi]\[Phi]_"}], 
       "]"}], ":=", 
      RowBox[{"Tddtemp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "->", "tt"}], ",", 
         RowBox[{"r", "->", "rr"}], ",", 
         RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}], ",", 
         RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]"}]}], "}"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8741316570114594`*^9, 3.874131668051341*^9}, {
   3.874131710411276*^9, 3.874131848836843*^9}, 3.8741325499488287`*^9, {
   3.874132632111919*^9, 3.8741326332177896`*^9}, {3.874132680766403*^9, 
   3.874132687798459*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"9e3ca908-1e52-4828-99fc-9960336ca480"]
}, Closed]],

Cell[CellGroupData[{

Cell["Teukolsky Tlm\[Omega]", "Subtitle",
 CellChangeTimes->{{3.874122654143559*^9, 3.8741226565104713`*^9}, {
  3.87413274668727*^9, 
  3.874132749384396*^9}},ExpressionUUID->"dc7827c0-7b41-43fd-8f7f-\
57a8f43cb4c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GenerateNilsTlmw", "[", 
    RowBox[{"Tfielddowndown1_", ",", " ", "sol_Association", ",", " ", 
     RowBox[{"mTeu_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"\[Omega]Teu_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"radialstart_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"radialstop_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"thetastop_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"thetastart_", "?", "NumericQ"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Procamass", "=", 
        RowBox[{"sol", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"spin", " ", "=", " ", 
        RowBox[{"sol", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"rstop", " ", "=", " ", "radialstop"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rstart", "=", "radialstart"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]stop", " ", "=", " ", "thetastop"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]start", "=", "thetastart"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Tfielddowndown", "=", "Tfielddowndown1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Mu]1", "=", 
        RowBox[{"sol", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Mu]Nv\>\""}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"\[Chi]1", "=", 
        RowBox[{"sol", "[", 
         RowBox[{"\"\<Parameters\>\"", ",", " ", "\"\<\[Chi]\>\""}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"prec", "=", 
       RowBox[{
        RowBox[{"SetPrecision", "[", 
         RowBox[{"#", ",", "15"}], "]"}], "&"}]}], ";", "\n", 
      RowBox[{"coordinates", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"t", "[", "]"}], "->", "t"}], ",", 
         RowBox[{
          RowBox[{"r", "[", "]"}], "->", "r"}], ",", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "]"}], "->", "\[Theta]"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "]"}], "->", "\[Phi]"}]}], "}"}]}], ";", 
      "\n", "\n", 
      RowBox[{"para", "=", 
       RowBox[{"prec", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Chi]", "->", "spin"}], ",", 
          RowBox[{"\[Mu]", "->", "Procamass"}], ",", 
          RowBox[{"mT", "->", "mTeu"}], ",", 
          RowBox[{"\[Omega]T", "->", "\[Omega]Teu"}]}], "}"}]}]}], ";", "\n", 
      
      RowBox[{"rstart", "=", 
       RowBox[{"prec", "@", "rstart"}]}], ";", "\n", 
      RowBox[{"rstop", "=", 
       RowBox[{"prec", "@", "rstop"}]}], ";", "\n", 
      RowBox[{"\[Theta]start", "=", 
       RowBox[{"prec", "@", "\[Theta]start"}]}], ";", "\n", 
      RowBox[{"\[Theta]stop", "=", 
       RowBox[{"prec", "@", "\[Theta]stop"}]}], ";", "\n", 
      RowBox[{"rmesh", "=", "99"}], ";", "\n", 
      RowBox[{"thmesh", "=", "49"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "This", " ", "HAS", " ", "to", " ", "be", " ", "an", " ", "odd", " ", 
        "number", " ", "to", " ", "hit", " ", "the", " ", "last", " ", 
        "\[Theta]stop", " ", "exactly"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"rdatapoint", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rstop", "-", "rstart"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rmesh", "+", "1"}], ")"}], "^", "4"}], "-", "1"}], 
           ")"}]}], " ", 
         RowBox[{"x", "^", "4"}]}], "+", "rstart", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rstop", "-", "rstart"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"rmesh", "+", "1"}], ")"}], "^", "4"}], "-", "1"}], 
          ")"}]}]}]}], ";", "\n", 
      RowBox[{"rrange", "=", 
       RowBox[{"prec", "@", 
        RowBox[{"rdatapoint", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"rmesh", "+", "1"}]}], "]"}], "]"}]}]}], ";", "\n", 
      RowBox[{"\[Theta]range", "=", 
       RowBox[{"prec", "@", 
        RowBox[{"Range", "[", 
         RowBox[{"\[Theta]start", ",", "\[Theta]stop", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]stop", "-", "\[Theta]start"}], ")"}], "/", 
           "thmesh"}]}], "]"}]}]}], ";", "\n", 
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"\[Chi]", "^", "2"}], " ", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "]"}], "]"}], "^", "2"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "]"}], "^", "2"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"r", "[", "]"}]}], "+", 
        RowBox[{"\[Chi]", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nKtemp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"2", "\[CapitalSigma]"}], ")"}]}], " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"r", "[", "]"}], "^", "2"}], "+", 
            RowBox[{"\[Chi]", "^", "2"}]}], ",", 
           RowBox[{"-", "\[CapitalDelta]"}], ",", "0", ",", "\[Chi]"}], 
          "}"}]}], "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mKtemp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"I", " ", "\[Chi]", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "]"}], "]"}]}], ",", "0", ",", "1", ",", 
           RowBox[{"I", "/", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "]"}], "]"}]}]}], "}"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "[", "]"}], "+", 
             RowBox[{"I", " ", "\[Chi]", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "[", "]"}], "]"}]}]}], ")"}]}], ")"}]}], "//",
         "Simplify"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mbarKtemp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], " ", "\[Chi]", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "]"}], "]"}]}], ",", "0", ",", "1", ",", 
           RowBox[{
            RowBox[{"-", "I"}], "/", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", "]"}], "]"}]}]}], "}"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "[", "]"}], "-", 
             RowBox[{"I", " ", "\[Chi]", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "[", "]"}], "]"}]}]}], ")"}]}], ")"}]}], "//",
         "Simplify"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{"Generating", " ", "T_nn", " ", 
        RowBox[{"etc", ".", " ", "for"}], " ", "the", " ", "given", " ", 
        "pair", " ", 
        RowBox[{"(", 
         RowBox[{"\[Omega]T", ",", "mT"}], ")"}]}], "*)"}], "\n", 
      RowBox[{"tnnexpltemp", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"nKtemp", "//.", "coordinates"}], ")"}], " ", ".", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Tfielddowndown", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Global`t", "->", "t"}], ",", 
              RowBox[{"Global`r", "->", "r"}], ",", 
              RowBox[{"Global`\[Theta]", "->", "\[Theta]"}], ",", 
              RowBox[{"Global`\[Phi]", "->", "\[Phi]"}]}], "}"}]}], ")"}], 
          " ", ".", " ", 
          RowBox[{"(", 
           RowBox[{"nKtemp", "//.", "coordinates"}], ")"}]}], ")"}]}]}], ";", 
      "\n", 
      RowBox[{
       RowBox[{"TnnExpl", "[", 
        RowBox[{
        "tt_", ",", "rr_", ",", "\[Theta]\[Theta]_", ",", "\[Phi]\[Phi]_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", "tnnexpltemp", ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Chi]", "->", "spin"}], ",", 
            RowBox[{"\[Mu]", "->", "Procamass"}]}], "}"}]}], "//.", 
         "coordinates"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "->", "tt"}], ",", 
          RowBox[{"r", "->", "rr"}], ",", 
          RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}], ",", 
          RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]"}]}], "}"}]}]}], ";", "\n", 
      RowBox[{"tmnexpltemp", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"nKtemp", "//.", "coordinates"}], ")"}], " ", ".", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Tfielddowndown", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Global`t", "->", "t"}], ",", 
              RowBox[{"Global`r", "->", "r"}], ",", 
              RowBox[{"Global`\[Theta]", "->", "\[Theta]"}], ",", 
              RowBox[{"Global`\[Phi]", "->", "\[Phi]"}]}], "}"}]}], ")"}], 
          " ", ".", " ", 
          RowBox[{"(", 
           RowBox[{"mbarKtemp", "//.", "coordinates"}], ")"}]}], ")"}]}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"TmnExpl", "[", 
        RowBox[{
        "tt_", ",", "rr_", ",", "\[Theta]\[Theta]_", ",", "\[Phi]\[Phi]_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", "tmnexpltemp", ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Chi]", "->", "spin"}], ",", 
            RowBox[{"\[Mu]", "->", "Procamass"}]}], "}"}]}], "//.", 
         "coordinates"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "->", "tt"}], ",", 
          RowBox[{"r", "->", "rr"}], ",", 
          RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}], ",", 
          RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]"}]}], "}"}]}]}], ";", "\n", 
      RowBox[{"tmmexpltemp", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"mbarKtemp", "//.", "coordinates"}], ")"}], " ", ".", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Tfielddowndown", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Global`t", "->", "t"}], ",", 
              RowBox[{"Global`r", "->", "r"}], ",", 
              RowBox[{"Global`\[Theta]", "->", "\[Theta]"}], ",", 
              RowBox[{"Global`\[Phi]", "->", "\[Phi]"}]}], "}"}]}], ")"}], 
          " ", ".", " ", 
          RowBox[{"(", 
           RowBox[{"mbarKtemp", "//.", "coordinates"}], ")"}]}], ")"}]}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"TmmExpl", "[", 
        RowBox[{
        "tt_", ",", "rr_", ",", "\[Theta]\[Theta]_", ",", "\[Phi]\[Phi]_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", "tmmexpltemp", ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Chi]", "->", "spin"}], ",", 
            RowBox[{"\[Mu]", "->", "Procamass"}]}], "}"}]}], "//.", 
         "coordinates"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "->", "tt"}], ",", 
          RowBox[{"r", "->", "rr"}], ",", 
          RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}], ",", 
          RowBox[{"\[Phi]", "->", "\[Phi]\[Phi]"}]}], "}"}]}]}], ";", "\n", 
      "\n", 
      RowBox[{"PrintTemporary", "[", "\"\<Generating: Tnn...\>\"", "]"}], ";",
       "\n", 
      RowBox[{"tnntemp", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", "mTeu"}], " ", "2", "\[Pi]", " ", 
          
          RowBox[{"FourierCoefficient", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FourierTransform", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"TnnExpl", "[", 
                 RowBox[{"t", ",", 
                  RowBox[{"rrange", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]range", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{"\[Phi]", "+", "\[Pi]"}]}], "]"}], "//", 
                "TrigReduce"}], ",", "t", ",", "\[Omega]T"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"DiracDelta", "[", "a_", "]"}], ":>", "1"}], "}"}]}], 
            ",", "\[Phi]", ",", "mTeu"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "rrange", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Theta]range", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\n", 
      RowBox[{"tnntempR", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"rrange", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"\[Theta]range", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"tnntemp", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], "//", "Re"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "rrange", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Theta]range", "]"}]}], "}"}]}], "]"}], 
         ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"TnnInterNumRe", "[", 
        RowBox[{"rr_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{"tnntempR", ",", 
          RowBox[{"InterpolationOrder", "->", "3"}], ",", 
          RowBox[{"Method", "->", "\"\<Spline\>\""}]}], "]"}], "[", 
        RowBox[{"rr", ",", "\[Theta]\[Theta]"}], "]"}]}], ";", "\n", 
      RowBox[{"tnntempI", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"rrange", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"\[Theta]range", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"tnntemp", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], "//", "Im"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "rrange", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Theta]range", "]"}]}], "}"}]}], "]"}], 
         ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"TnnInterNumIm", "[", 
        RowBox[{"rr_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{"tnntempI", ",", 
          RowBox[{"InterpolationOrder", "->", "3"}], ",", 
          RowBox[{"Method", "->", "\"\<Spline\>\""}]}], "]"}], "[", 
        RowBox[{"rr", ",", "\[Theta]\[Theta]"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"TnnInter", "[", 
        RowBox[{"rr_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"TnnInterNumRe", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], "+", 
         RowBox[{"I", " ", 
          RowBox[{"TnnInterNumIm", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "->", "rr"}], ",", 
          RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}]}], "}"}]}]}], ";", 
      "\n", "\n", 
      RowBox[{"PrintTemporary", "[", "\"\<Generating: Tmn...\>\"", "]"}], ";",
       "\n", 
      RowBox[{"tmntemp", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", "mTeu"}], " ", "2", "\[Pi]", " ", 
          
          RowBox[{"FourierCoefficient", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FourierTransform", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"TmnExpl", "[", 
                 RowBox[{"t", ",", 
                  RowBox[{"rrange", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]range", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{"\[Phi]", "+", "\[Pi]"}]}], "]"}], "//", 
                "TrigReduce"}], ",", "t", ",", "\[Omega]T"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"DiracDelta", "[", "a_", "]"}], ":>", "1"}], "}"}]}], 
            ",", "\[Phi]", ",", "mTeu"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "rrange", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Theta]range", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\n", 
      RowBox[{"tmntempR", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"rrange", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"\[Theta]range", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"tmntemp", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], "//", "Re"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "rrange", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Theta]range", "]"}]}], "}"}]}], "]"}], 
         ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"TmnInterNumRe", "[", 
        RowBox[{"rr_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{"tmntempR", ",", 
          RowBox[{"InterpolationOrder", "->", "3"}], ",", 
          RowBox[{"Method", "->", "\"\<Spline\>\""}]}], "]"}], "[", 
        RowBox[{"rr", ",", "\[Theta]\[Theta]"}], "]"}]}], ";", "\n", 
      RowBox[{"tmntempI", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"rrange", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"\[Theta]range", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"tmntemp", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], "//", "Im"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "rrange", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Theta]range", "]"}]}], "}"}]}], "]"}], 
         ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"TmnInterNumIm", "[", 
        RowBox[{"rr_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{"tmntempI", ",", 
          RowBox[{"InterpolationOrder", "->", "3"}], ",", 
          RowBox[{"Method", "->", "\"\<Spline\>\""}]}], "]"}], "[", 
        RowBox[{"rr", ",", "\[Theta]\[Theta]"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"TmnInter", "[", 
        RowBox[{"rr_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"TmnInterNumRe", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], "+", 
         RowBox[{"I", " ", 
          RowBox[{"TmnInterNumIm", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "->", "rr"}], ",", 
          RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}]}], "}"}]}]}], ";", 
      "\n", "\n", 
      RowBox[{"PrintTemporary", "[", "\"\<Generating: Tmm...\>\"", "]"}], ";",
       "\n", 
      RowBox[{"tmmtemp", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", "mTeu"}], " ", "2", "\[Pi]", " ", 
          
          RowBox[{"FourierCoefficient", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FourierTransform", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"TmmExpl", "[", 
                 RowBox[{"t", ",", 
                  RowBox[{"rrange", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]range", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{"\[Phi]", "+", "\[Pi]"}]}], "]"}], "//", 
                "TrigReduce"}], ",", "t", ",", "\[Omega]T"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"DiracDelta", "[", "a_", "]"}], ":>", "1"}], "}"}]}], 
            ",", "\[Phi]", ",", "mTeu"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "rrange", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Theta]range", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\n", 
      RowBox[{"tmmtempR", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"rrange", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"\[Theta]range", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"tmmtemp", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], "//", "Re"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "rrange", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Theta]range", "]"}]}], "}"}]}], "]"}], 
         ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"TmmInterNumRe", "[", 
        RowBox[{"rr_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{"tmmtempR", ",", 
          RowBox[{"InterpolationOrder", "->", "3"}], ",", 
          RowBox[{"Method", "->", "\"\<Spline\>\""}]}], "]"}], "[", 
        RowBox[{"rr", ",", "\[Theta]\[Theta]"}], "]"}]}], ";", "\n", 
      RowBox[{"tmmtempI", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"rrange", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"\[Theta]range", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"tmmtemp", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], "//", "Im"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "rrange", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Theta]range", "]"}]}], "}"}]}], "]"}], 
         ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"TmmInterNumIm", "[", 
        RowBox[{"rr_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{"tmmtempI", ",", 
          RowBox[{"InterpolationOrder", "->", "3"}], ",", 
          RowBox[{"Method", "->", "\"\<Spline\>\""}]}], "]"}], "[", 
        RowBox[{"rr", ",", "\[Theta]\[Theta]"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"TmmInter", "[", 
        RowBox[{"rr_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"TmmInterNumRe", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], "+", 
         RowBox[{"I", " ", 
          RowBox[{"TmmInterNumIm", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "->", "rr"}], ",", 
          RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}]}], "}"}]}]}], ";", 
      "\n", 
      RowBox[{"PrintTemporary", "[", "\"\<Generating: Done.\>\"", "]"}], ";", 
      "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"Computing", " ", "integrand", " ", "of", " ", "Tlm\[Omega]"}],
        "*)"}], "\n", 
      RowBox[{"TijtoExpl", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"\"\<T\>\"", "<>", 
               RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "[", 
             RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"\"\<T\>\"", "<>", 
               RowBox[{"ToString", "[", "j", "]"}], "<>", 
               RowBox[{"ToString", "[", "\"\<Inter\>\"", "]"}]}], "]"}], "[", 
             
             RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<nn\>\"", ",", "\"\<mn\>\"", ",", "\"\<mm\>\""}], 
             "}"}]}], "}"}]}], "]"}], "//", "Flatten"}]}], ";", "\n", 
      RowBox[{"dTijtoExpl", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<d\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", 
              RowBox[{"ToString", "[", "\"\<T\>\"", "]"}], "<>", 
              RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "->", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ToExpression", "[", 
                RowBox[{"\"\<T\>\"", "<>", 
                 RowBox[{"ToString", "[", "j", "]"}], "<>", 
                 RowBox[{"ToString", "[", "\"\<Inter\>\"", "]"}]}], "]"}], 
               "[", 
               RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r", ",", "\[Theta]"}], "}"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<nn\>\"", ",", "\"\<mn\>\"", ",", "\"\<mm\>\""}], 
             "}"}]}], "}"}]}], "]"}], "//", "Flatten"}]}], ";", "\n", 
      RowBox[{"ddTijtoExpl", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<d\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", 
              RowBox[{"ToString", "[", "\"\<d\>\"", "]"}], "<>", 
              RowBox[{"ToString", "[", "k", "]"}], "<>", 
              RowBox[{"ToString", "[", "\"\<T\>\"", "]"}], "<>", 
              RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "->", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToExpression", "[", 
                  RowBox[{"\"\<T\>\"", "<>", 
                   RowBox[{"ToString", "[", "j", "]"}], "<>", 
                   RowBox[{"ToString", "[", "\"\<Inter\>\"", "]"}]}], "]"}], 
                 "[", 
                 RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"r", ",", "\[Theta]"}], "}"}], "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r", ",", "\[Theta]"}], "}"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<nn\>\"", ",", "\"\<mn\>\"", ",", "\"\<mm\>\""}], 
             "}"}]}], "}"}]}], "]"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TeukolskyTintegrand", "=", 
       RowBox[{"Import", "[", 
        RowBox[{
        "$FKKSRoot", "<>", 
         "\"\<Debugging/NilsTeuTintegrandOwnGeneration.mx\>\""}], "]"}]}], 
      ";", "\n", 
      RowBox[{"TTtemp", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"TeukolskyTintegrand", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Chi]", "->", "spin"}], ",", 
              RowBox[{"\[Mu]", "->", "Procamass"}], ",", 
              RowBox[{"\[Omega]T", "->", "\[Omega]Teu"}], ",", 
              RowBox[{"mT", "->", "mTeu"}]}], "}"}]}], "//.", "ddTijtoExpl"}],
           "//.", "dTijtoExpl"}], "//.", "TijtoExpl"}], ")"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"TeukolskyTintegrandExpl", "[", 
        RowBox[{"rr_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
       RowBox[{"TTtemp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "->", "rr"}], ",", 
          RowBox[{"\[Theta]", "->", "\[Theta]\[Theta]"}]}], "}"}]}]}], ";", 
      "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Generating", " ", "spheroidal", " ", "harmonics", " ", "and", " ", 
          "Tlm\[Omega]", " ", "for", " ", "l"}], "=", 
         RowBox[{"|", "m", "|"}]}], ",", 
        RowBox[{"|", "m", "|", 
         RowBox[{"+", "1"}]}], ",", 
        RowBox[{"|", "m", "|", 
         RowBox[{"+", "2"}]}]}], "*)"}], "\n", 
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{"Do", "[", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Generating: Spheroidal harmonic for \
(s=-2,\[Chi],Re(\[Omega]_Teu)).\>\"", "]"}], ";", "\n", "\t", 
           RowBox[{"thetarange", "=", 
            RowBox[{"prec", "@", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"0", "+", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "4"}]}]}], ",", 
               RowBox[{"\[Pi]", "-", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "4"}]}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Pi]", "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"10", "^", 
                    RowBox[{"-", "4"}]}]}]}], ")"}], "/", "400"}]}], 
              "]"}]}]}], ";", "\n", "\t", 
           RowBox[{"SWSHdata", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"2", "\[Pi]"}], "]"}], 
                 RowBox[{"SpinWeightedSpheroidalHarmonicS", "[", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", "lTeu", ",", "mTeu", ",", 
                   RowBox[{"spin", " ", "\[Omega]Teu"}], ",", "x", ",", "0"}],
                   "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "thetarange"}], "}"}]}], "]"}]}], ";", "\n", 
           "\t", 
           RowBox[{
            RowBox[{"Sbar", "[", "\[Theta]\[Theta]_", "]"}], ":=", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{"SWSHdata", ",", 
               RowBox[{"InterpolationOrder", "->", "2"}], ",", 
               RowBox[{"Method", "->", "\"\<Hermite\>\""}]}], "]"}], "[", 
             "\[Theta]\[Theta]", "]"}]}], ";", "\n", "\t", 
           RowBox[{"alm", "=", 
            RowBox[{
             RowBox[{"SpinWeightedSpheroidalEigenvalue", "[", 
              RowBox[{
               RowBox[{"-", "2"}], ",", "lTeu", ",", "mTeu", ",", 
               RowBox[{"spin", " ", "\[Omega]Teu"}]}], "]"}], "+", 
             RowBox[{"2", "mTeu", " ", "spin", " ", "\[Omega]Teu"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"spin", " ", "\[Omega]Teu"}], ")"}], "^", "2"}]}]}], 
           ";", "\n", "\t", 
           RowBox[{"Print", "[", 
            RowBox[{"ToString", "[", 
             RowBox[{"\"\<Eigenvalues of SWSH: \>\"", "<>", 
              RowBox[{"ToString", "[", "alm", "]"}]}], "]"}], "]"}], ";", 
           "\n", "\t", 
           RowBox[{
            RowBox[{"sinfunc", "[", "x_", "]"}], ":=", 
            RowBox[{"Sin", "[", "x", "]"}]}], ";", "\n", "\t", 
           RowBox[{
            RowBox[{"plotsbar", "[", "lTeu", "]"}], "=", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Sbar", "[", "x", "]"}], 
               RowBox[{"sinfunc", "[", "x", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "4"}]}], ",", 
                RowBox[{"\[Pi]", "-", 
                 RowBox[{"10", "^", 
                  RowBox[{"-", "4"}]}]}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
           RowBox[{"rrangeout", "=", "rrange"}], ";", "\n", "\t", 
           RowBox[{
           "Print", "[", "\"\<Generating: Interpolation data...\>\"", "]"}], 
           ";", "\n", "\t", 
           RowBox[{"Tlm\[Omega]temp", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r", ",", 
                RowBox[{"NIntegrate", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"TeukolskyTintegrandExpl", "[", 
                    RowBox[{"r", ",", "\[Theta]"}], "]"}], 
                   RowBox[{"Sbar", "[", "\[Theta]", "]"}], 
                   RowBox[{"sinfunc", "[", "\[Theta]", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\[Theta]", ",", "\[Theta]start", ",", "\[Theta]stop"}], 
                   "}"}], ",", 
                  RowBox[{"MaxRecursion", "->", "50"}], ",", 
                  RowBox[{"WorkingPrecision", "->", "5"}]}], "]"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "rrange"}], "}"}]}], "]"}]}], ";", "\n", 
           "\t", 
           RowBox[{"Print", "[", "\"\<Generating: Tlm\[Omega].\>\"", "]"}], 
           ";", "\n", "\t", 
           RowBox[{
            RowBox[{"Tlm\[Omega]", "[", "lTeu", "]"}], "=", 
            RowBox[{"Interpolation", "[", 
             RowBox[{"Tlm\[Omega]temp", ",", 
              RowBox[{"InterpolationOrder", "->", "2"}], ",", 
              RowBox[{"Method", "->", "\"\<Hermite\>\""}]}], "]"}]}], ";"}], 
          "\n", ",", 
          RowBox[{"{", 
           RowBox[{"lTeu", ",", 
            RowBox[{"Abs", "[", "mTeu", "]"}], ",", 
            RowBox[{
             RowBox[{"Abs", "[", "mTeu", "]"}], "+", "1"}]}], "}"}]}], "]"}], 
        ",", "lTeu"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", "\"\<Generating: Done.\>\"", "]"}], ";"}]}], "\n",
     "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.874133028983117*^9, 3.874133105450964*^9}, 
   3.874133179810143*^9, {3.874133211997591*^9, 3.8741332208049793`*^9}, {
   3.8741332984042463`*^9, 3.874133333297904*^9}, {3.874133381782794*^9, 
   3.874133421769001*^9}, {3.874133468642577*^9, 3.874133491548527*^9}, {
   3.874133591276084*^9, 3.874133640863781*^9}, {3.874135782524515*^9, 
   3.874135804927183*^9}, {3.8741358547621593`*^9, 3.8741358866016693`*^9}, {
   3.874136425734692*^9, 3.8741364413618383`*^9}, {3.874137733454286*^9, 
   3.87413773462073*^9}},ExpressionUUID->"200f4676-e1dc-4999-990d-\
5ba702b631ec"]
}, Open  ]]
},
WindowSize->{714, 756},
WindowMargins->{{3, Automatic}, {0, Automatic}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b6d02e39-7fe1-438d-871b-0d9b2117d57b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 215, 4, 53, "Subtitle",ExpressionUUID->"33f4db0c-afa0-49e4-b83f-3a32b4ed3b41",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[798, 28, 35282, 853, 3028, "Input",ExpressionUUID->"2ae8d234-4a54-4bae-82ae-f316ff8a8589",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[36117, 886, 215, 4, 53, "Subtitle",ExpressionUUID->"76fe24b4-6041-419b-9298-b1506ddc8d98"],
Cell[36335, 892, 4993, 119, 948, "Input",ExpressionUUID->"2e48f45c-dfc4-44c0-8ddd-49d5af7400e9"]
}, Closed]],
Cell[CellGroupData[{
Cell[41365, 1016, 227, 4, 53, "Subtitle",ExpressionUUID->"b60b53f5-0017-4ce4-8034-f62891a97f1f"],
Cell[41595, 1022, 15294, 407, 1368, "Input",ExpressionUUID->"c832eae2-34a6-4c80-a493-1c5234b9beee"]
}, Closed]],
Cell[CellGroupData[{
Cell[56926, 1434, 170, 3, 53, "Subtitle",ExpressionUUID->"acf19909-5ed7-4a7e-87cf-263cfc01be73"],
Cell[57099, 1439, 4367, 114, 319, "Input",ExpressionUUID->"9e3ca908-1e52-4828-99fc-9960336ca480"]
}, Closed]],
Cell[CellGroupData[{
Cell[61503, 1558, 217, 4, 53, "Subtitle",ExpressionUUID->"dc7827c0-7b41-43fd-8f7f-57a8f43cb4c5"],
Cell[61723, 1564, 37814, 947, 3420, "Input",ExpressionUUID->"200f4676-e1dc-4999-990d-5ba702b631ec"]
}, Open  ]]
}
]
*)

